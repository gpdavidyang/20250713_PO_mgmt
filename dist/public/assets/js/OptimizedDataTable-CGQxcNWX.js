import{g as L,h as O,i as _,k as A,l as W,j as e,m as f}from"./chunk-D67rGsji.js";import{r}from"./chunk-BgLp_VvL.js";import{b as u,I as Z,B as k}from"./chunk-DV-F1ehd.js";import{n as q,o as J,p as y,r as K,s as Q,t as I}from"./chunk-bdHBeqB0.js";import{B as U}from"./chunk-Bw5QEQRA.js";import{k as X,l as Y,V as ee}from"./index-B9Zn91qv.js";import{a$ as P,_ as se,ao as ae,aE as te,C as le}from"./chunk-CVirgo2y.js";import"./chunk-CZez8RVl.js";import"./chunk-CFxRDIMf.js";function ne({columns:i,data:o,searchKey:p,searchPlaceholder:N="검색...",filters:h=[],onRowClick:x,className:j,isLoading:d=!1,enablePagination:l=!0,pageSize:g=20,emptyMessage:S="데이터가 없습니다",enableVirtualization:v=!1,virtualItemHeight:D=60,virtualContainerHeight:H=400,virtualizationThreshold:C=100}){const[V,B]=r.useState([]),[b,w]=r.useState([]),[M,R]=r.useState(""),[c,T]=r.useState(!1);X("OptimizedDataTable"),Y();const E=r.useMemo(()=>i,[i]),G=r.useMemo(()=>o,[o]),F=r.useMemo(()=>v===!1?!1:o.length>=C||v===!0,[o.length,v,C]);r.useEffect(()=>{T(F)},[F]);const t=L({data:G,columns:E,getCoreRowModel:O(),getSortedRowModel:_(),getFilteredRowModel:A(),getPaginationRowModel:l&&!c?W():void 0,onSortingChange:B,onColumnFiltersChange:w,onGlobalFilterChange:R,state:{sorting:V,columnFilters:b,globalFilter:M},initialState:{pagination:{pageSize:c?o.length:g}}}),$=r.useCallback(a=>{R(a)},[]),z=r.useCallback((a,s)=>{w(m=>s==="all"?m.filter(n=>n.id!==a):m.some(n=>n.id===a)?m.map(n=>n.id===a?{...n,value:s}:n):[...m,{id:a,value:s}])},[]);return d?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-10 w-80 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-10 w-32 bg-gray-200 rounded animate-pulse"})]}),e.jsx("div",{className:"rounded-md border",children:e.jsx("div",{className:"space-y-2 p-4",children:Array.from({length:5}).map((a,s)=>e.jsx("div",{className:"h-12 bg-gray-200 rounded animate-pulse"},s))})})]}):e.jsxs("div",{className:u("space-y-4",j),children:[e.jsxs("div",{className:"flex items-center space-x-2 flex-wrap gap-2",children:[o.length>=C&&e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-blue-50 rounded-md border border-blue-200",children:[e.jsx(P,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-700",children:"가상화 활성"}),e.jsx("button",{onClick:()=>T(!c),className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:c?"비활성화":"활성화"})]}),p&&e.jsxs("div",{className:"relative flex-1 min-w-80",children:[e.jsx(se,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(Z,{placeholder:N,value:M,onChange:a=>$(a.target.value),className:"pl-10"})]}),h.map(a=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-500"}),e.jsxs("select",{value:b.find(s=>s.id===a.key)?.value||"all",onChange:s=>z(a.key,s.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsxs("option",{value:"all",children:["모든 ",a.label]}),a.options.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]},a.key)),b.length>0&&e.jsx("div",{className:"flex items-center space-x-2",children:b.map(a=>{const s=h.find(n=>n.key===a.id),m=s?.options.find(n=>n.value===a.value);return e.jsxs(U,{variant:"secondary",className:"text-xs",children:[s?.label,": ",m?.label,e.jsx("button",{onClick:()=>z(a.id,"all"),className:"ml-1 hover:bg-gray-300 rounded-full p-0.5",children:"×"})]},a.id)})})]}),e.jsx("div",{className:"rounded-md border",children:c?e.jsx(re,{table:t,columns:i,onRowClick:x,itemHeight:D,containerHeight:H,emptyMessage:S}):e.jsxs(q,{children:[e.jsx(J,{children:t.getHeaderGroups().map(a=>e.jsx(y,{children:a.headers.map(s=>e.jsx(K,{className:u("font-medium text-gray-700",s.column.getCanSort()&&"cursor-pointer select-none hover:bg-gray-50"),onClick:s.column.getToggleSortingHandler(),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[s.isPlaceholder?null:f(s.column.columnDef.header,s.getContext()),s.column.getCanSort()&&e.jsx("span",{className:"text-gray-400",children:{asc:"↑",desc:"↓"}[s.column.getIsSorted()]??"↕"})]})},s.id))},a.id))}),e.jsx(Q,{children:t.getRowModel().rows?.length?t.getRowModel().rows.map(a=>e.jsx(y,{"data-state":a.getIsSelected()&&"selected",className:u("hover:bg-gray-50 transition-colors",x&&"cursor-pointer"),onClick:()=>x?.(a.original),children:a.getVisibleCells().map(s=>e.jsx(I,{className:"py-3 px-4",children:f(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx(y,{children:e.jsx(I,{colSpan:i.length,className:"h-24 text-center text-gray-500",children:S})})})]})}),e.jsxs("div",{className:"flex items-center justify-between space-x-2 py-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 flex items-center space-x-4",children:[e.jsxs("span",{children:["총 ",t.getFilteredRowModel().rows.length,"개",!c&&l&&e.jsxs(e.Fragment,{children:[" ","중"," ",t.getState().pagination.pageIndex*t.getState().pagination.pageSize+1,"-",Math.min((t.getState().pagination.pageIndex+1)*t.getState().pagination.pageSize,t.getFilteredRowModel().rows.length),"개 표시"]})]}),c&&e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600",children:[e.jsx(P,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"가상화 렌더링 활성"})]})]}),l&&!c&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>t.previousPage(),disabled:!t.getCanPreviousPage(),children:[e.jsx(te,{className:"h-4 w-4"}),"이전"]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"페이지"}),e.jsxs("strong",{className:"text-sm",children:[t.getState().pagination.pageIndex+1," / ",t.getPageCount()]})]}),e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>t.nextPage(),disabled:!t.getCanNextPage(),children:["다음",e.jsx(le,{className:"h-4 w-4"})]})]})]})]})}function re({table:i,columns:o,onRowClick:p,itemHeight:N,containerHeight:h,emptyMessage:x}){const j=i.getRowModel().rows;return j?.length?e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"border-b bg-gray-50",children:e.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${o.length}, 1fr)`},children:i.getHeaderGroups().map(d=>d.headers.map(l=>e.jsx("div",{className:u("px-4 py-3 text-left font-medium text-gray-700 border-r last:border-r-0",l.column.getCanSort()&&"cursor-pointer select-none hover:bg-gray-100"),onClick:l.column.getToggleSortingHandler(),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[l.isPlaceholder?null:f(l.column.columnDef.header,l.getContext()),l.column.getCanSort()&&e.jsx("span",{className:"text-gray-400",children:{asc:"↑",desc:"↓"}[l.column.getIsSorted()]??"↕"})]})},l.id)))})}),e.jsx(ee,{items:j,itemHeight:N,containerHeight:h,className:"border-0",renderItem:(d,l)=>e.jsx("div",{className:u("grid border-b hover:bg-gray-50 transition-colors",p&&"cursor-pointer"),style:{gridTemplateColumns:`repeat(${o.length}, 1fr)`},onClick:()=>p?.(d.original),children:d.getVisibleCells().map(g=>e.jsx("div",{className:"px-4 py-3 border-r last:border-r-0 flex items-center",children:f(g.column.columnDef.cell,g.getContext())},g.id))})})]}):e.jsx("div",{className:"h-24 flex items-center justify-center text-gray-500",children:x})}function he(i){return e.jsx(ne,{...i,enableVirtualization:!0,enablePagination:!1,virtualizationThreshold:50})}export{ne as OptimizedDataTable,he as VirtualDataTable};
