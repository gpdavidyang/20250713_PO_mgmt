import{i as T,u as M,a as B,b as H,r as c,p as S,j as e,U as D,ay as R,az as U,aA as G,aB as K,n as Q,aC as y,o as g,z as P,A as b,ai as C,q as k,L as l,I as n,m as d,S as V,aD as J,l as F,v as A}from"./index-BhrwCNPD.js";import{S as u}from"./separator-BvzjYwHY.js";import{S as q}from"./switch-DkrHBeyD.js";import{i as E}from"./authUtils-CcDzk6i0.js";import"./index-CvaRLgKf.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=T("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=T("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function ee(){const{user:a,isLoading:j}=M(),{toast:t}=B(),[,p]=H(),[m,f]=c.useState({name:"",email:"",role:""}),[x,h]=c.useState({emailNotifications:!0,orderAlerts:!0,language:"ko"}),[i,o]=c.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[z,N]=c.useState(!1);c.useEffect(()=>{a&&typeof a=="object"&&f({name:a.name||"",email:a.email||"",role:a.role||""})},[a]),c.useEffect(()=>{if(!j&&!a){t({title:"인증 오류",description:"로그인이 필요합니다. 다시 로그인해주세요.",variant:"destructive"}),setTimeout(()=>{p("/login")},500);return}},[a,j,t]);const w=S({mutationFn:async s=>await F("PATCH","/api/auth/profile",{name:s.name}),onSuccess:s=>{A.invalidateQueries({queryKey:["/api/auth/user"]}),A.refetchQueries({queryKey:["/api/auth/user"]}),s&&typeof s=="object"&&f(r=>({...r,name:s.name||r.name})),t({title:"성공",description:"프로필이 업데이트되었습니다."})},onError:s=>{E(s)?(t({title:"인증 오류",description:"로그인이 필요합니다. 다시 로그인해주세요.",variant:"destructive"}),setTimeout(()=>{p("/login")},500)):t({title:"오류",description:"프로필 업데이트에 실패했습니다.",variant:"destructive"})}}),L=s=>{s.preventDefault(),w.mutate(m)},v=S({mutationFn:async s=>await F("PATCH","/api/auth/change-password",s),onSuccess:()=>{t({title:"성공",description:"비밀번호가 성공적으로 변경되었습니다."}),o({currentPassword:"",newPassword:"",confirmPassword:""}),N(!1)},onError:s=>{E(s)?(t({title:"인증 오류",description:"로그인이 필요합니다. 다시 로그인해주세요.",variant:"destructive"}),setTimeout(()=>{p("/login")},500)):t({title:"오류",description:s.response?.data?.message||"비밀번호 변경에 실패했습니다.",variant:"destructive"})}}),I=s=>{if(s.preventDefault(),!i.currentPassword||!i.newPassword||!i.confirmPassword){t({title:"입력 오류",description:"모든 필드를 입력해주세요.",variant:"destructive"});return}if(i.newPassword!==i.confirmPassword){t({title:"입력 오류",description:"새 비밀번호가 일치하지 않습니다.",variant:"destructive"});return}if(i.newPassword.length<6){t({title:"입력 오류",description:"새 비밀번호는 최소 6자 이상이어야 합니다.",variant:"destructive"});return}v.mutate({currentPassword:i.currentPassword,newPassword:i.newPassword})};return j?e.jsx("div",{className:"container mx-auto p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"로딩 중..."})]})})}):a?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"프로필"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"계정 정보와 설정을 관리하세요"})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx(R,{className:"h-16 w-16",children:e.jsx(U,{className:"bg-primary text-white text-lg",children:G(a)})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold",children:K(a)}),e.jsx("p",{className:"text-gray-600",children:a?.email}),e.jsx(Q,{variant:"secondary",className:"mt-1",children:y(a?.role||"")})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(g,{children:[e.jsxs(P,{children:[e.jsxs(b,{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-5 w-5"}),e.jsx("span",{children:"프로필 정보"})]}),e.jsx(C,{children:"개인 정보를 수정할 수 있습니다."})]}),e.jsx(k,{children:e.jsxs("form",{onSubmit:L,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"이름"}),e.jsx(n,{id:"name",value:m.name,onChange:s=>f(r=>({...r,name:s.target.value})),placeholder:"전체 이름을 입력하세요"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"이메일"}),e.jsx(n,{id:"email",type:"email",value:m.email,disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-sm text-gray-500",children:"이메일은 변경할 수 없습니다."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"role",children:"역할"}),e.jsx(n,{id:"role",value:y(m.role),disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-sm text-gray-500",children:"역할은 관리자만 변경할 수 있습니다."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"사용자 ID"}),e.jsx(n,{value:a?.id||"",disabled:!0,className:"bg-gray-50"})]}),e.jsx(u,{}),e.jsx(d,{type:"submit",disabled:w.isPending,className:"w-full",children:w.isPending?"저장 중...":"프로필 저장"})]})})]}),e.jsxs(g,{children:[e.jsxs(P,{children:[e.jsxs(b,{className:"flex items-center space-x-2",children:[e.jsx(V,{className:"h-5 w-5"}),e.jsx("span",{children:"계정 설정"})]}),e.jsx(C,{children:"알림 및 언어 설정을 변경할 수 있습니다."})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("h4",{className:"font-medium",children:"알림 설정"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{children:"이메일 알림"}),e.jsx("p",{className:"text-sm text-gray-500",children:"중요한 업데이트를 이메일로 받아보세요"})]}),e.jsx(q,{checked:x.emailNotifications,onCheckedChange:s=>h(r=>({...r,emailNotifications:s}))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(l,{children:"발주서 알림"}),e.jsx("p",{className:"text-sm text-gray-500",children:"발주서 상태 변경 시 알림을 받아보세요"})]}),e.jsx(q,{checked:x.orderAlerts,onCheckedChange:s=>h(r=>({...r,orderAlerts:s}))})]})]})]}),e.jsx(u,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("h4",{className:"font-medium",children:"언어 설정"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"언어"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(d,{type:"button",variant:x.language==="ko"?"default":"outline",size:"sm",onClick:()=>h(s=>({...s,language:"ko"})),children:"한국어"}),e.jsx(d,{type:"button",variant:x.language==="en"?"default":"outline",size:"sm",onClick:()=>h(s=>({...s,language:"en"})),children:"English"})]})]})]}),e.jsx(u,{}),e.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50",children:[e.jsx("h4",{className:"font-medium mb-3",children:"계정 정보 요약"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"사용자 ID:"}),e.jsx("span",{className:"font-mono",children:a?.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"이메일:"}),e.jsx("span",{children:a?.email})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"역할:"}),e.jsx("span",{children:y(a?.role||"")})]})]})]})]})]}),e.jsxs(g,{className:"lg:col-span-1",children:[e.jsxs(P,{children:[e.jsxs(b,{className:"flex items-center space-x-2",children:[e.jsx(W,{className:"h-5 w-5"}),e.jsx("span",{children:"비밀번호 변경"})]}),e.jsx(C,{children:"계정 보안을 위해 정기적으로 비밀번호를 변경하세요."})]}),e.jsx(k,{children:z?e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"currentPassword",children:"현재 비밀번호"}),e.jsx(n,{id:"currentPassword",type:"password",value:i.currentPassword,onChange:s=>o(r=>({...r,currentPassword:s.target.value})),placeholder:"현재 비밀번호를 입력하세요",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"newPassword",children:"새 비밀번호"}),e.jsx(n,{id:"newPassword",type:"password",value:i.newPassword,onChange:s=>o(r=>({...r,newPassword:s.target.value})),placeholder:"새 비밀번호를 입력하세요",required:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"최소 6자 이상 입력하세요"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"confirmPassword",children:"새 비밀번호 확인"}),e.jsx(n,{id:"confirmPassword",type:"password",value:i.confirmPassword,onChange:s=>o(r=>({...r,confirmPassword:s.target.value})),placeholder:"새 비밀번호를 다시 입력하세요",required:!0})]}),e.jsx(u,{}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(d,{type:"button",variant:"outline",onClick:()=>{N(!1),o({currentPassword:"",newPassword:"",confirmPassword:""})},className:"flex-1",children:"취소"}),e.jsx(d,{type:"submit",disabled:v.isPending,className:"flex-1",children:v.isPending?"변경 중...":"비밀번호 변경"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"비밀번호를 변경하려면 아래 버튼을 클릭하세요."}),e.jsx(d,{onClick:()=>N(!0),className:"w-full",variant:"outline",children:"비밀번호 변경하기"})]})})]})]})]}):null}export{ee as default};
