import{n as je,j as e,S as H,g as Ae,R as K,o as L,I as W,B as N,p as Ue,F as Ie,a as Ne,U as Ke,q as He,i as we,s as be,u as Te,c as Oe,r as I,f as Re,T as J,t as Z,v as ee,E as Ve,w as re,x as te,d as _e,y as Qe,z as Ye,A as We,D as Ge,G as ce,m as Y,H as ye,J as ge}from"./index-BkwhTr3n.js";import{S as se,a as oe,b as le,c as ne,d as A}from"./select-C8kzM0EG.js";import{M as Ce,b as Se,u as Xe,E as Je,a as Ze}from"./email-history-modal-Df_wzkcF.js";import{i as me}from"./authUtils-CcDzk6i0.js";import{E as er}from"./email-send-dialog-BsM4tY7q.js";import{S as fe}from"./search-2HgHeV2K.js";import{C as rr}from"./chevrons-up-down-BOvJkQ5b.js";import{C as Pe}from"./chevron-up-IbiYjp-K.js";import{C as Me}from"./chevron-down-BPayUNt4.js";import{C as ue}from"./circle-check-p2BAGJ6G.js";import{S as ze}from"./send-YHiWtvll.js";import{C as De}from"./circle-x-Cjx4rjhE.js";import{T as tr,M as ar}from"./trending-down-DSVGrP2J.js";import{T as sr}from"./trending-up-DbYQMky6.js";import{C as $e}from"./checkbox-DBiA8S0m.js";import{D as or,a as lr,b as nr,c as ir,d as dr,e as cr}from"./dialog-7qW_vyFZ.js";import{T as gr}from"./triangle-alert-B4n08zTt.js";import{T as Le}from"./trash-2-BGDqz3oJ.js";import{S as mr}from"./square-pen-Bo2eTDjL.js";import{M as ur}from"./mail-mQBP-ZcM.js";import{f as ae}from"./format-goUx12AG.js";import{S as br}from"./shopping-cart-COCrNw3a.js";import{D as Ee}from"./download-4-f23bFe.js";import{F as xr}from"./filter-CYRmaCze.js";import"./index-Tk5NlhhC.js";import"./tabs-Iwafn9ax.js";import"./separator-DRSyodFS.js";import"./refresh-cw-DwQhvA-T.js";import"./paperclip-e0DEITCi.js";import"./textarea-D7jt89w5.js";import"./alert-BOEQANCL.js";import"./index-CfKjOhZe.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=je("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=je("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=je("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function pr({rows:n=5,columns:c=6,showPagination:b=!0}){return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsx("tr",{children:Array.from({length:c}).map((w,a)=>e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx(H,{className:"h-4 w-24"})},a))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.from({length:n}).map((w,a)=>e.jsx("tr",{children:Array.from({length:c}).map((s,y)=>e.jsx("td",{className:"px-4 py-3",children:e.jsx(H,{className:"h-4 w-full max-w-xs"})},y))},a))})]})}),b&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(H,{className:"h-8 w-48"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(H,{className:"h-8 w-20"}),e.jsx(H,{className:"h-8 w-8"}),e.jsx(H,{className:"h-8 w-8"}),e.jsx(H,{className:"h-8 w-8"}),e.jsx(H,{className:"h-8 w-20"})]}),e.jsx(H,{className:"h-8 w-32"})]})]})}function fr({data:n,columns:c,searchable:b=!1,searchPlaceholder:w="검색...",showPagination:a=!1,pageSize:s=10,pageSizeOptions:y=[10,25,50,100],onRowClick:f,rowKey:g,emptyMessage:T="데이터가 없습니다",isLoading:M=!1,className:v,stickyHeader:ie=!1,maxHeight:$}){const{theme:O,actualTheme:p}=Ae(),u=p==="dark"||O==="dark"||document.documentElement.classList.contains("dark"),_=`table-${u?"dark":"light"}-${Date.now()}`;K.useEffect(()=>(()=>{if(p==="dark"||O==="dark"||document.documentElement.classList.contains("dark")){const r=document.getElementById("enhanced-table-dark-override");r&&r.remove();const o=document.createElement("style");o.id="enhanced-table-dark-override",o.textContent=`
          /* ULTIMATE TABLE DARK MODE OVERRIDE */
          .dark-table-container table,
          [data-theme="dark"] .dark-table-container table,
          html.dark .dark-table-container table {
            background-color: rgb(31 41 55) !important;
            color: rgb(241 245 249) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody,
          [data-theme="dark"] .dark-table-container table tbody,
          html.dark .dark-table-container table tbody {
            background-color: rgb(31 41 55) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr,
          [data-theme="dark"] .dark-table-container table tbody tr,
          html.dark .dark-table-container table tbody tr {
            background-color: rgb(31 41 55) !important;
            color: rgb(241 245 249) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr:nth-child(even),
          [data-theme="dark"] .dark-table-container table tbody tr:nth-child(even),
          html.dark .dark-table-container table tbody tr:nth-child(even) {
            background-color: rgba(55 65 81, 0.7) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr:hover,
          [data-theme="dark"] .dark-table-container table tbody tr:hover,
          html.dark .dark-table-container table tbody tr:hover {
            background-color: rgb(55 65 81) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table thead,
          [data-theme="dark"] .dark-table-container table thead,
          html.dark .dark-table-container table thead {
            background-color: rgb(55 65 81) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container .table-wrapper-custom,
          [data-theme="dark"] .dark-table-container .table-wrapper-custom,
          html.dark .dark-table-container .table-wrapper-custom {
            background-color: rgb(31 41 55) !important;
            forced-color-adjust: none !important;
          }
        `,document.head.appendChild(o);const i=()=>{document.querySelectorAll(".dark-table-container table").forEach(P=>{P.style.setProperty("background-color","rgb(31 41 55)","important"),P.style.setProperty("forced-color-adjust","none","important");const E=P.querySelector("tbody");E&&(E.style.setProperty("background-color","rgb(31 41 55)","important"),E.querySelectorAll("tr").forEach((Q,X)=>{X%2===0?Q.style.setProperty("background-color","rgb(31 41 55)","important"):Q.style.setProperty("background-color","rgba(55 65 81, 0.7)","important"),Q.style.setProperty("forced-color-adjust","none","important")}));const G=P.querySelector("thead");G&&G.style.setProperty("background-color","rgb(55 65 81)","important");const de=P.closest(".table-wrapper-custom");de&&de.style.setProperty("background-color","rgb(31 41 55)","important")})};i(),setTimeout(i,100);const S=new MutationObserver(()=>{i()});return S.observe(document.body,{childList:!0,subtree:!0}),()=>{S.disconnect();const m=document.getElementById("enhanced-table-dark-override");m&&m.remove()}}})(),[O,p,n]);const[F,q]=K.useState(""),[B,R]=K.useState(null),[U,V]=K.useState(null),[h,z]=K.useState(1),[C,D]=K.useState(s),t=K.useMemo(()=>{if(!F)return n;const l=c.filter(x=>x.searchable!==!1);return n.filter(x=>l.some(r=>{const o=r.accessor?r.accessor(x):x[r.key];return o==null?!1:String(o).toLowerCase().includes(F.toLowerCase())}))},[n,F,c]),d=K.useMemo(()=>{if(!B||!U)return t;const l=c.find(x=>x.key===B);return l?[...t].sort((x,r)=>{const o=l.accessor?l.accessor(x):x[l.key],i=l.accessor?l.accessor(r):r[l.key];if(o==null)return 1;if(i==null)return-1;const S=o<i?-1:o>i?1:0;return U==="asc"?S:-S}):t},[t,B,U,c]),j=K.useMemo(()=>{if(!a)return d;const l=(h-1)*C;return d.slice(l,l+C)},[d,h,C,a]),k=Math.ceil(d.length/C),xe=l=>{B===l?U==="asc"?V("desc"):U==="desc"&&(V(null),R(null)):(R(l),V("asc"))},he=l=>B!==l?e.jsx(rr,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"}):U==="asc"?e.jsx(Pe,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}):e.jsx(Me,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"});return M?e.jsx(pr,{rows:C,columns:c.length,showPagination:a}):e.jsxs("div",{className:L("w-full dark-table-container",v),"data-theme":u?"dark":"light",style:{backgroundColor:u?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},children:[b&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(W,{placeholder:w,value:F,onChange:l=>{q(l.target.value),z(1)},className:"pl-10 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100"})]})}),e.jsx("div",{className:L("border rounded-lg overflow-hidden transition-colors table-wrapper-custom","border-gray-200 dark:border-gray-700"),style:{maxHeight:$,backgroundColor:u?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},"data-dark-table":u,children:e.jsxs("table",{className:L("w-full table-custom-dark",u&&"dark-table-forced"),style:{backgroundColor:u?"rgb(31 41 55)":"white",color:u?"rgb(241 245 249)":"rgb(17 24 39)",forcedColorAdjust:"none"},"data-theme":u?"dark":"light",children:[e.jsx("thead",{className:L("border-b transition-colors thead-custom","border-gray-200 dark:border-gray-600",ie&&"sticky top-0 z-10"),style:{backgroundColor:u?"rgb(55 65 81)":"rgb(249 250 251)",forcedColorAdjust:"none"},children:e.jsx("tr",{children:c.map(l=>e.jsx("th",{className:L("px-4 py-3 text-left text-xs font-medium uppercase tracking-wider transition-colors","text-gray-600 dark:text-gray-300",l.align==="center"&&"text-center",l.align==="right"&&"text-right",l.sortable!==!1&&"cursor-pointer select-none hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",l.className),style:{width:l.width},onClick:()=>l.sortable!==!1&&xe(String(l.key)),children:e.jsxs("div",{className:L("flex items-center gap-1",l.align==="center"&&"justify-center",l.align==="right"&&"justify-end"),children:[e.jsx("span",{children:l.header}),l.sortable!==!1&&he(String(l.key))]})},String(l.key)))})}),e.jsx("tbody",{className:L("divide-y transition-colors tbody-custom","divide-gray-200 dark:divide-gray-700"),style:{backgroundColor:u?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},children:j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:c.length,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400 td-custom-empty",style:{backgroundColor:u?"rgb(31 41 55)":"white",color:u?"rgb(156 163 175)":"rgb(107 114 128)",forcedColorAdjust:"none"},children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(fe,{className:"h-12 w-12 text-gray-300 dark:text-gray-600 mb-3"}),e.jsx("p",{children:T})]})})}):j.map((l,x)=>e.jsx("tr",{className:L("transition-colors tr-custom-row",f&&"cursor-pointer"),style:{backgroundColor:u?x%2===0?"rgb(31 41 55) !important":"rgba(55 65 81, 0.7) !important":x%2===0?"white !important":"rgb(249 250 251) !important",forcedColorAdjust:"none",transition:"background-color 0.2s ease"},onMouseEnter:r=>{u?r.currentTarget.style.backgroundColor="rgb(55 65 81) !important":r.currentTarget.style.backgroundColor="rgb(243 244 246) !important"},onMouseLeave:r=>{u?r.currentTarget.style.backgroundColor=x%2===0?"rgb(31 41 55) !important":"rgba(55 65 81, 0.7) !important":r.currentTarget.style.backgroundColor=x%2===0?"white !important":"rgb(249 250 251) !important"},onClick:()=>f?.(l),children:c.map(r=>e.jsx("td",{className:L("px-4 py-3 text-sm transition-colors td-custom","text-gray-900 dark:text-gray-100",r.align==="center"&&"text-center",r.align==="right"&&"text-right",r.className),style:{backgroundColor:"transparent !important",forcedColorAdjust:"none"},children:r.accessor?r.accessor(l):l[r.key]},String(r.key)))},g(l)))})]},_)}),a&&k>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"표시 개수:"}),e.jsxs(se,{value:String(C),onValueChange:l=>{D(Number(l)),z(1)},children:[e.jsx(oe,{className:"w-20 h-8 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:e.jsx(le,{})}),e.jsx(ne,{className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:y.map(l=>e.jsx(A,{value:String(l),className:"text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:l},l))})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(1),disabled:h===1,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"처음"}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(l=>Math.max(1,l-1)),disabled:h===1,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"이전"}),e.jsx("div",{className:"flex items-center gap-1 mx-2",children:Array.from({length:Math.min(5,k)},(l,x)=>{let r;return k<=5||h<=3?r=x+1:h>=k-2?r=k-4+x:r=h-2+x,e.jsx(N,{variant:h===r?"default":"outline",size:"sm",onClick:()=>z(r),className:L("h-8 w-8 p-0",h===r?"bg-blue-600 dark:bg-blue-500 text-white dark:text-white border-blue-600 dark:border-blue-500":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700"),children:r},r)})}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(l=>Math.min(k,l+1)),disabled:h===k,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"다음"}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>z(k),disabled:h===k,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"마지막"})]}),e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["총 ",d.length,"개 중 ",(h-1)*C+1,"-",Math.min(h*C,d.length),"개"]})]})]})}const vr=Ue("inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium transition-all duration-200 border",{variants:{variant:{default:"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600",primary:"bg-primary-50 text-primary-700 border-primary-200 dark:bg-primary-900/50 dark:text-primary-300 dark:border-primary-800",success:"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/50 dark:text-green-300 dark:border-green-800",warning:"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/50 dark:text-yellow-300 dark:border-yellow-800",danger:"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/50 dark:text-red-300 dark:border-red-800",info:"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/50 dark:text-blue-300 dark:border-blue-800",purple:"bg-purple-50 text-purple-700 border-purple-200 dark:bg-purple-900/50 dark:text-purple-300 dark:border-purple-800",outline:"bg-transparent border-current"},size:{sm:"text-xs px-2 py-0.5",md:"text-xs px-2.5 py-1",lg:"text-sm px-3 py-1.5"},pulse:{true:"animate-pulse",false:""},interactive:{true:"cursor-pointer hover:scale-105 active:scale-95",false:""}},defaultVariants:{variant:"default",size:"md",pulse:!1,interactive:!1}});function ve({className:n,variant:c,size:b,pulse:w,interactive:a,icon:s,children:y,onRemove:f,animate:g=!0,...T}){return e.jsxs("div",{className:L(vr({variant:c,size:b,pulse:w,interactive:a}),g&&"transition-all duration-200","group relative",n),...T,children:[s&&e.jsx(s,{className:"h-3 w-3 transition-transform duration-200 group-hover:scale-110"}),e.jsx("span",{className:"transition-colors duration-200",children:y}),f&&e.jsx("button",{onClick:M=>{M.stopPropagation(),f()},className:"ml-1 -mr-1 hover:bg-black/10 dark:hover:bg-white/10 rounded-full p-0.5 transition-all duration-200 hover:scale-110 active:scale-95 focus:outline-none focus:ring-2 focus:ring-current/20","aria-label":"뱃지 제거",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"h-3 w-3 transition-transform duration-200",children:e.jsx("path",{d:"M5.28 4.22a.75.75 0 00-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 101.06 1.06L8 9.06l2.72 2.72a.75.75 0 101.06-1.06L9.06 8l2.72-2.72a.75.75 0 00-1.06-1.06L8 6.94 5.28 4.22z"})})})]})}function jr({prevStatus:n,...c}){const[b,w]=K.useState(!1);return K.useEffect(()=>{if(n&&n!==c.children){w(!0);const a=setTimeout(()=>w(!1),500);return()=>clearTimeout(a)}},[n,c.children]),e.jsx(ve,{...c,className:L(c.className,b&&"scale-110 shadow-lg")})}const kr={order:{draft:{label:"임시저장",variant:"default",icon:Ie,pulse:!1,description:"작성 중인 발주서"},pending:{label:"승인 대기",variant:"warning",icon:Ne,pulse:!0,description:"승인자 검토 대기 중"},approved:{label:"승인됨",variant:"info",icon:ue,pulse:!1,description:"승인 완료됨"},sent:{label:"발송됨",variant:"success",icon:ze,pulse:!1,description:"거래처에 발송 완료"},completed:{label:"완료",variant:"success",icon:ue,pulse:!1,description:"발주 처리 완료"},rejected:{label:"반려됨",variant:"danger",icon:De,pulse:!1,description:"승인이 거부됨"},cancelled:{label:"취소됨",variant:"default",icon:yr,pulse:!1,description:"발주가 취소됨"}},user:{active:{label:"활성",variant:"success",icon:Ke,pulse:!1},inactive:{label:"비활성",variant:"default",icon:pe,pulse:!1},pending:{label:"승인 대기",variant:"warning",icon:Ne,pulse:!0}},vendor:{active:{label:"활성",variant:"success",icon:He,pulse:!1},inactive:{label:"비활성",variant:"default",icon:pe,pulse:!1},verified:{label:"검증됨",variant:"info",icon:ue,pulse:!1},unverified:{label:"미검증",variant:"warning",icon:we,pulse:!1}},project:{active:{label:"진행 중",variant:"primary",icon:hr,pulse:!1},completed:{label:"완료",variant:"success",icon:ue,pulse:!1},on_hold:{label:"보류",variant:"warning",icon:pe,pulse:!1},cancelled:{label:"취소",variant:"default",icon:De,pulse:!1}},priority:{low:{label:"낮음",variant:"default",icon:tr,pulse:!1},normal:{label:"보통",variant:"info",icon:ar,pulse:!1},high:{label:"높음",variant:"warning",icon:sr,pulse:!1},urgent:{label:"긴급",variant:"danger",icon:we,pulse:!0}}};function Nr({type:n,status:c,showIcon:b=!0,showTooltip:w=!1,animated:a=!1,prevStatus:s,className:y,...f}){const g=kr[n]?.[c];if(!g)return console.warn(`Unknown status "${c}" for type "${n}"`),e.jsx(ve,{variant:"default",className:y,...f,children:c});const T=a?jr:ve,M=a?{prevStatus:s}:{};return e.jsxs("div",{className:"relative group",children:[e.jsx(T,{variant:g.variant,icon:b?g.icon:void 0,pulse:g.pulse,className:y,...M,...f,children:g.label}),w&&g.description&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[g.description,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]})}function wr({open:n,onOpenChange:c,selectedOrders:b,onConfirm:w,isLoading:a=!1}){const s=()=>{w()},y=b.reduce((g,T)=>{const M=Number(T.totalAmount)||0;return console.log("💰 Processing order amount:",{orderId:T.id,orderNumber:T.orderNumber,totalAmount:T.totalAmount,parsed:M}),g+M},0),f=g=>new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0}).format(g);return e.jsx(or,{open:n,onOpenChange:c,children:e.jsxs(lr,{className:"max-w-md",children:[e.jsx(nr,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-full",children:e.jsx(gr,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(ir,{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"발주서 일괄 삭제"}),e.jsx(dr,{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"선택된 발주서를 삭제하시겠습니까?"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-300",children:[e.jsx("strong",{children:"주의:"})," 삭제된 발주서는 복구할 수 없습니다."]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"선택된 발주서"}),e.jsxs(be,{variant:"destructive",className:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300",children:[b.length,"개"]})]}),e.jsxs("div",{className:"max-h-40 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-md p-3",children:[b.slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:g.orderNumber}),g.vendorName&&e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["(",g.vendorName,")"]})]}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:f(g.totalAmount)})]},g.id)),b.length>5&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center pt-2 border-t border-gray-200 dark:border-gray-600",children:["외 ",b.length-5,"개 더..."]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"총 금액"}),e.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:f(y)})]})]})]}),e.jsxs(cr,{className:"gap-2",children:[e.jsx(N,{variant:"outline",onClick:()=>c(!1),disabled:a,className:"text-gray-600 dark:text-gray-400",children:"취소"}),e.jsx(N,{variant:"destructive",onClick:s,disabled:a,className:"bg-red-600 hover:bg-red-700 text-white",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"삭제 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),b.length,"개 발주서 삭제"]})})]})]})})}function Cr({orders:n,isLoading:c=!1,isBulkDeleting:b=!1,onStatusChange:w,onDelete:a,onBulkDelete:s,onEmailSend:y,onViewEmailHistory:f,onViewPdf:g,sortBy:T,sortOrder:M,onSort:v}){const[ie,$]=Te(),{user:O}=Oe(),[p,u]=I.useState([]),[_,F]=I.useState(!1),q=O?.role==="admin",B=I.useCallback((t,d)=>{u(j=>d?[...j,t]:j.filter(k=>k!==t))},[]),R=I.useCallback(t=>{if(t){const d=n.filter(j=>j.status==="draft").map(j=>j.id);u(d)}else u([])},[n]),U=I.useCallback(()=>{p.length>0&&F(!0)},[p]),V=I.useCallback(()=>{s&&p.length>0&&(s(p),u([]),F(!1))},[s,p]),h=n.filter(t=>t.status==="draft"),z=h.length>0&&h.every(t=>p.includes(t.id));h.some(t=>p.includes(t.id)),console.log("🔍 EnhancedOrdersTable props:",{ordersCount:n.length,onEmailSend:!!y,onViewPdf:!!g,onViewEmailHistory:!!f,onBulkDelete:!!s,isAdmin:q,userRole:O?.role,userDetails:O?{id:O.id,name:O.name,email:O.email}:null,selectedOrderIds:p,draftOrdersCount:h.length,conditionCheck:q&&s});const C=t=>{const d=f?()=>f(t):void 0;if(!t.emailStatus||t.totalEmailsSent===0)return e.jsx(be,{variant:"outline",className:`text-muted-foreground ${d?"cursor-pointer hover:bg-muted":""}`,onClick:d,children:"미발송"});const j={sent:{icon:ze,label:"발송됨",className:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",tooltip:t.lastSentAt?`최근 발송: ${ae(new Date(t.lastSentAt),"yyyy.MM.dd HH:mm",{locale:te})}`:""},opened:{icon:Ce,label:"열람됨",className:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",tooltip:t.openedAt?`열람 시간: ${ae(new Date(t.openedAt),"yyyy.MM.dd HH:mm",{locale:te})}`:""},clicked:{icon:Ce,label:"클릭됨",className:"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300",tooltip:"링크 클릭됨"},failed:{icon:Se,label:"실패",className:"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300",tooltip:"발송 실패"},bounced:{icon:Se,label:"반송됨",className:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300",tooltip:"이메일 반송됨"}},k=j[t.emailStatus]||j.sent;return e.jsx(J,{children:e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs(be,{variant:"secondary",className:`${k.className} ${d?"cursor-pointer hover:opacity-80":""}`,onClick:d,children:[k.label,t.totalEmailsSent&&t.totalEmailsSent>1&&e.jsxs("span",{className:"ml-1",children:["(",t.totalEmailsSent,")"]})]})}),k.tooltip&&e.jsxs(re,{children:[e.jsx("p",{children:k.tooltip}),t.totalEmailsSent&&t.totalEmailsSent>1&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["총 ",t.totalEmailsSent,"회 발송"]}),d&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"클릭하여 상세 이력 보기"})]})]})})},D=[...q&&s?[{key:"select",header:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx($e,{checked:z,onCheckedChange:R,disabled:h.length===0,"aria-label":"모든 발주서 선택"})}),width:"40px",accessor:t=>e.jsx("div",{className:"flex items-center justify-center",onClick:d=>d.stopPropagation(),children:e.jsx($e,{checked:p.includes(t.id),onCheckedChange:d=>B(t.id,d),disabled:t.status!=="draft","aria-label":`발주서 ${t.orderNumber} 선택`})})}]:[],{key:"orderNumber",header:"발주 번호",sortable:!0,searchable:!0,width:"130px",accessor:t=>e.jsx("div",{className:"font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 cursor-pointer",onClick:d=>{d.stopPropagation();try{typeof $=="function"?$(`/orders/${t.id}`):window.location.href=`/orders/${t.id}`}catch(j){console.error("Navigation error:",j),window.location.href=`/orders/${t.id}`}},children:t.orderNumber})},{key:"status",header:"상태",sortable:!0,width:"100px",accessor:t=>e.jsx(Nr,{type:"order",status:t.status,showIcon:!1,showTooltip:!0,animated:!0})},{key:"emailStatus",header:"이메일",sortable:!0,width:"90px",accessor:t=>C(t)},{key:"projectName",header:"현장",sortable:!0,searchable:!0,width:"160px",accessor:t=>e.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:t.projectName||"-"})},{key:"vendorName",header:"거래처",sortable:!0,searchable:!0,width:"140px",accessor:t=>e.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:t.vendorName&&t.vendorId?e.jsx("div",{className:"font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 cursor-pointer hover:underline",onClick:d=>{d.stopPropagation();try{typeof $=="function"?$(`/vendors/${t.vendorId}`):window.location.href=`/vendors/${t.vendorId}`}catch(j){console.error("Navigation error:",j),window.location.href=`/vendors/${t.vendorId}`}},title:"거래처 상세 정보 보기",children:t.vendorName}):e.jsx("span",{children:t.vendorName||"-"})})},{key:"totalAmount",header:"금액",sortable:!0,align:"right",width:"120px",accessor:t=>e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:Re(t.totalAmount)})},{key:"orderDate",header:"발주일",sortable:!0,width:"100px",accessor:t=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:ae(new Date(t.orderDate),"yyyy.MM.dd",{locale:te})})},{key:"createdAt",header:"등록일",sortable:!0,width:"130px",accessor:t=>e.jsx("div",{className:"text-gray-500 dark:text-gray-500 text-xs",children:ae(new Date(t.createdAt),"yyyy.MM.dd HH:mm",{locale:te})})},{key:"deliveryDate",header:"납기일",sortable:!0,width:"110px",accessor:t=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:t.deliveryDate?ae(new Date(t.deliveryDate),"yyyy.MM.dd",{locale:te}):"-"})},{key:"userName",header:"요청자",sortable:!0,searchable:!0,width:"120px",accessor:t=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:t.userName||"-"})},{key:"actions",header:"액션",width:"160px",align:"center",accessor:t=>e.jsxs("div",{className:"flex items-center justify-center gap-1",onClick:d=>d.stopPropagation(),children:[e.jsx(J,{children:e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-900/20",onClick:()=>{try{typeof $=="function"?$(`/orders/${t.id}`):window.location.href=`/orders/${t.id}`}catch{window.location.href=`/orders/${t.id}`}},children:e.jsx(Ve,{className:"h-4 w-4"})})}),e.jsx(re,{children:e.jsx("p",{children:"상세 보기"})})]})}),e.jsx(J,{children:e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-green-50 hover:text-green-600 dark:hover:bg-green-900/20",onClick:()=>{try{typeof $=="function"?$(`/orders/${t.id}/edit`):window.location.href=`/orders/${t.id}/edit`}catch{window.location.href=`/orders/${t.id}/edit`}},children:e.jsx(mr,{className:"h-4 w-4"})})}),e.jsx(re,{children:e.jsx("p",{children:"수정"})})]})}),e.jsx(J,{children:e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-orange-50 hover:text-orange-600 dark:hover:bg-orange-900/20",onClick:()=>{g&&g(t)},children:e.jsx(Ie,{className:"h-4 w-4"})})}),e.jsx(re,{children:e.jsx("p",{children:"PDF 보기"})})]})}),e.jsx(J,{children:e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-purple-50 hover:text-purple-600 dark:hover:bg-purple-900/20 border border-purple-200",onClick:()=>{console.log("🔍 이메일 버튼 클릭됨",{row:t,onEmailSend:!!y}),y?y(t):alert("이메일 전송 기능이 설정되지 않았습니다.")},style:{backgroundColor:"rgba(147, 51, 234, 0.1)"},children:e.jsx(ur,{className:"h-4 w-4 text-purple-600"})})}),e.jsx(re,{children:e.jsx("p",{children:"이메일 전송 (Debug)"})})]})})]})}];return e.jsxs("div",{className:"space-y-4",children:[q&&s&&p.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:[p.length,"개의 발주서가 선택됨"]}),e.jsx(be,{variant:"outline",className:"text-blue-600 border-blue-300",children:"임시저장 상태만 삭제 가능"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>u([]),className:"text-gray-600 dark:text-gray-400",children:"선택 해제"}),e.jsxs(N,{variant:"destructive",size:"sm",onClick:U,className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(Le,{className:"h-4 w-4 mr-2"}),"선택된 발주서 삭제"]})]})]}),e.jsx(fr,{data:n,columns:D,searchable:!0,searchPlaceholder:"발주 번호, 프로젝트, 거래처, 요청자로 검색...",showPagination:!0,pageSize:20,pageSizeOptions:[10,20,50,100],onRowClick:t=>{try{typeof $=="function"?$(`/orders/${t.id}`):window.location.href=`/orders/${t.id}`}catch{window.location.href=`/orders/${t.id}`}},rowKey:t=>t.id,emptyMessage:"등록된 발주서가 없습니다",isLoading:c,stickyHeader:!0,maxHeight:"calc(100vh - 300px)",className:"shadow-sm"}),e.jsx(wr,{open:_,onOpenChange:F,selectedOrders:n.filter(t=>p.includes(t.id)),onConfirm:V,isLoading:b})]})}function st(){Oe();const{toast:n}=_e(),[c,b]=Te(),{theme:w}=Ae(),a=w==="dark";I.useEffect(()=>{console.log("🔍 Orders Page Theme Debug:",{theme:w,isDarkMode:a,htmlClass:document.documentElement.className,bodyClass:document.body.className})},[w,a]);const[s,y]=I.useState({status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50,sortBy:"orderDate",sortOrder:"desc"}),[f,g]=I.useState(!1),[T,M]=I.useState(!1),[v,ie]=I.useState(null),[$,O]=I.useState(!1),[p,u]=I.useState(null);I.useEffect(()=>{const r=new URLSearchParams(window.location.search),o=r.get("status"),i=r.get("filter"),S=r.get("vendor"),m={page:1,status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",limit:50};if(o&&!i)m.status=o==="all"?"":o;else if(i==="monthly"){const P=new Date,E=P.getFullYear(),G=P.getMonth(),de=new Date(E,G,1),ke=new Date(E,G+1,0),Q=X=>{const Fe=X.getFullYear(),qe=String(X.getMonth()+1).padStart(2,"0"),Be=String(X.getDate()).padStart(2,"0");return`${Fe}-${qe}-${Be}`};m.startDate=Q(de),m.endDate=Q(ke)}else if(i==="urgent"){const P=new Date,E=new Date;E.setDate(P.getDate()+7),m.startDate=P.toISOString().split("T")[0],m.endDate=E.toISOString().split("T")[0],m.status="approved"}S&&(m.vendorId=S),y(m)},[c]);const{data:_,isLoading:F}=Qe(s),{data:q}=Ye(),{data:B}=We(),{data:R}=Ge(),{data:U}=Xe(),V=ce({mutationFn:async({orderId:r,status:o})=>{await ye("PUT",`/api/orders/${r}/status`,{status:o})},onSuccess:()=>{ge.invalidateQueries({predicate:r=>r.queryKey.some(i=>i==="/api/orders-optimized"||i==="orders-optimized"||typeof i=="string"&&i.includes("orders"))}),n({title:"성공",description:"발주서 상태가 변경되었습니다."})},onError:r=>{if(me(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}n({title:"오류",description:"발주서 상태 변경에 실패했습니다.",variant:"destructive"})}}),h=ce({mutationFn:async r=>{await ye("DELETE",`/api/orders/${r}`)},onSuccess:()=>{ge.invalidateQueries({predicate:r=>r.queryKey.some(i=>i==="/api/orders-optimized"||i==="orders-optimized"||typeof i=="string"&&i.includes("orders"))}),n({title:"성공",description:"발주서가 삭제되었습니다."})},onError:r=>{if(me(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}n({title:"오류",description:"발주서 삭제에 실패했습니다.",variant:"destructive"})}}),z=ce({mutationFn:async r=>{console.log("🗑️ Bulk delete request:",{orderIds:r,parsedIds:r.map(o=>parseInt(o,10))}),await ye("DELETE","/api/orders/bulk",{orderIds:r.map(o=>parseInt(o,10))})},onSuccess:async(r,o)=>{await ge.invalidateQueries({predicate:i=>i.queryKey.some(m=>m==="/api/orders-optimized"||m==="orders-optimized"||typeof m=="string"&&m.includes("orders"))}),await ge.refetchQueries({predicate:i=>i.queryKey.some(m=>m==="/api/orders-optimized"||m==="orders-optimized")}),n({title:"성공",description:`${o.length}개의 발주서가 삭제되었습니다.`})},onError:r=>{if(me(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}if(r?.response?.data?.nonDeletableOrders){const i=r.response.data.nonDeletableOrders.map(S=>S.orderNumber).join(", ");n({title:"일부 발주서 삭제 불가",description:`다음 발주서들은 임시저장 상태가 아니어서 삭제할 수 없습니다: ${i}`,variant:"destructive"})}else n({title:"오류",description:r?.response?.data?.message||"발주서 일괄 삭제에 실패했습니다.",variant:"destructive"})}}),C=ce({mutationFn:async()=>{const r=new URLSearchParams;Object.entries(s).forEach(([P,E])=>{E&&E!=="all"&&E!==""&&r.append(P,E.toString())});const o=await fetch(`/api/orders/export?${r}`,{credentials:"include"});if(!o.ok)throw new Error("Export failed");const i=await o.blob(),S=window.URL.createObjectURL(i),m=document.createElement("a");m.href=S,m.download="orders.xlsx",document.body.appendChild(m),m.click(),window.URL.revokeObjectURL(S),document.body.removeChild(m)},onError:r=>{if(me(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{b("/login")},500);return}n({title:"오류",description:"엑셀 다운로드에 실패했습니다.",variant:"destructive"})}}),D=(r,o)=>{const i=o==="all"?"":o;y(S=>({...S,[r]:i,page:1}))},t=r=>{y(o=>({...o,sortBy:r,sortOrder:o.sortBy===r&&o.sortOrder==="desc"?"asc":"desc",page:1}))},d=r=>{const o=l.find(i=>i.id===r.id);o&&(ie(o),M(!0))},j=async r=>{if(v)try{const o={orderNumber:v.orderNumber,vendorName:v.vendor?.name||"",orderDate:v.orderDate,totalAmount:v.totalAmount,siteName:v.project?.projectName,filePath:v.filePath||""};await Ze.sendPurchaseOrderEmail(o,r),n({title:"이메일 발송 완료",description:`${v.vendor?.name}에게 발주서 ${v.orderNumber}를 전송했습니다.`})}catch(o){n({title:"이메일 발송 실패",description:o instanceof Error?o.message:"이메일 발송 중 오류가 발생했습니다.",variant:"destructive"})}},k=r=>{const o=l.find(i=>i.id===r.id);o&&(u(o),O(!0))},xe=r=>{const o=l.find(i=>i.id===r.id);o&&(o.filePath?window.open(`/api/orders/${o.id}/download`,"_blank"):n({title:"PDF 생성 중",description:"발주서 PDF를 생성하고 있습니다. 잠시 후 다시 시도해주세요."}))},he=r=>{z.mutate(r)},l=_?.orders||[],x=l.map(r=>{const o=U?.find(i=>i.id===r.id);return{...r,emailStatus:o?.email_status||null,lastSentAt:o?.last_sent_at||null,totalEmailsSent:o?.total_emails_sent||0,openedAt:o?.opened_at||null}});return console.log("🔍 Orders Page - ordersData:",_),console.log("🔍 Orders Page - orders array:",l),console.log("🔍 Orders Page - first order:",l[0]),console.log("🔍 Orders Page - emailStatusData:",U),console.log("🔍 Orders Page - isLoading:",F),console.log("🔍 Orders Page - filters:",s),e.jsx("div",{className:`min-h-screen transition-colors ${a?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${a?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(br,{className:`h-6 w-6 transition-colors ${a?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${a?"text-white":"text-gray-900"}`,children:"발주서 관리"}),s.vendorId&&s.vendorId!==""?e.jsxs("p",{className:`text-sm font-medium mt-1 transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:[Array.isArray(q)?q.find(r=>r.id.toString()===s.vendorId)?.name:"거래처"," 거래처 발주서"]}):e.jsx("p",{className:`text-sm mt-1 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"전체 발주서를 조회하고 관리하세요"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[s.vendorId&&s.vendorId!==""&&e.jsx(N,{variant:"outline",size:"sm",onClick:()=>D("vendorId",""),className:`transition-colors ${a?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"전체 발주서 보기"}),e.jsxs(N,{onClick:()=>C.mutate(),disabled:C.isPending,variant:"outline",size:"sm",className:`transition-colors ${a?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),C.isPending?"내보내는 중...":"엑셀 다운로드"]})]})]})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-3 mb-3",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:`text-sm font-medium block mb-2 transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),e.jsx(W,{placeholder:"발주번호, 거래처명으로 검색...",value:s.searchText,onChange:r=>D("searchText",r.target.value),className:`pl-10 h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.searchText?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]}),e.jsxs("div",{className:"w-full xl:w-72",children:[e.jsx("label",{className:`text-sm font-medium block mb-2 transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"현장"}),e.jsxs(se,{value:s.projectId||"all",onValueChange:r=>D("projectId",r),children:[e.jsx(oe,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.projectId&&s.projectId!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(le,{placeholder:"모든 현장"})}),e.jsxs(ne,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(A,{value:"all",children:"모든 현장"}),B?.map(r=>e.jsxs(A,{value:r.id.toString(),children:[r.projectName," (",r.projectCode,")"]},r.id))]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(N,{variant:"outline",onClick:()=>g(!f),className:`flex items-center gap-2 h-11 text-sm px-4 rounded-lg transition-colors ${a?"border-gray-600 text-gray-200 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,size:"sm",children:[e.jsx(xr,{className:"h-4 w-4"}),"고급 필터",f?e.jsx(Pe,{className:"h-4 w-4"}):e.jsx(Me,{className:"h-4 w-4"})]})})]})}),f&&e.jsx("div",{className:`border-t pt-6 mt-4 transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2 xl:col-span-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"금액 범위"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{type:"number",placeholder:"최소금액",value:s.minAmount,onChange:r=>D("minAmount",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.minAmount?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`}),e.jsx("span",{className:`text-sm transition-colors ${a?"text-gray-500":"text-gray-400"}`,children:"~"}),e.jsx(W,{type:"number",placeholder:"최대금액",value:s.maxAmount,onChange:r=>D("maxAmount",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.maxAmount?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"발주일 범위"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(W,{type:"date",value:s.startDate,onChange:r=>D("startDate",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.startDate?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`}),e.jsx("span",{className:`text-sm transition-colors ${a?"text-gray-500":"text-gray-400"}`,children:"~"}),e.jsx(W,{type:"date",value:s.endDate,onChange:r=>D("endDate",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.endDate?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"거래처"}),e.jsxs(se,{value:s.vendorId||"all",onValueChange:r=>D("vendorId",r),children:[e.jsx(oe,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.vendorId&&s.vendorId!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(le,{placeholder:"모든 거래처"})}),e.jsxs(ne,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(A,{value:"all",children:"모든 거래처"}),Array.isArray(q)?q.map(r=>e.jsx(A,{value:r.id.toString(),children:r.name},r.id)):null]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"발주 상태"}),e.jsxs(se,{value:s.status||"all",onValueChange:r=>D("status",r),children:[e.jsx(oe,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.status&&s.status!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(le,{placeholder:"모든 상태"})}),e.jsxs(ne,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(A,{value:"all",children:"모든 상태"}),e.jsx(A,{value:"draft",children:Y("draft")}),e.jsx(A,{value:"pending",children:Y("pending")}),e.jsx(A,{value:"approved",children:Y("approved")}),e.jsx(A,{value:"sent",children:Y("sent")}),e.jsx(A,{value:"completed",children:Y("completed")}),e.jsx(A,{value:"rejected",children:Y("rejected")})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${a?"text-gray-300":"text-gray-700"}`,children:"작성자"}),e.jsxs(se,{value:s.userId||"all",onValueChange:r=>D("userId",r),children:[e.jsx(oe,{className:`h-11 text-sm rounded-lg transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${s.userId&&s.userId!==""?`${a?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(le,{placeholder:"모든 작성자"})}),e.jsxs(ne,{className:`transition-colors ${a?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(A,{value:"all",children:"모든 작성자"}),Array.isArray(R)?R.map(r=>e.jsx(A,{value:r.id,children:r.name||r.email},r.id)):null]})]})]})})]})}),e.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center justify-between gap-3 pt-4 mt-4 border-t transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:(s.projectId!==""||s.vendorId!==""||s.userId!==""||s.status!==""||s.startDate||s.endDate||s.minAmount||s.maxAmount||s.searchText)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`text-xs font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"적용된 필터:"}),s.searchText&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${a?"bg-blue-900/20 text-blue-300 border-blue-700":"bg-blue-50 text-blue-700 border-blue-200"}`,children:['검색: "',s.searchText,'"',e.jsx("button",{onClick:()=>D("searchText",""),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${a?"hover:bg-blue-800 text-blue-400":"hover:bg-blue-100 text-blue-600"}`,children:"×"})]}),s.projectId&&s.projectId!=="all"&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${a?"bg-gray-800 text-gray-300 border-gray-600":"bg-gray-50 text-gray-700 border-gray-200"}`,children:["현장: ",Array.isArray(B)&&B.find(r=>r.id.toString()===s.projectId)?.projectName||"선택된 현장",e.jsx("button",{onClick:()=>D("projectId","all"),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${a?"hover:bg-gray-700 text-gray-400":"hover:bg-gray-100 text-gray-600"}`,children:"×"})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[(s.projectId!==""||s.vendorId!==""||s.userId!==""||s.status!==""||s.startDate||s.endDate||s.minAmount||s.maxAmount||s.searchText)&&e.jsx(N,{variant:"outline",size:"sm",onClick:()=>{y({status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50,sortBy:"orderDate",sortOrder:"desc"})},className:`h-9 text-sm px-4 rounded-lg transition-colors ${a?"border-gray-600 hover:bg-gray-800":"border-gray-300 hover:bg-gray-50"}`,children:"필터 초기화"}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>C.mutate(),disabled:C.isPending,className:`h-9 text-sm px-4 rounded-lg transition-colors ${a?"border-gray-600 hover:bg-gray-800":"border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),C.isPending?"내보내는 중...":"엑셀 다운로드"]})]})]})]})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx(Cr,{orders:x.map(r=>{const o={...r,vendorName:r.vendor?.name||r.vendorName,vendorId:r.vendor?.id||r.vendorId,projectName:r.project?.projectName||r.projectName,userName:r.user?.name||r.userName};return console.log("🔍 Mapped order:",o),o}),isLoading:F,isBulkDeleting:z.isPending,onStatusChange:(r,o)=>V.mutate({orderId:r,status:o}),onDelete:r=>h.mutate(r),onBulkDelete:he,onEmailSend:d,onViewEmailHistory:k,onViewPdf:xe,sortBy:s.sortBy,sortOrder:s.sortOrder,onSort:t})}),v&&e.jsx(er,{open:T,onOpenChange:M,orderData:{orderNumber:v.orderNumber,vendorName:v.vendor?.name||"",vendorEmail:v.vendor?.email,orderDate:new Date(v.orderDate).toLocaleDateString(),totalAmount:v.totalAmount,siteName:v.project?.projectName},onSendEmail:j}),p&&e.jsx(Je,{orderId:p.id,orderNumber:p.orderNumber,isOpen:$,onClose:()=>{O(!1),u(null)}})]})})}export{st as default};
