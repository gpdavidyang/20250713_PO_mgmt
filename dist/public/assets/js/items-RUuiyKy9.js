var ho=Object.defineProperty;var fo=(t,e,r)=>e in t?ho(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var s=(t,e,r)=>fo(t,typeof e!="symbol"?e+"":e,r);import{aN as h,g as ai,aG as yo,aO as xo,G as qe,j as i,aH as _o,aI as H,aJ as W,aK as Y,aL as Z,I as Fe,aM as ae,B as X,H as oi,c as No,d as bo,u as vo,r as J,L as Ye,P as wo,M as xe,N as Ze,s as Ce,f as et,aP as tt,J as rt}from"./index-BU2aWoto.js";import{T as So,a as jo,b as _e,c as ee,d as Ao,e as M}from"./table-Dmy1_af3.js";import{S as Ve,a as Le,b as Me,c as Ee,d as ve}from"./select-BudDq3LJ.js";import{P as Io}from"./page-header-6G15JCiT.js";import{T as nt}from"./textarea-B--93A8X.js";import{S as To}from"./switch-IBOnSskJ.js";import{D as Po,a as Co,b as Do,c as $o}from"./dialog-CI01xLsi.js";import{S as Bo}from"./search-BDyqyIGi.js";import{L as qo}from"./list-B4PXGC4c.js";import{G as Fo}from"./grid-3x3-DqUHUV0a.js";import{S as st}from"./square-pen-Dz1yIYKT.js";import{T as it}from"./trash-2-CI8z793j.js";import{R as Vo,S as Lo}from"./scale-CJYocHkd.js";import{D as Mo}from"./dollar-sign-CxHIfYcj.js";import{C as Eo}from"./chevron-up-D3smOQ6o.js";import{C as zo}from"./chevron-down-CxNQlc8T.js";import"./index-CytCR7zz.js";import"./index-DTwkR-7G.js";const l=Symbol.for("drizzle:entityKind");function q(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,l))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(l in r&&r[l]===e[l])return!0;r=Object.getPrototypeOf(r)}return!1}var mt;mt=l;class ce{constructor(e,r){s(this,"name");s(this,"keyAsName");s(this,"primary");s(this,"notNull");s(this,"default");s(this,"defaultFn");s(this,"onUpdateFn");s(this,"hasDefault");s(this,"isUnique");s(this,"uniqueName");s(this,"uniqueType");s(this,"dataType");s(this,"columnType");s(this,"enumValues");s(this,"generated");s(this,"generatedIdentity");s(this,"config");this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}s(ce,mt,"Column");var pt;pt=l;class li{constructor(e,r,n){s(this,"config");s(this,"$default",this.$defaultFn);s(this,"$onUpdate",this.$onUpdateFn);this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}s(li,pt,"ColumnBuilder");const oe=Symbol.for("drizzle:Name");var gt;gt=l;class ci{constructor(e,r){s(this,"reference");s(this,"_onUpdate","no action");s(this,"_onDelete","no action");this.reference=()=>{const{name:n,columns:a,foreignColumns:c}=e();return{name:n,columns:a,foreignTable:c[0].table,foreignColumns:c}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new ui(e,this)}}s(ci,gt,"PgForeignKeyBuilder");var ht;ht=l;class ui{constructor(e,r){s(this,"reference");s(this,"onUpdate");s(this,"onDelete");this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}getName(){const{name:e,columns:r,foreignColumns:n}=this.reference(),a=r.map(f=>f.name),c=n.map(f=>f.name),p=[this.table[oe],...a,n[0].table[oe],...c];return e??`${p.join("_")}_fk`}}s(ui,ht,"PgForeignKey");function Qo(t,...e){return t(...e)}function di(t){return new gi(t)}function mi(t,e){return`${t[oe]}_${e.join("_")}_unique`}var ft;ft=l;class pi{constructor(e,r){s(this,"columns");s(this,"nullsNotDistinctConfig",!1);this.name=r,this.columns=e}nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new hi(e,this.columns,this.nullsNotDistinctConfig,this.name)}}s(pi,ft,"PgUniqueConstraintBuilder");var yt;yt=l;class gi{constructor(e){s(this,"name");this.name=e}on(...e){return new pi(e,this.name)}}s(gi,yt,"PgUniqueOnConstraintBuilder");var xt;xt=l;class hi{constructor(e,r,n,a){s(this,"columns");s(this,"name");s(this,"nullsNotDistinct",!1);this.table=e,this.columns=r,this.name=a??mi(this.table,this.columns.map(c=>c.name)),this.nullsNotDistinct=n}getName(){return this.name}}s(hi,xt,"PgUniqueConstraint");function at(t,e,r){for(let n=e;n<t.length;n++){const a=t[n];if(a==="\\"){n++;continue}if(a==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(a===","||a==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function fi(t,e=0){const r=[];let n=e,a=!1;for(;n<t.length;){const c=t[n];if(c===","){(a||n===e)&&r.push(""),a=!0,n++;continue}if(a=!1,c==="\\"){n+=2;continue}if(c==='"'){const[N,x]=at(t,n+1,!0);r.push(N),n=x;continue}if(c==="}")return[r,n+1];if(c==="{"){const[N,x]=fi(t,n+1);r.push(N),n=x;continue}const[p,f]=at(t,n,!1);r.push(p),n=f}return[r,n]}function Oo(t){const[e]=fi(t,1);return e}function yi(t){return`{${t.map(e=>Array.isArray(e)?yi(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var _t,Nt;class v extends(Nt=li,_t=l,Nt){constructor(){super(...arguments);s(this,"foreignKeyConfigs",[])}array(r){return new _i(this.config.name,this,r)}references(r,n={}){return this.foreignKeyConfigs.push({ref:r,actions:n}),this}unique(r,n){return this.config.isUnique=!0,this.config.uniqueName=r,this.config.uniqueType=n?.nulls,this}generatedAlwaysAs(r){return this.config.generated={as:r,type:"always",mode:"stored"},this}buildForeignKeys(r,n){return this.foreignKeyConfigs.map(({ref:a,actions:c})=>Qo((p,f)=>{const N=new ci(()=>{const x=p();return{columns:[r],foreignColumns:[x]}});return f.onUpdate&&N.onUpdate(f.onUpdate),f.onDelete&&N.onDelete(f.onDelete),N.build(n)},a,c))}buildExtraConfigColumn(r){return new xi(r,this.config)}}s(v,_t,"PgColumnBuilder");var bt,vt;class y extends(vt=ce,bt=l,vt){constructor(e,r){r.uniqueName||(r.uniqueName=mi(e,[r.name])),super(e,r),this.table=e}}s(y,bt,"PgColumn");var wt,St;class xi extends(St=y,wt=l,St){constructor(){super(...arguments);s(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});s(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(r){return this.indexConfig.opClass=r,this}}s(xi,wt,"ExtraConfigColumn");var jt;jt=l;class Ne{constructor(e,r,n,a){s(this,"name");s(this,"keyAsName");s(this,"type");s(this,"indexConfig");this.name=e,this.keyAsName=r,this.type=n,this.indexConfig=a}}s(Ne,jt,"IndexedColumn");var At,It;class _i extends(It=v,At=l,It){constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){const r=this.config.baseBuilder.build(e);return new ze(e,this.config,r)}}s(_i,At,"PgArrayBuilder");var Tt,Pt;const Ie=class Ie extends(Pt=y,Tt=l,Pt){constructor(r,n,a,c){super(r,n);s(this,"size");this.baseColumn=a,this.range=c,this.size=n.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(r){return typeof r=="string"&&(r=Oo(r)),r.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(r,n=!1){const a=r.map(c=>c===null?null:q(this.baseColumn,Ie)?this.baseColumn.mapToDriverValue(c,!0):this.baseColumn.mapToDriverValue(c));return n?a:yi(a)}};s(Ie,Tt,"PgArray");let ze=Ie;const Qe=Symbol.for("drizzle:isPgEnum");function Uo(t){return!!t&&typeof t=="function"&&Qe in t&&t[Qe]===!0}var Ct,Dt;class Ni extends(Dt=v,Ct=l,Dt){constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new bi(e,this.config)}}s(Ni,Ct,"PgEnumColumnBuilder");var $t,Bt;class bi extends(Bt=y,$t=l,Bt){constructor(r,n){super(r,n);s(this,"enum",this.config.enum);s(this,"enumValues",this.config.enum.enumValues);this.enum=n.enum}getSQLType(){return this.enum.enumName}}s(bi,$t,"PgEnumColumn");function G(t,e){return Ko(t,e,void 0)}function Ko(t,e,r){const n=Object.assign(a=>new Ni(a??"",n),{enumName:t,enumValues:e,schema:r,[Qe]:!0});return n}var qt;qt=l;class Ue{constructor(e,r,n,a=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:a}}}s(Ue,qt,"Subquery");const Ro={startActiveSpan(t,e){return e()}},le=Symbol.for("drizzle:ViewBaseConfig"),De=Symbol.for("drizzle:Schema"),ot=Symbol.for("drizzle:Columns"),lt=Symbol.for("drizzle:ExtraConfigColumns"),$e=Symbol.for("drizzle:OriginalName"),Be=Symbol.for("drizzle:BaseName"),we=Symbol.for("drizzle:IsAlias"),ct=Symbol.for("drizzle:ExtraConfigBuilder"),vi=Symbol.for("drizzle:IsDrizzleTable");var Ft,Vt,Lt,Mt,Et,zt,Qt,Ot,Ut,Kt;Kt=l,Ut=oe,Ot=$e,Qt=De,zt=ot,Et=lt,Mt=Be,Lt=we,Vt=vi,Ft=ct;class E{constructor(e,r,n){s(this,Ut);s(this,Ot);s(this,Qt);s(this,zt);s(this,Et);s(this,Mt);s(this,Lt,!1);s(this,Vt,!0);s(this,Ft);this[oe]=this[$e]=e,this[De]=r,this[Be]=n}}s(E,Kt,"Table"),s(E,"Symbol",{Name:oe,Schema:De,OriginalName:$e,Columns:ot,ExtraConfigColumns:lt,BaseName:Be,IsAlias:we,ExtraConfigBuilder:ct});function wi(t){return typeof t=="object"&&t!==null&&vi in t}function Go(t){return t!=null&&typeof t.getSQL=="function"}function Xo(t){const e={sql:"",params:[]};for(const r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}var Rt;Rt=l;class U{constructor(e){s(this,"value");this.value=Array.isArray(e)?e:[e]}getSQL(){return new $([this])}}s(U,Rt,"StringChunk");var Gt;Gt=l;const te=class te{constructor(e){s(this,"decoder",Si);s(this,"shouldInlineParams",!1);this.queryChunks=e}append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Ro.startActiveSpan("drizzle.buildSQL",r=>{const n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){const n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:a,escapeName:c,escapeParam:p,prepareTyping:f,inlineParams:N,paramStartIndex:x}=n;return Xo(e.map(u=>{if(q(u,U))return{sql:u.value.join(""),params:[]};if(q(u,Se))return{sql:c(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){const b=[new U("(")];for(const[C,R]of u.entries())b.push(R),C<u.length-1&&b.push(new U(", "));return b.push(new U(")")),this.buildQueryFromSourceParams(b,n)}if(q(u,te))return this.buildQueryFromSourceParams(u.queryChunks,{...n,inlineParams:N||u.shouldInlineParams});if(q(u,E)){const b=u[E.Symbol.Schema],C=u[E.Symbol.Name];return{sql:b===void 0||u[we]?c(C):c(b)+"."+c(C),params:[]}}if(q(u,ce)){const b=a.getColumnCasing(u);if(r.invokeSource==="indexes")return{sql:c(b),params:[]};const C=u.table[E.Symbol.Schema];return{sql:u.table[we]||C===void 0?c(u.table[E.Symbol.Name])+"."+c(b):c(C)+"."+c(u.table[E.Symbol.Name])+"."+c(b),params:[]}}if(q(u,Ii)){const b=u[le].schema,C=u[le].name;return{sql:b===void 0||u[le].isAlias?c(C):c(b)+"."+c(C),params:[]}}if(q(u,Ke)){if(q(u.value,Ae))return{sql:p(x.value++,u),params:[u],typings:["none"]};const b=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(q(b,te))return this.buildQueryFromSourceParams([b],n);if(N)return{sql:this.mapInlineParam(b,n),params:[]};let C=["none"];return f&&(C=[f(u.encoder)]),{sql:p(x.value++,b),params:[b],typings:C}}return q(u,Ae)?{sql:p(x.value++,u),params:[u],typings:["none"]}:q(u,te.Aliased)&&u.fieldAlias!==void 0?{sql:c(u.fieldAlias),params:[]}:q(u,Ue)?u._.isWith?{sql:c(u._.alias),params:[]}:this.buildQueryFromSourceParams([new U("("),u._.sql,new U(") "),new Se(u._.alias)],n):Uo(u)?u.schema?{sql:c(u.schema)+"."+c(u.enumName),params:[]}:{sql:c(u.enumName),params:[]}:Go(u)?u.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([u.getSQL()],n):this.buildQueryFromSourceParams([new U("("),u.getSQL(),new U(")")],n):N?{sql:this.mapInlineParam(u,n),params:[]}:{sql:p(x.value++,u),params:[u],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){const n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new te.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}};s(te,Gt,"SQL");let $=te;var Xt;Xt=l;class Se{constructor(e){s(this,"brand");this.value=e}getSQL(){return new $([this])}}s(Se,Xt,"Name");const Si={mapFromDriverValue:t=>t},ji={mapToDriverValue:t=>t};({...Si,...ji});var Jt;Jt=l;class Ke{constructor(e,r=ji){s(this,"brand");this.value=e,this.encoder=r}getSQL(){return new $([this])}}s(Ke,Jt,"Param");function je(t,...e){const r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new U(t[0]));for(const[n,a]of e.entries())r.push(a,new U(t[n+1]));return new $(r)}(t=>{function e(){return new $([])}t.empty=e;function r(N){return new $(N)}t.fromList=r;function n(N){return new $([new U(N)])}t.raw=n;function a(N,x){const u=[];for(const[b,C]of N.entries())b>0&&x!==void 0&&u.push(x),u.push(C);return new $(u)}t.join=a;function c(N){return new Se(N)}t.identifier=c;function p(N){return new Ae(N)}t.placeholder=p;function f(N,x){return new Ke(N,x)}t.param=f})(je||(je={}));(t=>{var r;r=l;const n=class n{constructor(c,p){s(this,"isSelectionField",!1);this.sql=c,this.fieldAlias=p}getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}};s(n,r,"SQL.Aliased");let e=n;t.Aliased=e})($||($={}));var kt;kt=l;class Ae{constructor(e){this.name=e}getSQL(){return new $([this])}}s(Ae,kt,"Placeholder");const Ai=Symbol.for("drizzle:IsDrizzleView");var Ht,Wt,Yt;Yt=l,Wt=le,Ht=Ai;class Ii{constructor({name:e,schema:r,selectedFields:n,query:a}){s(this,Wt);s(this,Ht,!0);this[le]={name:e,originalName:e,schema:r,selectedFields:n,query:a,isExisting:!a,isAlias:!1}}getSQL(){return new $([this])}}s(Ii,Yt,"View");function Jo(t){return typeof t=="object"&&t!==null&&Ai in t}ce.prototype.getSQL=function(){return new $([this])};E.prototype.getSQL=function(){return new $([this])};Ue.prototype.getSQL=function(){return new $([this])};function ko(t){return t[E.Symbol.Columns]}function Ho(t){return t[le].selectedFields}function V(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}var Zt,er;class ge extends(er=v,Zt=l,er){generatedAlwaysAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}s(ge,Zt,"PgIntColumnBaseBuilder");var tr,rr;class Ti extends(rr=ge,tr=l,rr){constructor(e){super(e,"number","PgBigInt53")}build(e){return new Pi(e,this.config)}}s(Ti,tr,"PgBigInt53Builder");var nr,sr;class Pi extends(sr=y,nr=l,sr){getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}s(Pi,nr,"PgBigInt53");var ir,ar;class Ci extends(ar=ge,ir=l,ar){constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Di(e,this.config)}}s(Ci,ir,"PgBigInt64Builder");var or,lr;class Di extends(lr=y,or=l,lr){getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}s(Di,or,"PgBigInt64");function Wo(t,e){const{name:r,config:n}=V(t,e);return n.mode==="number"?new Ti(r):new Ci(r)}var cr,ur;class $i extends(ur=v,cr=l,ur){constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Bi(e,this.config)}}s($i,cr,"PgBigSerial53Builder");var dr,mr;class Bi extends(mr=y,dr=l,mr){getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}s(Bi,dr,"PgBigSerial53");var pr,gr;class qi extends(gr=v,pr=l,gr){constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Fi(e,this.config)}}s(qi,pr,"PgBigSerial64Builder");var hr,fr;class Fi extends(fr=y,hr=l,fr){getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}s(Fi,hr,"PgBigSerial64");function Yo(t,e){const{name:r,config:n}=V(t,e);return n.mode==="number"?new $i(r):new qi(r)}var yr,xr;class Vi extends(xr=v,yr=l,xr){constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Li(e,this.config)}}s(Vi,yr,"PgBooleanBuilder");var _r,Nr;class Li extends(Nr=y,_r=l,Nr){getSQLType(){return"boolean"}}s(Li,_r,"PgBoolean");function j(t){return new Vi(t??"")}var br,vr;class Mi extends(vr=v,br=l,vr){constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Ei(e,this.config)}}s(Mi,br,"PgCharBuilder");var wr,Sr;class Ei extends(Sr=y,wr=l,Sr){constructor(){super(...arguments);s(this,"length",this.config.length);s(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}s(Ei,wr,"PgChar");function Zo(t,e={}){const{name:r,config:n}=V(t,e);return new Mi(r,n)}var jr,Ar;class zi extends(Ar=v,jr=l,Ar){constructor(e){super(e,"string","PgCidr")}build(e){return new Qi(e,this.config)}}s(zi,jr,"PgCidrBuilder");var Ir,Tr;class Qi extends(Tr=y,Ir=l,Tr){getSQLType(){return"cidr"}}s(Qi,Ir,"PgCidr");function el(t){return new zi(t??"")}var Pr,Cr;class Oi extends(Cr=v,Pr=l,Cr){constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new Ui(e,this.config)}}s(Oi,Pr,"PgCustomColumnBuilder");var Dr,$r;class Ui extends($r=y,Dr=l,$r){constructor(r,n){super(r,n);s(this,"sqlName");s(this,"mapTo");s(this,"mapFrom");this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(r){return typeof this.mapFrom=="function"?this.mapFrom(r):r}mapToDriverValue(r){return typeof this.mapTo=="function"?this.mapTo(r):r}}s(Ui,Dr,"PgCustomColumn");function tl(t){return(e,r)=>{const{name:n,config:a}=V(e,r);return new Oi(n,a,t)}}var Br,qr;class ue extends(qr=v,Br=l,qr){defaultNow(){return this.default(je`now()`)}}s(ue,Br,"PgDateColumnBaseBuilder");var Fr,Vr;class Ki extends(Vr=ue,Fr=l,Vr){constructor(e){super(e,"date","PgDate")}build(e){return new Ri(e,this.config)}}s(Ki,Fr,"PgDateBuilder");var Lr,Mr;class Ri extends(Mr=y,Lr=l,Mr){getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}s(Ri,Lr,"PgDate");var Er,zr;class Gi extends(zr=ue,Er=l,zr){constructor(e){super(e,"string","PgDateString")}build(e){return new Xi(e,this.config)}}s(Gi,Er,"PgDateStringBuilder");var Qr,Or;class Xi extends(Or=y,Qr=l,Or){getSQLType(){return"date"}}s(Xi,Qr,"PgDateString");function pe(t,e){const{name:r,config:n}=V(t,e);return n?.mode==="date"?new Ki(r):new Gi(r)}var Ur,Kr;class Ji extends(Kr=v,Ur=l,Kr){constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new ki(e,this.config)}}s(Ji,Ur,"PgDoublePrecisionBuilder");var Rr,Gr;class ki extends(Gr=y,Rr=l,Gr){getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}s(ki,Rr,"PgDoublePrecision");function rl(t){return new Ji(t??"")}var Xr,Jr;class Hi extends(Jr=v,Xr=l,Jr){constructor(e){super(e,"string","PgInet")}build(e){return new Wi(e,this.config)}}s(Hi,Xr,"PgInetBuilder");var kr,Hr;class Wi extends(Hr=y,kr=l,Hr){getSQLType(){return"inet"}}s(Wi,kr,"PgInet");function nl(t){return new Hi(t??"")}var Wr,Yr;class Yi extends(Yr=ge,Wr=l,Yr){constructor(e){super(e,"number","PgInteger")}build(e){return new Zi(e,this.config)}}s(Yi,Wr,"PgIntegerBuilder");var Zr,en;class Zi extends(en=y,Zr=l,en){getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}s(Zi,Zr,"PgInteger");function _(t){return new Yi(t??"")}var tn,rn;class ea extends(rn=v,tn=l,rn){constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new ta(e,this.config)}}s(ea,tn,"PgIntervalBuilder");var nn,sn;class ta extends(sn=y,nn=l,sn){constructor(){super(...arguments);s(this,"fields",this.config.intervalConfig.fields);s(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const r=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${r}${n}`}}s(ta,nn,"PgInterval");function sl(t,e={}){const{name:r,config:n}=V(t,e);return new ea(r,n)}var an,on;class ra extends(on=v,an=l,on){constructor(e){super(e,"json","PgJson")}build(e){return new na(e,this.config)}}s(ra,an,"PgJsonBuilder");var ln,cn;class na extends(cn=y,ln=l,cn){constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}s(na,ln,"PgJson");function il(t){return new ra(t??"")}var un,dn;class sa extends(dn=v,un=l,dn){constructor(e){super(e,"json","PgJsonb")}build(e){return new ia(e,this.config)}}s(sa,un,"PgJsonbBuilder");var mn,pn;class ia extends(pn=y,mn=l,pn){constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}s(ia,mn,"PgJsonb");function I(t){return new sa(t??"")}var gn,hn;class aa extends(hn=v,gn=l,hn){constructor(e){super(e,"array","PgLine")}build(e){return new oa(e,this.config)}}s(aa,gn,"PgLineBuilder");var fn,yn;class oa extends(yn=y,fn=l,yn){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,a]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(a)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}s(oa,fn,"PgLine");var xn,_n;class la extends(_n=v,xn=l,_n){constructor(e){super(e,"json","PgLineABC")}build(e){return new ca(e,this.config)}}s(la,xn,"PgLineABCBuilder");var Nn,bn;class ca extends(bn=y,Nn=l,bn){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,a]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(a)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}s(ca,Nn,"PgLineABC");function al(t,e){const{name:r,config:n}=V(t,e);return!n?.mode||n.mode==="tuple"?new aa(r):new la(r)}var vn,wn;class ua extends(wn=v,vn=l,wn){constructor(e){super(e,"string","PgMacaddr")}build(e){return new da(e,this.config)}}s(ua,vn,"PgMacaddrBuilder");var Sn,jn;class da extends(jn=y,Sn=l,jn){getSQLType(){return"macaddr"}}s(da,Sn,"PgMacaddr");function ol(t){return new ua(t??"")}var An,In;class ma extends(In=v,An=l,In){constructor(e){super(e,"string","PgMacaddr8")}build(e){return new pa(e,this.config)}}s(ma,An,"PgMacaddr8Builder");var Tn,Pn;class pa extends(Pn=y,Tn=l,Pn){getSQLType(){return"macaddr8"}}s(pa,Tn,"PgMacaddr8");function ll(t){return new ma(t??"")}var Cn,Dn;class ga extends(Dn=v,Cn=l,Dn){constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new ha(e,this.config)}}s(ga,Cn,"PgNumericBuilder");var $n,Bn;class ha extends(Bn=y,$n=l,Bn){constructor(r,n){super(r,n);s(this,"precision");s(this,"scale");this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}s(ha,$n,"PgNumeric");function fa(t,e){const{name:r,config:n}=V(t,e);return new ga(r,n?.precision,n?.scale)}const K=fa;var qn,Fn;class ya extends(Fn=v,qn=l,Fn){constructor(e){super(e,"array","PgPointTuple")}build(e){return new xa(e,this.config)}}s(ya,qn,"PgPointTupleBuilder");var Vn,Ln;class xa extends(Ln=y,Vn=l,Ln){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}s(xa,Vn,"PgPointTuple");var Mn,En;class _a extends(En=v,Mn=l,En){constructor(e){super(e,"json","PgPointObject")}build(e){return new Na(e,this.config)}}s(_a,Mn,"PgPointObjectBuilder");var zn,Qn;class Na extends(Qn=y,zn=l,Qn){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}s(Na,zn,"PgPointObject");function cl(t,e){const{name:r,config:n}=V(t,e);return!n?.mode||n.mode==="tuple"?new ya(r):new _a(r)}function ul(t){const e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function ut(t,e){const r=new ArrayBuffer(8),n=new DataView(r);for(let a=0;a<8;a++)n.setUint8(a,t[e+a]);return n.getFloat64(0,!0)}function ba(t){const e=ul(t);let r=0;const n=e[r];r+=1;const a=new DataView(e.buffer),c=a.getUint32(r,n===1);if(r+=4,c&536870912&&(a.getUint32(r,n===1),r+=4),(c&65535)===1){const p=ut(e,r);r+=8;const f=ut(e,r);return r+=8,[p,f]}throw new Error("Unsupported geometry type")}var On,Un;class va extends(Un=v,On=l,Un){constructor(e){super(e,"array","PgGeometry")}build(e){return new wa(e,this.config)}}s(va,On,"PgGeometryBuilder");var Kn,Rn;class wa extends(Rn=y,Kn=l,Rn){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return ba(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}s(wa,Kn,"PgGeometry");var Gn,Xn;class Sa extends(Xn=v,Gn=l,Xn){constructor(e){super(e,"json","PgGeometryObject")}build(e){return new ja(e,this.config)}}s(Sa,Gn,"PgGeometryObjectBuilder");var Jn,kn;class ja extends(kn=y,Jn=l,kn){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){const r=ba(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}s(ja,Jn,"PgGeometryObject");function dl(t,e){const{name:r,config:n}=V(t,e);return!n?.mode||n.mode==="tuple"?new va(r):new Sa(r)}var Hn,Wn;class Aa extends(Wn=v,Hn=l,Wn){constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new Ia(e,this.config)}}s(Aa,Hn,"PgRealBuilder");var Yn,Zn;class Ia extends(Zn=y,Yn=l,Zn){constructor(r,n){super(r,n);s(this,"mapFromDriverValue",r=>typeof r=="string"?Number.parseFloat(r):r)}getSQLType(){return"real"}}s(Ia,Yn,"PgReal");function ml(t){return new Aa(t??"")}var es,ts;class Ta extends(ts=v,es=l,ts){constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Pa(e,this.config)}}s(Ta,es,"PgSerialBuilder");var rs,ns;class Pa extends(ns=y,rs=l,ns){getSQLType(){return"serial"}}s(Pa,rs,"PgSerial");function T(t){return new Ta(t??"")}var ss,is;class Ca extends(is=ge,ss=l,is){constructor(e){super(e,"number","PgSmallInt")}build(e){return new Da(e,this.config)}}s(Ca,ss,"PgSmallIntBuilder");var as,os;class Da extends(os=y,as=l,os){constructor(){super(...arguments);s(this,"mapFromDriverValue",r=>typeof r=="string"?Number(r):r)}getSQLType(){return"smallint"}}s(Da,as,"PgSmallInt");function pl(t){return new Ca(t??"")}var ls,cs;class $a extends(cs=v,ls=l,cs){constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ba(e,this.config)}}s($a,ls,"PgSmallSerialBuilder");var us,ds;class Ba extends(ds=y,us=l,ds){getSQLType(){return"smallserial"}}s(Ba,us,"PgSmallSerial");function gl(t){return new $a(t??"")}var ms,ps;class qa extends(ps=v,ms=l,ps){constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new Fa(e,this.config)}}s(qa,ms,"PgTextBuilder");var gs,hs;class Fa extends(hs=y,gs=l,hs){constructor(){super(...arguments);s(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}s(Fa,gs,"PgText");function S(t,e={}){const{name:r,config:n}=V(t,e);return new qa(r,n)}var fs,ys;class Va extends(ys=ue,fs=l,ys){constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}build(e){return new La(e,this.config)}}s(Va,fs,"PgTimeBuilder");var xs,_s;class La extends(_s=y,xs=l,_s){constructor(r,n){super(r,n);s(this,"withTimezone");s(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}s(La,xs,"PgTime");function hl(t,e={}){const{name:r,config:n}=V(t,e);return new Va(r,n.withTimezone??!1,n.precision)}var Ns,bs;class Ma extends(bs=ue,Ns=l,bs){constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new Ea(e,this.config)}}s(Ma,Ns,"PgTimestampBuilder");var vs,ws;class Ea extends(ws=y,vs=l,ws){constructor(r,n){super(r,n);s(this,"withTimezone");s(this,"precision");s(this,"mapFromDriverValue",r=>new Date(this.withTimezone?r:r+"+0000"));s(this,"mapToDriverValue",r=>r.toISOString());this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}s(Ea,vs,"PgTimestamp");var Ss,js;class za extends(js=ue,Ss=l,js){constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new Qa(e,this.config)}}s(za,Ss,"PgTimestampStringBuilder");var As,Is;class Qa extends(Is=y,As=l,Is){constructor(r,n){super(r,n);s(this,"withTimezone");s(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}s(Qa,As,"PgTimestampString");function d(t,e={}){const{name:r,config:n}=V(t,e);return n?.mode==="string"?new za(r,n.withTimezone??!1,n.precision):new Ma(r,n?.withTimezone??!1,n?.precision)}var Ts,Ps;class Oa extends(Ps=v,Ts=l,Ps){constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(je`gen_random_uuid()`)}build(e){return new Ua(e,this.config)}}s(Oa,Ts,"PgUUIDBuilder");var Cs,Ds;class Ua extends(Ds=y,Cs=l,Ds){getSQLType(){return"uuid"}}s(Ua,Cs,"PgUUID");function fl(t){return new Oa(t??"")}var $s,Bs;class Ka extends(Bs=v,$s=l,Bs){constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Ra(e,this.config)}}s(Ka,$s,"PgVarcharBuilder");var qs,Fs;class Ra extends(Fs=y,qs=l,Fs){constructor(){super(...arguments);s(this,"length",this.config.length);s(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}s(Ra,qs,"PgVarchar");function o(t,e={}){const{name:r,config:n}=V(t,e);return new Ka(r,n)}var Vs,Ls;class Ga extends(Ls=v,Vs=l,Ls){constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Xa(e,this.config)}}s(Ga,Vs,"PgBinaryVectorBuilder");var Ms,Es;class Xa extends(Es=y,Ms=l,Es){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}s(Xa,Ms,"PgBinaryVector");function yl(t,e){const{name:r,config:n}=V(t,e);return new Ga(r,n)}var zs,Qs;class Ja extends(Qs=v,zs=l,Qs){constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){return new ka(e,this.config)}}s(Ja,zs,"PgHalfVectorBuilder");var Os,Us;class ka extends(Us=y,Os=l,Us){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}s(ka,Os,"PgHalfVector");function xl(t,e){const{name:r,config:n}=V(t,e);return new Ja(r,n)}var Ks,Rs;class Ha extends(Rs=v,Ks=l,Rs){constructor(e,r){super(e,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(e){return new Wa(e,this.config)}}s(Ha,Ks,"PgSparseVectorBuilder");var Gs,Xs;class Wa extends(Xs=y,Gs=l,Xs){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}s(Wa,Gs,"PgSparseVector");function _l(t,e){const{name:r,config:n}=V(t,e);return new Ha(r,n)}var Js,ks;class Ya extends(ks=v,Js=l,ks){constructor(e,r){super(e,"array","PgVector"),this.config.dimensions=r.dimensions}build(e){return new Za(e,this.config)}}s(Ya,Js,"PgVectorBuilder");var Hs,Ws;class Za extends(Ws=y,Hs=l,Ws){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}s(Za,Hs,"PgVector");function Nl(t,e){const{name:r,config:n}=V(t,e);return new Ya(r,n)}function bl(){return{bigint:Wo,bigserial:Yo,boolean:j,char:Zo,cidr:el,customType:tl,date:pe,doublePrecision:rl,inet:nl,integer:_,interval:sl,json:il,jsonb:I,line:al,macaddr:ol,macaddr8:ll,numeric:fa,point:cl,geometry:dl,real:ml,serial:T,smallint:pl,smallserial:gl,text:S,time:hl,timestamp:d,uuid:fl,varchar:o,bit:yl,halfvec:xl,sparsevec:_l,vector:Nl}}const Oe=Symbol.for("drizzle:PgInlineForeignKeys"),dt=Symbol.for("drizzle:EnableRLS");var Ys,Zs,ei,ti,ri;class me extends(ri=E,ti=l,ei=Oe,Zs=dt,Ys=E.Symbol.ExtraConfigBuilder,ri){constructor(){super(...arguments);s(this,ei,[]);s(this,Zs,!1);s(this,Ys)}}s(me,ti,"PgTable"),s(me,"Symbol",Object.assign({},E.Symbol,{InlineForeignKeys:Oe,EnableRLS:dt}));function vl(t,e,r,n,a=t){const c=new me(t,n,a),p=typeof e=="function"?e(bl()):e,f=Object.fromEntries(Object.entries(p).map(([u,b])=>{const C=b;C.setName(u);const R=C.build(c);return c[Oe].push(...C.buildForeignKeys(R,c)),[u,R]})),N=Object.fromEntries(Object.entries(p).map(([u,b])=>{const C=b;C.setName(u);const R=C.buildExtraConfigColumn(c);return[u,R]})),x=Object.assign(c,f);return x[E.Symbol.Columns]=f,x[E.Symbol.ExtraConfigColumns]=N,r&&(x[me.Symbol.ExtraConfigBuilder]=r),Object.assign(x,{enableRLS:()=>(x[me.Symbol.EnableRLS]=!0,x)})}const A=(t,e,r)=>vl(t,e,r,void 0);var ni;ni=l;class eo{constructor(e,r){this.unique=e,this.name=r}on(...e){return new be(e.map(r=>{if(q(r,$))return r;r=r;const n=new Ne(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new be(e.map(r=>{if(q(r,$))return r;r=r;const n=new Ne(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new be(r.map(n=>{if(q(n,$))return n;n=n;const a=new Ne(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),a}),this.unique,!0,this.name,e)}}s(eo,ni,"PgIndexBuilderOn");var si;si=l;class be{constructor(e,r,n,a,c="btree"){s(this,"config");this.config={name:a,columns:e,unique:r,only:n,method:c}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new to(this.config,e)}}s(be,si,"PgIndexBuilder");var ii;ii=l;class to{constructor(e,r){s(this,"config");this.config={...e,table:r}}}s(to,ii,"PgIndex");function g(t){return new eo(!1,t)}const D={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function B(t,e){return e.includes(t.columnType)}function wl(t){return"enumValues"in t&&Array.isArray(t.enumValues)&&t.enumValues.length>0}const Sl=h.union([h.string(),h.number(),h.boolean(),h.null()]),jl=h.union([Sl,h.record(h.any()),h.array(h.any())]),Al=h.custom(t=>t instanceof Buffer);function ro(t,e){const r=e?.zodInstance??h,n=e?.coerce??{};let a;return wl(t)&&(a=t.enumValues.length?r.enum(t.enumValues):r.string()),a||(B(t,["PgGeometry","PgPointTuple"])?a=r.tuple([r.number(),r.number()]):B(t,["PgGeometryObject","PgPointObject"])?a=r.object({x:r.number(),y:r.number()}):B(t,["PgHalfVector","PgVector"])?(a=r.array(r.number()),a=t.dimensions?a.length(t.dimensions):a):B(t,["PgLine"])?a=r.tuple([r.number(),r.number(),r.number()]):B(t,["PgLineABC"])?a=r.object({a:r.number(),b:r.number(),c:r.number()}):B(t,["PgArray"])?(a=r.array(ro(t.baseColumn,r)),a=t.size?a.length(t.size):a):t.dataType==="array"?a=r.array(r.any()):t.dataType==="number"?a=Il(t,r,n):t.dataType==="bigint"?a=Tl(t,r,n):t.dataType==="boolean"?a=n===!0||n.boolean?r.coerce.boolean():r.boolean():t.dataType==="date"?a=n===!0||n.date?r.coerce.date():r.date():t.dataType==="string"?a=Pl(t,r,n):t.dataType==="json"?a=jl:t.dataType==="custom"?a=r.any():t.dataType==="buffer"&&(a=Al)),a||(a=r.any()),a}function Il(t,e,r){let n=t.getSQLType().includes("unsigned"),a,c,p=!1;B(t,["MySqlTinyInt","SingleStoreTinyInt"])?(a=n?0:D.INT8_MIN,c=n?D.INT8_UNSIGNED_MAX:D.INT8_MAX,p=!0):B(t,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(a=n?0:D.INT16_MIN,c=n?D.INT16_UNSIGNED_MAX:D.INT16_MAX,p=!0):B(t,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(a=n?0:D.INT24_MIN,c=n?D.INT24_UNSIGNED_MAX:D.INT24_MAX,p=B(t,["MySqlMediumInt","SingleStoreMediumInt"])):B(t,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(a=n?0:D.INT32_MIN,c=n?D.INT32_UNSIGNED_MAX:D.INT32_MAX,p=!0):B(t,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(a=n?0:D.INT48_MIN,c=n?D.INT48_UNSIGNED_MAX:D.INT48_MAX):B(t,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(n=n||B(t,["MySqlSerial","SingleStoreSerial"]),a=n?0:Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,p=!0):B(t,["MySqlYear","SingleStoreYear"])?(a=1901,c=2155,p=!0):(a=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER);let f=r===!0||r?.number?e.coerce.number():e.number();return f=f.min(a).max(c),p?f.int():f}function Tl(t,e,r){const n=t.getSQLType().includes("unsigned"),a=n?0n:D.INT64_MIN,c=n?D.INT64_UNSIGNED_MAX:D.INT64_MAX;return(r===!0||r?.bigint?e.coerce.bigint():e.bigint()).min(a).max(c)}function Pl(t,e,r){if(B(t,["PgUUID"]))return e.string().uuid();let n,a,c=!1;B(t,["PgVarchar","SQLiteText"])?n=t.length:B(t,["MySqlVarChar","SingleStoreVarChar"])?n=t.length??D.INT16_UNSIGNED_MAX:B(t,["MySqlText","SingleStoreText"])&&(t.textType==="longtext"?n=D.INT32_UNSIGNED_MAX:t.textType==="mediumtext"?n=D.INT24_UNSIGNED_MAX:t.textType==="text"?n=D.INT16_UNSIGNED_MAX:n=D.INT8_UNSIGNED_MAX),B(t,["PgChar","MySqlChar","SingleStoreChar"])&&(n=t.length,c=!0),B(t,["PgBinaryVector"])&&(a=/^[01]+$/,n=t.dimensions);let p=r===!0||r?.string?e.coerce.string():e.string();return p=a?p.regex(a):p,n&&c?p.length(n):n?p.max(n):p}function no(t){return wi(t)?ko(t):Ho(t)}function so(t,e,r,n){const a={};for(const[c,p]of Object.entries(t)){if(!q(p,ce)&&!q(p,$)&&!q(p,$.Aliased)&&typeof p=="object"){const b=wi(p)||Jo(p)?no(p):p;a[c]=so(b,e[c]??{},r,n);continue}const f=e[c];if(f!==void 0&&typeof f!="function"){a[c]=f;continue}const N=q(p,ce)?p:void 0,x=N?ro(N,n):h.any(),u=typeof f=="function"?f(x):x;r.never(N)||(a[c]=u,N&&(r.nullable(N)&&(a[c]=a[c].nullable()),r.optional(N)&&(a[c]=a[c].optional())))}return h.object(a)}const Cl={never:t=>t?.generated?.type==="always"||t?.generatedIdentity?.type==="always",optional:t=>!t.notNull||t.notNull&&t.hasDefault,nullable:t=>!t.notNull},P=(t,e)=>{const r=no(t);return so(r,{},Cl)};A("sessions",{sid:o("sid").primaryKey(),sess:I("sess").notNull(),expire:d("expire").notNull()},t=>[g("IDX_session_expire").on(t.expire)]);const io=A("ui_terms",{id:T("id").primaryKey(),termKey:o("term_key",{length:100}).notNull().unique(),termValue:o("term_value",{length:255}).notNull(),category:o("category",{length:50}).default("general"),description:S("description"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()}),Dl=A("item_categories",{id:T("id").primaryKey(),categoryType:o("category_type",{length:20}).notNull(),categoryName:o("category_name",{length:100}).notNull(),parentId:_("parent_id"),displayOrder:_("display_order").default(0),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[g("idx_item_categories_type").on(t.categoryType),g("idx_item_categories_parent").on(t.parentId)]),he=G("user_role",["field_worker","project_manager","hq_management","executive","admin"]),$l=G("purchase_order_status",["draft","pending","approved","sent","completed"]),Bl=G("project_status",["planning","active","on_hold","completed","cancelled"]),ql=G("project_type",["commercial","residential","industrial","infrastructure"]),Fl=G("invoice_status",["pending","verified","paid"]),Vl=G("item_receipt_status",["pending","approved","rejected"]),Ll=G("verification_action",["invoice_uploaded","item_verified","quality_checked"]),Ml=G("approval_step_status",["pending","approved","rejected","skipped"]),El=A("approval_authorities",{id:T("id").primaryKey(),role:he("role").notNull(),maxAmount:K("max_amount",{precision:15,scale:2}).notNull(),description:S("description"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[di("unique_role_approval").on(t.role)]),F=A("users",{id:o("id").primaryKey().notNull(),email:o("email").unique().notNull(),name:o("name").notNull(),password:o("hashed_password").notNull(),phoneNumber:o("phone_number"),profileImageUrl:o("profile_image_url"),role:he("role").notNull().default("field_worker"),position:o("position"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[g("idx_users_email").on(t.email),g("idx_users_role").on(t.role)]),Re=A("companies",{id:T("id").primaryKey(),companyName:o("company_name",{length:255}).notNull(),businessNumber:o("business_number",{length:50}),address:S("address"),contactPerson:o("contact_person",{length:100}),phone:o("phone",{length:50}),email:o("email",{length:255}),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()}),ao=A("vendors",{id:T("id").primaryKey(),name:o("name",{length:255}).notNull(),vendorCode:o("vendor_code",{length:50}),aliases:I("aliases").default([]).$type(),businessNumber:o("business_number",{length:50}),contactPerson:o("contact_person",{length:100}).notNull(),email:o("email",{length:255}).notNull(),phone:o("phone",{length:50}),address:S("address"),businessType:o("business_type",{length:100}),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[g("idx_vendors_name").on(t.name),g("idx_vendors_business_number").on(t.businessNumber),g("idx_vendors_email").on(t.email),g("idx_vendors_active").on(t.isActive)]),zl=A("items",{id:T("id").primaryKey(),name:o("name",{length:255}).notNull(),specification:S("specification"),unit:o("unit",{length:50}).notNull(),unitPrice:K("unit_price",{precision:15,scale:2}),category:o("category",{length:100}),majorCategory:o("major_category",{length:100}),middleCategory:o("middle_category",{length:100}),minorCategory:o("minor_category",{length:100}),description:S("description"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[g("idx_items_name").on(t.name),g("idx_items_category").on(t.category),g("idx_items_active").on(t.isActive)]),Ql=A("terminology",{id:T("id").primaryKey(),termKey:o("term_key",{length:100}).notNull().unique(),termValue:o("term_value",{length:255}).notNull(),category:o("category",{length:100}),description:S("description"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[g("idx_terminology_key").on(t.termKey),g("idx_terminology_category").on(t.category),g("idx_terminology_active").on(t.isActive)]),Te=A("projects",{id:T("id").primaryKey(),projectName:o("project_name",{length:255}).notNull(),projectCode:o("project_code",{length:100}).notNull().unique(),clientName:o("client_name",{length:255}),projectType:ql("project_type").notNull().default("commercial"),location:S("location"),startDate:pe("start_date"),endDate:pe("end_date"),status:Bl("status").notNull().default("active"),totalBudget:K("total_budget",{precision:15,scale:2}),projectManagerId:o("project_manager_id").references(()=>F.id),orderManagerId:o("order_manager_id").references(()=>F.id),description:S("description"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[g("idx_projects_name").on(t.projectName),g("idx_projects_code").on(t.projectCode),g("idx_projects_status").on(t.status),g("idx_projects_start_date").on(t.startDate),g("idx_projects_active").on(t.isActive),g("idx_projects_manager").on(t.projectManagerId)]),Ol=A("project_members",{id:T("id").primaryKey(),projectId:_("project_id").references(()=>Te.id,{onDelete:"cascade"}).notNull(),userId:o("user_id").references(()=>F.id,{onDelete:"cascade"}).notNull(),role:o("role",{length:50}).notNull(),assignedAt:d("assigned_at").defaultNow(),assignedBy:o("assigned_by").references(()=>F.id),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[di("project_members_project_user_unique").on(t.projectId,t.userId)]),Ul=A("project_history",{id:T("id").primaryKey(),projectId:_("project_id").references(()=>Te.id,{onDelete:"cascade"}).notNull(),fieldName:o("field_name",{length:100}).notNull(),oldValue:S("old_value"),newValue:S("new_value"),changedBy:o("changed_by").references(()=>F.id).notNull(),changedAt:d("changed_at").defaultNow(),changeReason:S("change_reason")}),fe=A("order_templates",{id:T("id").primaryKey(),templateName:o("template_name",{length:100}).notNull(),templateType:o("template_type",{length:50}).notNull(),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()}),Kl=A("template_fields",{id:T("id").primaryKey(),templateId:_("template_id").references(()=>fe.id,{onDelete:"cascade"}),fieldType:o("field_type",{length:50}).notNull(),fieldName:o("field_name",{length:100}).notNull(),label:o("label",{length:255}).notNull(),placeholder:o("placeholder",{length:255}),required:j("required").default(!1),validation:I("validation"),options:I("options"),gridPosition:I("grid_position").notNull(),sectionName:o("section_name",{length:100}).notNull(),sortOrder:_("sort_order").default(0),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()}),Rl=A("handsontable_configs",{id:T("id").primaryKey(),templateId:_("template_id").references(()=>fe.id,{onDelete:"cascade"}),colHeaders:I("col_headers").notNull(),columns:I("columns").notNull(),rowsCount:_("rows_count").default(10),formulas:I("formulas"),validationRules:I("validation_rules"),customStyles:I("custom_styles"),settings:I("settings"),sortOrder:_("sort_order").default(0),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()}),Gl=A("template_versions",{id:T("id").primaryKey(),templateId:_("template_id").references(()=>fe.id,{onDelete:"cascade"}),versionNumber:o("version_number",{length:20}).notNull(),changes:I("changes"),templateConfig:I("template_config").notNull(),createdBy:o("created_by",{length:255}),createdAt:d("created_at").defaultNow()}),k=A("purchase_orders",{id:T("id").primaryKey(),orderNumber:o("order_number",{length:50}).notNull().unique(),projectId:_("project_id").references(()=>Te.id).notNull(),vendorId:_("vendor_id").references(()=>ao.id),userId:o("user_id").references(()=>F.id).notNull(),templateId:_("template_id").references(()=>fe.id),orderDate:pe("order_date").notNull(),deliveryDate:pe("delivery_date"),status:$l("status").notNull().default("pending"),totalAmount:K("total_amount",{precision:15,scale:2}).default("0").$type(),notes:S("notes"),isApproved:j("is_approved").default(!1),approvedBy:o("approved_by").references(()=>F.id),approvedAt:d("approved_at"),currentApproverRole:he("current_approver_role"),approvalLevel:_("approval_level").default(1),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()},t=>[g("idx_purchase_orders_number").on(t.orderNumber),g("idx_purchase_orders_project").on(t.projectId),g("idx_purchase_orders_vendor").on(t.vendorId),g("idx_purchase_orders_user").on(t.userId),g("idx_purchase_orders_status").on(t.status),g("idx_purchase_orders_date").on(t.orderDate),g("idx_purchase_orders_delivery").on(t.deliveryDate),g("idx_purchase_orders_created").on(t.createdAt),g("idx_purchase_orders_approver").on(t.currentApproverRole)]),oo=A("purchase_order_items",{id:T("id").primaryKey(),orderId:_("order_id").references(()=>k.id).notNull(),itemName:o("item_name",{length:255}).notNull(),specification:S("specification"),unit:o("unit",{length:50}),quantity:K("quantity",{precision:10,scale:2}).notNull().$type(),unitPrice:K("unit_price",{precision:15,scale:2}).notNull().$type(),totalAmount:K("total_amount",{precision:15,scale:2}).notNull().$type(),majorCategory:o("major_category",{length:100}),middleCategory:o("middle_category",{length:100}),minorCategory:o("minor_category",{length:100}),notes:S("notes"),createdAt:d("created_at").defaultNow()},t=>[g("idx_poi_major_category").on(t.majorCategory),g("idx_poi_middle_category").on(t.middleCategory),g("idx_poi_minor_category").on(t.minorCategory),g("idx_poi_category_hierarchy").on(t.majorCategory,t.middleCategory,t.minorCategory)]),Xl=A("attachments",{id:T("id").primaryKey(),orderId:_("order_id").references(()=>k.id).notNull(),originalName:o("original_name",{length:255}).notNull(),storedName:o("stored_name",{length:255}).notNull(),filePath:o("file_path",{length:500}).notNull(),fileSize:_("file_size"),mimeType:o("mime_type",{length:100}),uploadedBy:o("uploaded_by",{length:50}),uploadedAt:d("uploaded_at").defaultNow()}),Jl=A("order_history",{id:T("id").primaryKey(),orderId:_("order_id").references(()=>k.id).notNull(),userId:o("user_id").references(()=>F.id).notNull(),action:o("action",{length:100}).notNull(),changes:I("changes"),createdAt:d("created_at").defaultNow()}),kl=A("email_send_history",{id:T("id").primaryKey(),orderId:_("order_id").notNull().references(()=>k.id,{onDelete:"cascade"}),sentAt:d("sent_at").defaultNow().notNull(),sentBy:o("sent_by",{length:255}).notNull().references(()=>F.id),recipientEmail:o("recipient_email",{length:255}).notNull(),recipientName:o("recipient_name",{length:255}),ccEmails:S("cc_emails"),subject:S("subject").notNull(),body:S("body").notNull(),attachments:I("attachments").$type(),status:o("status",{length:50}).notNull().default("sent"),errorMessage:S("error_message"),openedAt:d("opened_at"),clickedAt:d("clicked_at"),ipAddress:o("ip_address",{length:50}),userAgent:S("user_agent"),trackingId:o("tracking_id",{length:100}).unique(),emailProvider:o("email_provider",{length:50}).default("naver"),messageId:o("message_id",{length:255}),createdAt:d("created_at").defaultNow().notNull()},t=>[g("idx_email_history_order").on(t.orderId),g("idx_email_history_sent_by").on(t.sentBy),g("idx_email_history_recipient").on(t.recipientEmail),g("idx_email_history_tracking").on(t.trackingId),g("idx_email_history_status").on(t.status),g("idx_email_history_sent_at").on(t.sentAt)]),Ge=A("invoices",{id:T("id").primaryKey(),orderId:_("order_id").notNull().references(()=>k.id,{onDelete:"cascade"}),invoiceNumber:o("invoice_number",{length:100}).notNull().unique(),invoiceType:o("invoice_type",{length:20}).notNull(),issueDate:d("issue_date").notNull(),dueDate:d("due_date"),totalAmount:K("total_amount",{precision:15,scale:2}).notNull().$type(),vatAmount:K("vat_amount",{precision:15,scale:2}).default("0").$type(),status:Fl("status").notNull().default("pending"),filePath:o("file_path",{length:500}),uploadedBy:o("uploaded_by").notNull().references(()=>F.id),verifiedBy:o("verified_by").references(()=>F.id),verifiedAt:d("verified_at"),taxInvoiceIssued:j("tax_invoice_issued").default(!1),taxInvoiceIssuedDate:d("tax_invoice_issued_date"),taxInvoiceIssuedBy:o("tax_invoice_issued_by").references(()=>F.id),notes:S("notes"),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()}),lo=A("item_receipts",{id:T("id").primaryKey(),orderItemId:_("order_item_id").notNull().references(()=>oo.id,{onDelete:"cascade"}),invoiceId:_("invoice_id").references(()=>Ge.id,{onDelete:"set null"}),receivedQuantity:K("received_quantity",{precision:10,scale:2}).notNull().$type(),receivedDate:d("received_date").notNull(),qualityCheck:j("quality_check").default(!1),qualityNotes:S("quality_notes"),verifiedBy:o("verified_by").notNull().references(()=>F.id),status:Vl("status").notNull().default("pending"),notes:S("notes"),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()}),Hl=A("verification_logs",{id:T("id").primaryKey(),orderId:_("order_id").notNull().references(()=>k.id,{onDelete:"cascade"}),invoiceId:_("invoice_id").references(()=>Ge.id,{onDelete:"set null"}),itemReceiptId:_("item_receipt_id").references(()=>lo.id,{onDelete:"set null"}),action:Ll("action").notNull(),details:S("details"),performedBy:o("performed_by").notNull().references(()=>F.id),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow()});P(Re).omit({id:!0,createdAt:!0,updatedAt:!0});P(ao).omit({id:!0,createdAt:!0,updatedAt:!0});const Wl=P(zl).omit({id:!0,createdAt:!0,updatedAt:!0});P(Te).omit({id:!0,createdAt:!0,updatedAt:!0});P(fe).omit({id:!0,createdAt:!0,updatedAt:!0});P(Dl).omit({id:!0,createdAt:!0,updatedAt:!0});P(k).omit({id:!0,createdAt:!0,updatedAt:!0,orderNumber:!0,userId:!0,isApproved:!0,approvedBy:!0,approvedAt:!0}).extend({userId:h.string().min(1),templateId:h.number().nullable().optional(),totalAmount:h.number().positive(),customFields:h.record(h.any()).optional(),items:h.array(h.object({itemName:h.string().min(1),specification:h.string().nullable().optional(),quantity:h.number().positive(),unitPrice:h.number().positive(),totalAmount:h.number().positive(),notes:h.string().nullable().optional(),majorCategory:h.string().nullable().optional(),middleCategory:h.string().nullable().optional(),minorCategory:h.string().nullable().optional()}))});P(oo).omit({id:!0,createdAt:!0}).extend({supplyAmount:h.number().nonnegative().optional(),taxAmount:h.number().nonnegative().optional()});P(Xl).omit({id:!0,uploadedAt:!0});P(Jl).omit({id:!0,createdAt:!0});P(Ge).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({totalAmount:h.union([h.string(),h.number()]).transform(t=>String(t)),vatAmount:h.union([h.string(),h.number()]).transform(t=>String(t))});P(lo).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({receivedQuantity:h.union([h.string(),h.number()]).transform(t=>Number(t)),receivedDate:h.union([h.string(),h.date()]).transform(t=>new Date(t))});P(Hl).omit({id:!0,createdAt:!0});P(kl).omit({id:!0,sentAt:!0,createdAt:!0}).extend({ccEmails:h.string().nullable().optional(),attachments:h.array(h.object({filename:h.string(),path:h.string(),size:h.number()})).nullable().optional()});P(Kl).omit({id:!0,createdAt:!0,updatedAt:!0});P(Rl).omit({id:!0,createdAt:!0,updatedAt:!0});P(Gl).omit({id:!0,createdAt:!0});P(Ol).omit({id:!0,createdAt:!0,updatedAt:!0});P(Ul).omit({id:!0,changedAt:!0});P(io);P(Ql).omit({id:!0,createdAt:!0,updatedAt:!0});P(io).omit({id:!0,createdAt:!0,updatedAt:!0});P(El).omit({id:!0,createdAt:!0,updatedAt:!0});const Yl=A("approval_workflow_settings",{id:T("id").primaryKey(),companyId:_("company_id").references(()=>Re.id),approvalMode:o("approval_mode",{length:20}).notNull().default("staged"),directApprovalRoles:I("direct_approval_roles").default([]).$type(),stagedApprovalThresholds:I("staged_approval_thresholds").default({}).$type(),requireAllStages:j("require_all_stages").default(!0),skipLowerStages:j("skip_lower_stages").default(!1),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow().$onUpdate(()=>new Date),createdBy:o("created_by",{length:255}).references(()=>F.id)},t=>({companyIdx:g("idx_approval_workflow_company").on(t.companyId),activeIdx:g("idx_approval_workflow_active").on(t.isActive)})),co=A("approval_step_templates",{id:T("id").primaryKey(),templateName:o("template_name",{length:100}).notNull(),companyId:_("company_id").references(()=>Re.id),stepOrder:_("step_order").notNull(),requiredRole:he("required_role").notNull(),minAmount:K("min_amount",{precision:15,scale:2}).default("0"),maxAmount:K("max_amount",{precision:15,scale:2}),isOptional:j("is_optional").default(!1),canSkip:j("can_skip").default(!1),description:S("description"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow().$onUpdate(()=>new Date)},t=>({templateCompanyIdx:g("idx_approval_step_template_company").on(t.companyId),templateOrderIdx:g("idx_approval_step_order").on(t.templateName,t.stepOrder)})),Zl=A("approval_step_instances",{id:T("id").primaryKey(),orderId:_("order_id").references(()=>k.id).notNull(),templateId:_("template_id").references(()=>co.id),stepOrder:_("step_order").notNull(),requiredRole:he("required_role").notNull(),assignedUserId:o("assigned_user_id",{length:255}).references(()=>F.id),status:Ml("status").default("pending"),approvedBy:o("approved_by",{length:255}).references(()=>F.id),approvedAt:d("approved_at"),rejectionReason:S("rejection_reason"),comments:S("comments"),isActive:j("is_active").default(!0),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow().$onUpdate(()=>new Date)},t=>({orderIdx:g("idx_approval_step_instance_order").on(t.orderId),statusIdx:g("idx_approval_step_instance_status").on(t.status),assignedUserIdx:g("idx_approval_step_instance_user").on(t.assignedUserId)}));P(Yl).omit({id:!0,createdAt:!0,updatedAt:!0});P(co).omit({id:!0,createdAt:!0,updatedAt:!0});P(Zl).omit({id:!0,createdAt:!0,updatedAt:!0});const ec=G("audit_log_level",["OFF","ERROR","WARNING","INFO","DEBUG"]),tc=G("audit_event_type",["login","logout","login_failed","session_expired","password_change","permission_change","data_create","data_read","data_update","data_delete","data_export","approval_request","approval_grant","approval_reject","email_send","file_upload","file_download","settings_change","security_alert","api_access","error"]),rc=A("system_audit_logs",{id:T("id").primaryKey(),userId:o("user_id").references(()=>F.id),userName:o("user_name",{length:255}),userRole:o("user_role",{length:50}),eventType:tc("event_type").notNull(),eventCategory:o("event_category",{length:50}).notNull(),entityType:o("entity_type",{length:50}),entityId:o("entity_id",{length:100}),action:o("action",{length:255}).notNull(),details:I("details"),oldValue:I("old_value"),newValue:I("new_value"),ipAddress:o("ip_address",{length:50}),userAgent:S("user_agent"),sessionId:o("session_id",{length:255}),requestMethod:o("request_method",{length:10}),requestPath:o("request_path",{length:500}),responseStatus:_("response_status"),executionTime:_("execution_time"),errorMessage:S("error_message"),stackTrace:S("stack_trace"),createdAt:d("created_at").defaultNow().notNull()},t=>[g("idx_audit_user").on(t.userId),g("idx_audit_event_type").on(t.eventType),g("idx_audit_entity").on(t.entityType,t.entityId),g("idx_audit_created").on(t.createdAt),g("idx_audit_category").on(t.eventCategory),g("idx_audit_session").on(t.sessionId)]),nc=A("audit_settings",{id:T("id").primaryKey(),logLevel:ec("log_level").notNull().default("INFO"),enabledCategories:I("enabled_categories").notNull().default(["auth","data","security"]).$type(),retentionDays:_("retention_days").notNull().default(90),archiveEnabled:j("archive_enabled").default(!0),archiveAfterDays:_("archive_after_days").default(30),realTimeAlerts:j("real_time_alerts").default(!1),alertEmails:I("alert_emails").default([]).$type(),excludedPaths:I("excluded_paths").default([]).$type(),excludedUsers:I("excluded_users").default([]).$type(),sensitiveDataMasking:j("sensitive_data_masking").default(!0),performanceTracking:j("performance_tracking").default(!1),apiAccessLogging:j("api_access_logging").default(!1),updatedBy:o("updated_by").references(()=>F.id),updatedAt:d("updated_at").defaultNow().$onUpdate(()=>new Date),createdAt:d("created_at").defaultNow()}),sc=A("archived_audit_logs",{id:T("id").primaryKey(),originalId:_("original_id").notNull(),userId:o("user_id",{length:255}),userName:o("user_name",{length:255}),userRole:o("user_role",{length:50}),eventType:o("event_type",{length:50}).notNull(),eventCategory:o("event_category",{length:50}).notNull(),entityType:o("entity_type",{length:50}),entityId:o("entity_id",{length:100}),action:o("action",{length:255}).notNull(),details:I("details"),ipAddress:o("ip_address",{length:50}),createdAt:d("created_at").notNull(),archivedAt:d("archived_at").defaultNow().notNull()},t=>[g("idx_archived_audit_user").on(t.userId),g("idx_archived_audit_created").on(t.createdAt),g("idx_archived_audit_archived").on(t.archivedAt)]),ic=A("audit_alert_rules",{id:T("id").primaryKey(),ruleName:o("rule_name",{length:100}).notNull(),description:S("description"),eventTypes:I("event_types").notNull().$type(),condition:I("condition"),severity:o("severity",{length:20}).notNull().default("medium"),alertChannels:I("alert_channels").notNull().$type(),recipients:I("recipients").notNull().$type(),throttleMinutes:_("throttle_minutes").default(60),isActive:j("is_active").default(!0),createdBy:o("created_by").references(()=>F.id),createdAt:d("created_at").defaultNow(),updatedAt:d("updated_at").defaultNow().$onUpdate(()=>new Date)},t=>[g("idx_alert_rules_active").on(t.isActive),g("idx_alert_rules_severity").on(t.severity)]);P(rc).omit({id:!0,createdAt:!0});P(nc).omit({id:!0,createdAt:!0,updatedAt:!0});P(sc).omit({id:!0,archivedAt:!0});P(ic).omit({id:!0,createdAt:!0,updatedAt:!0});const ac=Wl.extend({standardPrice:h.string().optional().transform(t=>t&&t!==""?t:void 0)});function oc({isOpen:t,item:e,onClose:r,onSuccess:n}){const{theme:a}=ai(),c=a==="dark",p=yo({resolver:xo(ac),defaultValues:{name:e?.name||"",category:e?.category||"",specification:e?.specification||"",unit:e?.unit||"",unitPrice:e?.unitPrice||void 0,description:e?.description||"",isActive:e?.isActive??!0}}),f=()=>{n(),r()},N=qe({mutationFn:async w=>{const z={...w,unitPrice:w.unitPrice||null};return await oi("POST","/api/items",z)},onSuccess:f}),x=qe({mutationFn:async w=>{const z={...w,unitPrice:w.unitPrice||null},re=await fetch(`/api/items/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});if(!re.ok)throw new Error("Failed to update item");return re.json()},onSuccess:f}),u=w=>{e?x.mutate(w):N.mutate(w)},b=N.isPending||x.isPending,C=["원자재","부품","소모품","장비","기타"],R=["개","박스","세트","kg","g","L","mL","m","cm","mm","㎡","㎥","시간","일"];return i.jsx(Po,{open:t,onOpenChange:r,children:i.jsxs(Co,{className:`max-w-2xl max-h-[90vh] overflow-y-auto transition-colors ${c?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[i.jsx(Do,{children:i.jsx($o,{className:`transition-colors ${c?"text-white":"text-gray-900"}`,children:e?"품목 수정":"새 품목 추가"})}),i.jsx(_o,{...p,children:i.jsxs("form",{onSubmit:p.handleSubmit(u),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(H,{control:p.control,name:"name",render:({field:w})=>i.jsxs(W,{children:[i.jsx(Y,{className:`transition-colors ${c?"text-gray-300":"text-gray-700"}`,children:"품목명 *"}),i.jsx(Z,{children:i.jsx(Fe,{...w,placeholder:"품목명을 입력하세요",className:`transition-colors ${c?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),i.jsx(ae,{})]})}),i.jsx(H,{control:p.control,name:"category",render:({field:w})=>i.jsxs(W,{children:[i.jsx(Y,{className:`transition-colors ${c?"text-gray-300":"text-gray-700"}`,children:"카테고리"}),i.jsxs(Ve,{onValueChange:w.onChange,value:w.value||"",children:[i.jsx(Z,{children:i.jsx(Le,{className:`transition-colors ${c?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:i.jsx(Me,{placeholder:"카테고리를 선택하세요"})})}),i.jsx(Ee,{className:`transition-colors ${c?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:C.map(z=>i.jsx(ve,{value:z,children:z},z))})]}),i.jsx(ae,{})]})}),i.jsx(H,{control:p.control,name:"unit",render:({field:w})=>i.jsxs(W,{children:[i.jsx(Y,{className:`transition-colors ${c?"text-gray-300":"text-gray-700"}`,children:"단위 *"}),i.jsxs(Ve,{onValueChange:w.onChange,value:w.value||"",children:[i.jsx(Z,{children:i.jsx(Le,{className:`transition-colors ${c?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:i.jsx(Me,{placeholder:"단위를 선택하세요"})})}),i.jsx(Ee,{className:`transition-colors ${c?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:R.map(z=>i.jsx(ve,{value:z,children:z},z))})]}),i.jsx(ae,{})]})}),i.jsx(H,{control:p.control,name:"standardPrice",render:({field:w})=>i.jsxs(W,{children:[i.jsx(Y,{className:`transition-colors ${c?"text-gray-300":"text-gray-700"}`,children:"표준단가"}),i.jsx(Z,{children:i.jsx(Fe,{...w,type:"number",step:"0.01",placeholder:"0.00",className:`transition-colors ${c?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),i.jsx(ae,{})]})})]}),i.jsx(H,{control:p.control,name:"specification",render:({field:w})=>i.jsxs(W,{children:[i.jsx(Y,{className:`transition-colors ${c?"text-gray-300":"text-gray-700"}`,children:"규격"}),i.jsx(Z,{children:i.jsx(nt,{...w,value:w.value||"",placeholder:"품목의 상세 규격을 입력하세요",rows:3,className:`transition-colors ${c?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),i.jsx(ae,{})]})}),i.jsx(H,{control:p.control,name:"description",render:({field:w})=>i.jsxs(W,{children:[i.jsx(Y,{className:`transition-colors ${c?"text-gray-300":"text-gray-700"}`,children:"설명"}),i.jsx(Z,{children:i.jsx(nt,{...w,value:w.value||"",placeholder:"품목에 대한 추가 설명을 입력하세요",rows:3,className:`transition-colors ${c?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})}),i.jsx(ae,{})]})}),i.jsx(H,{control:p.control,name:"isActive",render:({field:w})=>i.jsxs(W,{className:`flex flex-row items-center justify-between rounded-lg border p-4 transition-colors ${c?"border-gray-600 bg-gray-700/50":"border-gray-200 bg-gray-50"}`,children:[i.jsxs("div",{className:"space-y-0.5",children:[i.jsx(Y,{className:`text-base transition-colors ${c?"text-gray-300":"text-gray-700"}`,children:"활성 상태"}),i.jsx("div",{className:`text-sm transition-colors ${c?"text-gray-400":"text-gray-600"}`,children:"품목을 활성화하여 발주에서 사용할 수 있도록 합니다"})]}),i.jsx(Z,{children:i.jsx(To,{checked:w.value||!1,onCheckedChange:w.onChange})})]})}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[i.jsx(X,{type:"button",variant:"outline",onClick:r,disabled:b,children:"취소"}),i.jsx(X,{type:"submit",disabled:b,children:b?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e?"수정 중...":"생성 중..."]}):e?"수정":"생성"})]})]})})]})})}function Ic(){const{user:t}=No(),{toast:e}=bo(),[,r]=vo(),{theme:n}=ai(),a=n==="dark",[c,p]=J.useState(""),[f,N]=J.useState("all"),[x,u]=J.useState(null),[b,C]=J.useState("asc"),[R,w]=J.useState(!1),[z,re]=J.useState(null),[Pe,Xe]=J.useState("table"),{data:ye={items:[],total:0},isLoading:Je}=Ye({queryKey:["/api/items",{category:f==="all"?void 0:f,searchText:c}],queryFn:async()=>{const m=new URLSearchParams({limit:"1000"});f!=="all"&&m.append("category",f),c&&m.append("searchText",c);const L=await fetch(`/api/items?${m.toString()}`);if(!L.ok)throw new Error("Failed to fetch items");return L.json()}}),{data:uo=[]}=Ye({queryKey:["/api/items/categories"]}),de=J.useMemo(()=>{if(!ye.items||!Array.isArray(ye.items))return[];let m=ye.items;if(f!=="all"&&(m=m.filter(L=>L.category===f)),c.trim()){const L=c.toLowerCase();m=m.filter(ie=>ie.name?.toLowerCase().includes(L)||ie.category?.toLowerCase().includes(L)||ie.specification?.toLowerCase().includes(L)||ie.unit?.toLowerCase().includes(L))}return x&&(m=[...m].sort((L,ie)=>{let Q=L[x],O=ie[x];return Q==null&&(Q=""),O==null&&(O=""),x==="unitPrice"?(Q=parseFloat(Q||"0"),O=parseFloat(O||"0")):x==="createdAt"||x==="updatedAt"?(Q=Q?new Date(Q).getTime():0,O=O?new Date(O).getTime():0):(Q=String(Q).toLowerCase(),O=String(O).toLowerCase()),b==="asc"?Q<O?-1:Q>O?1:0:O<Q?-1:O>Q?1:0})),m},[ye.items,f,c,x,b]),mo=qe({mutationFn:async m=>{await oi("DELETE",`/api/items/${m}`)},onSuccess:()=>{e({title:"성공",description:"품목이 삭제되었습니다."}),rt.invalidateQueries({queryKey:["/api/items"]})},onError:m=>{if(m.status===401){e({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{r("/login")},500);return}e({title:"오류",description:"품목 삭제에 실패했습니다.",variant:"destructive"})}}),ne=m=>{x===m?C(b==="asc"?"desc":"asc"):(u(m),C("asc"))},se=m=>x!==m?null:b==="asc"?i.jsx(Eo,{className:"h-4 w-4"}):i.jsx(zo,{className:"h-4 w-4"}),po=()=>{re(null),w(!0)},ke=m=>{re(m),w(!0)},He=m=>{confirm("정말로 이 품목을 삭제하시겠습니까?")&&mo.mutate(m)},go=()=>{w(!1),re(null),rt.invalidateQueries({queryKey:["/api/items"]})},We=m=>({강재:"default",강판:"secondary",단열재:"outline",도장재:"destructive",마감재:"default",방수재:"secondary"})[m]||"outline";return i.jsx("div",{className:`min-h-screen transition-colors ${a?"bg-gray-900":"bg-gray-50"}`,children:i.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[i.jsx(Io,{title:"품목 관리",action:t?.role==="admin"?i.jsxs(X,{onClick:po,className:"flex items-center",children:[i.jsx(wo,{className:"h-4 w-4 mr-2"}),"품목 추가"]}):void 0}),i.jsx(xe,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:i.jsx(Ze,{className:"p-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[i.jsxs("div",{className:"relative flex-1 max-w-md",children:[i.jsx(Bo,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),i.jsx(Fe,{placeholder:"품목명, 카테고리, 규격으로 검색...",value:c,onChange:m=>p(m.target.value),className:`pl-10 h-10 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})]}),i.jsx("div",{className:"w-full sm:w-48",children:i.jsxs(Ve,{value:f,onValueChange:N,children:[i.jsx(Le,{className:`h-10 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:i.jsx(Me,{placeholder:"카테고리 선택"})}),i.jsxs(Ee,{className:`transition-colors ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[i.jsx(ve,{value:"all",children:"모든 카테고리"}),uo.map(m=>i.jsx(ve,{value:m,children:m},m))]})]})})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("span",{className:`text-sm transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[de.length,"개 품목"]}),i.jsxs("div",{className:`flex items-center rounded-lg p-1 transition-colors ${a?"bg-gray-700":"bg-gray-100"}`,children:[i.jsx(X,{variant:Pe==="table"?"default":"ghost",size:"sm",onClick:()=>Xe("table"),className:"h-8 w-8 p-0",title:"목록 보기",children:i.jsx(qo,{className:"h-4 w-4"})}),i.jsx(X,{variant:Pe==="cards"?"default":"ghost",size:"sm",onClick:()=>Xe("cards"),className:"h-8 w-8 p-0",title:"카드 보기",children:i.jsx(Fo,{className:"h-4 w-4"})})]})]})]})})}),Pe==="table"?i.jsx(xe,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:i.jsx(Ze,{className:"p-0",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs(So,{children:[i.jsx(jo,{children:i.jsxs(_e,{className:`border-b transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[i.jsx(ee,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ne("name"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"품목명"}),se("name")]})}),i.jsx(ee,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ne("category"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"카테고리"}),se("category")]})}),i.jsx(ee,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ne("specification"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"규격"}),se("specification")]})}),i.jsx(ee,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ne("unit"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"단위"}),se("unit")]})}),i.jsx(ee,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ne("standardPrice"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"단가"}),se("standardPrice")]})}),i.jsx(ee,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ne("createdAt"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"등록일"}),se("createdAt")]})}),t?.role==="admin"&&i.jsx(ee,{className:`h-11 px-4 text-sm font-semibold text-right transition-colors ${a?"text-gray-400":"text-gray-700"}`,children:"관리"})]})}),i.jsx(Ao,{children:Je?[...Array(5)].map((m,L)=>i.jsxs(_e,{children:[i.jsx(M,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(M,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(M,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(M,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(M,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(M,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),t?.role==="admin"&&i.jsx(M,{})]},L)):de.length===0?i.jsx(_e,{children:i.jsx(M,{colSpan:t?.role==="admin"?7:6,className:`text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:c||f!=="all"?"검색 결과가 없습니다":"등록된 품목이 없습니다"})}):de.map(m=>i.jsxs(_e,{className:`h-12 border-b transition-colors ${a?"hover:bg-gray-700 border-gray-600":"hover:bg-gray-50 border-gray-100"}`,children:[i.jsx(M,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm font-medium cursor-pointer hover:underline overflow-hidden text-ellipsis whitespace-nowrap transition-colors ${a?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"}`,onClick:()=>r(`/items/${m.id}`),title:m.name,children:m.name})}),i.jsx(M,{className:"py-2 px-4",children:m.category?i.jsx(Ce,{variant:We(m.category),className:"text-xs",children:m.category}):"-"}),i.jsx(M,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm max-w-32 truncate transition-colors ${a?"text-gray-300":"text-gray-600"}`,title:m.specification,children:m.specification||"-"})}),i.jsx(M,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:m.unit||"-"})}),i.jsx(M,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm font-semibold transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:et(m.standardPrice)})}),i.jsx(M,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:tt(m.createdAt)})}),t?.role==="admin"&&i.jsx(M,{className:"py-2 px-4",children:i.jsxs("div",{className:"flex items-center justify-end gap-1",children:[i.jsx(X,{variant:"ghost",size:"sm",onClick:()=>ke(m),className:"h-7 w-7 p-0",title:"수정",children:i.jsx(st,{className:"h-3 w-3"})}),i.jsx(X,{variant:"ghost",size:"sm",onClick:()=>He(m.id),className:`h-7 w-7 p-0 transition-colors ${a?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,title:"삭제",children:i.jsx(it,{className:"h-3 w-3"})})]})})]},m.id))})]})})})}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:Je?[...Array(6)].map((m,L)=>i.jsx(xe,{className:`p-6 shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:`h-4 rounded mb-3 ${a?"bg-gray-600":"bg-gray-200"}`}),i.jsx("div",{className:`h-3 rounded w-3/4 mb-2 ${a?"bg-gray-600":"bg-gray-200"}`}),i.jsx("div",{className:`h-3 rounded w-1/2 ${a?"bg-gray-600":"bg-gray-200"}`})]})},L)):de.length===0?i.jsx("div",{className:`col-span-full text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:c||f!=="all"?"검색 결과가 없습니다":"등록된 품목이 없습니다"}):de.map(m=>i.jsxs(xe,{className:`p-4 hover:shadow-md transition-shadow shadow-sm ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:`font-semibold cursor-pointer truncate transition-colors ${a?"text-gray-100 hover:text-blue-400":"text-gray-900 hover:text-blue-600"}`,onClick:()=>r(`/items/${m.id}`),children:m.name}),m.category&&i.jsx(Ce,{variant:We(m.category),className:"text-xs mt-1",children:m.category})]}),m.specification&&i.jsx(Ce,{variant:"outline",className:"text-xs ml-2 flex-shrink-0 max-w-[120px] truncate",title:m.specification,children:m.specification})]}),i.jsxs("div",{className:"space-y-2 mb-3",children:[i.jsxs("div",{className:`flex items-center text-sm gap-2 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[i.jsx(Vo,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:"규격:"}),i.jsx("span",{className:"ml-1",children:m.specification||"-"})]}),i.jsxs("div",{className:`flex items-center text-sm gap-2 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[i.jsx(Lo,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:"단위:"}),i.jsx("span",{className:"ml-1",children:m.unit||"-"})]}),i.jsxs("div",{className:"flex items-center text-sm gap-2",children:[i.jsx(Mo,{className:`h-4 w-4 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),i.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"단가:"}),i.jsx("span",{className:`ml-1 font-semibold transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:et(m.standardPrice)})]})]}),i.jsx("div",{className:`flex items-center justify-between text-xs mb-3 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:i.jsxs("span",{children:["등록일: ",tt(m.createdAt)]})}),t?.role==="admin"&&i.jsxs("div",{className:`flex items-center justify-end -space-x-1 pt-2 border-t transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[i.jsx(X,{variant:"ghost",size:"sm",onClick:()=>ke(m),className:`h-8 w-8 p-0 transition-colors ${a?"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,title:"수정",children:i.jsx(st,{className:"h-3 w-3"})}),i.jsx(X,{variant:"ghost",size:"sm",onClick:()=>He(m.id),className:`h-8 w-8 p-0 transition-colors ${a?"text-red-400 hover:text-red-300 hover:bg-red-900/20":"text-red-600 hover:text-red-700 hover:bg-red-50"}`,title:"삭제",children:i.jsx(it,{className:"h-3 w-3"})})]})]},m.id))}),R&&i.jsx(oc,{isOpen:R,item:z,onClose:()=>w(!1),onSuccess:go})]})})}export{Ic as default};
