import{r as d,d as y,j as e,N as C,V as w,W as E,Z as p,O as S,o as u,_ as D,$ as U,B,b as F,i as R,J as A}from"./index-BJXK4EC8.js";import{A as h,a as j}from"./alert-D59CLjBj.js";import{u as k}from"./index-DM-MjalW.js";import"./index-DgOz0mVC.js";function I(){const[s,x]=d.useState(null),[l,m]=d.useState(!1),[a,o]=d.useState(null),{toast:i}=y(),g=d.useCallback((t,r)=>{if(r.length>0){i({title:"파일 형식 오류",description:"Excel 파일(.xlsx, .xls)만 업로드 가능합니다.",variant:"destructive"});return}t.length>0&&(x(t[0]),o(null),i({title:"파일 선택됨",description:`${t[0].name} 파일이 선택되었습니다.`}))},[i]),{getRootProps:v,getInputProps:N,isDragActive:c,isDragReject:n}=k({onDrop:g,accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.ms-excel.sheet.macroEnabled.12":[".xlsm"]},maxFiles:1,maxSize:10*1024*1024,disabled:l}),f=()=>{x(null),o(null)},b=async()=>{if(!s){i({title:"파일 선택",description:"업로드할 파일을 선택해주세요.",variant:"destructive"});return}m(!0);const t=new FormData;t.append("file",s);try{const r=await A("POST","/api/excel-smart-upload/process",t);o(r),i({title:"업로드 성공",description:`${r.itemCount||0}개의 항목이 처리되었습니다.`,variant:"success"})}catch(r){console.error("Upload error:",r),i({title:"업로드 실패",description:r.message||"파일 업로드 중 오류가 발생했습니다.",variant:"destructive"})}finally{m(!1)}};return e.jsx("div",{className:"container mx-auto py-6 max-w-4xl",children:e.jsxs(C,{children:[e.jsx(w,{children:e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-6 w-6"}),"스마트 엑셀 업로드 (간소화 버전)"]})}),e.jsxs(S,{className:"space-y-6",children:[e.jsxs("div",{...v(),className:u("border-2 border-dashed rounded-lg p-8 text-center transition-all cursor-pointer",c&&!n&&"border-blue-500 bg-blue-50",n&&"border-red-500 bg-red-50",!c&&!s&&"border-gray-300 hover:border-gray-400",s&&"border-green-500 bg-green-50",l&&"opacity-50 cursor-not-allowed"),children:[e.jsx("input",{...N()}),s?e.jsxs("div",{className:"space-y-4",children:[e.jsx(p,{className:"h-12 w-12 mx-auto text-green-500"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:s.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["(",(s.size/1024).toFixed(2)," KB)"]}),!l&&e.jsx("button",{onClick:t=>{t.stopPropagation(),f()},className:"ml-2 p-1 hover:bg-gray-100 rounded",children:e.jsx(U,{className:"h-4 w-4 text-gray-500"})})]}),!l&&e.jsx("p",{className:"text-xs text-gray-500",children:"다른 파일을 선택하려면 클릭하거나 드래그하세요"})]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:u("h-12 w-12 mx-auto mb-4",c&&!n&&"text-blue-500",n&&"text-red-500",!c&&"text-gray-400")}),e.jsx("div",{className:"mb-4",children:c&&!n?e.jsx("p",{className:"text-blue-600 font-medium",children:"파일을 여기에 놓으세요"}):n?e.jsx("p",{className:"text-red-600 font-medium",children:"Excel 파일만 업로드 가능합니다"}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"파일을 드래그하거나"}),e.jsx("p",{className:"text-blue-600 hover:text-blue-700 font-medium mt-2",children:"클릭하여 선택하세요"})]})}),e.jsx("p",{className:"text-xs text-gray-500",children:"Excel 파일 (.xlsx, .xls, .xlsm) - 최대 10MB"})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(B,{onClick:b,disabled:!s||l,className:"min-w-[200px]",children:l?"처리 중...":"업로드 및 처리"})}),a&&e.jsxs(h,{className:"mt-6",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:"✅ 업로드 완료"}),a.itemCount&&e.jsxs("div",{children:["처리된 항목: ",a.itemCount,"개"]}),a.duplicates&&e.jsxs("div",{children:["중복 발견: ",a.duplicates,"개"]}),a.validationErrors&&e.jsxs("div",{children:["검증 오류: ",a.validationErrors,"개"]})]})})]}),e.jsxs(h,{children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsx("div",{children:"• Excel 파일(.xlsx, .xls)만 지원됩니다"}),e.jsx("div",{children:"• 파일 크기는 10MB 이하여야 합니다"}),e.jsx("div",{children:"• 중복 검출 및 자동 검증이 수행됩니다"})]})})]})]})]})})}export{I as default};
