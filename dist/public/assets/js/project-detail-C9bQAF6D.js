import{v as G,x as J,u as X,m as h,r as Y,j as e,B as i,w as k,p as u,A as g,D as N,z as Z,s as y,f as A,av as j,U as ee,F as z,bx as T,P as q,aa as v,ab as f,ac as w,E as se,ad as C}from"./index-DyuWuW3j.js";import{S as te}from"./separator-DyAEMpR8.js";import{T as ae,a as re,b as F,c as x,d as le,e as d}from"./table-Dqa_HkkR.js";import{A as M}from"./arrow-left-C9wNemBf.js";import{F as ce}from"./folder-open-DfsOR53O.js";import{S as I}from"./square-pen-DnYh_glw.js";import{M as ie}from"./map-pin-Dn6Goapw.js";import{D as ne}from"./dollar-sign-ZN8G9oUz.js";import{C as xe}from"./calendar-CtLmm0_6.js";import{M as de}from"./mail-07iDKyG_.js";import{C as me}from"./chevron-up-DkMcZm1w.js";import{C as oe}from"./chevron-down-McvCdMH5.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=G("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);function De(){const{id:c}=J(),[,p]=X(),{data:t,isLoading:$}=h({queryKey:["/api/projects",c],queryFn:()=>fetch(`/api/projects/${c}`).then(s=>s.json()),enabled:!!c}),{data:B=[]}=h({queryKey:["/api/project-statuses"]}),{data:K=[]}=h({queryKey:["/api/project-types"]}),{data:L=[]}=h({queryKey:["/api/users"]}),{data:D=[]}=h({queryKey:["/api/project-members",{projectId:c}],queryFn:()=>fetch(`/api/project-members?projectId=${c}`).then(s=>s.json()),enabled:!!c}),{data:n,isLoading:O}=h({queryKey:["/api/orders",{projectId:c}],queryFn:()=>fetch(`/api/orders?projectId=${c}&limit=100`).then(s=>s.json()),enabled:!!c}),[l,E]=Y.useState({key:"",direction:null}),m=s=>{let a="asc";l.key===s&&l.direction==="asc"&&(a="desc"),E({key:s,direction:a})},o=s=>l.key!==s?e.jsx("div",{className:"w-4 h-4"}):l.direction==="asc"?e.jsx(me,{className:"w-4 h-4"}):e.jsx(oe,{className:"w-4 h-4"}),H=n?.orders?[...n.orders].sort((s,a)=>{if(!l.key||!l.direction)return 0;let r=s[l.key],b=a[l.key];return l.key==="vendor"?(r=s.vendor?.name||"",b=a.vendor?.name||""):l.key==="user"&&(r=s.user?.name||s.user?.email||"",b=a.user?.name||a.user?.email||""),r<b?l.direction==="asc"?-1:1:r>b?l.direction==="asc"?1:-1:0}):[],U=s=>{const a=B.find(r=>r.statusCode===s);return a?a.statusName:s},R=s=>{const a=K.find(r=>r.typeCode===s);return a?a.typeName:s},S=s=>{const a=L.find(r=>r.id===s);return a?a.name||a.email:s},V=()=>{if(!D||D.length===0)return"-";const s=D.filter(r=>r.role==="order_manager");return s.length===0?"-":s.map(r=>S(r.userId)).join(", ")},_=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"standby":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Q=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"sent":return"bg-green-100 text-green-800";case"completed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},W=s=>{switch(s){case"pending":return"대기중";case"approved":return"승인됨";case"sent":return"발송됨";case"completed":return"완료됨";default:return s}};return $?e.jsx("div",{className:"p-2 space-y-2",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})]})}):t?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ce,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.projectName}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.projectCode})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(i,{variant:"ghost",size:"sm",onClick:()=>p("/projects"),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"목록으로"]}),e.jsx(k,{className:_(t.status),children:U(t.status)}),e.jsxs(i,{size:"sm",onClick:()=>p(`/projects/${c}/edit`),children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"수정"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-2",children:[e.jsxs(u,{className:"shadow-sm",children:[e.jsx(g,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(Z,{className:"h-5 w-5 mr-2 text-blue-600"}),"현장 정보"]})}),e.jsxs(y,{className:"pt-0 pb-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"클라이언트"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.clientName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"현장 유형"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:R(t.projectType)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"위치"}),e.jsxs("p",{className:"text-xs text-gray-900 flex items-center mt-0.5",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),t.location||"-"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"총 예산"}),e.jsxs("p",{className:"text-xs font-semibold text-blue-600 flex items-center mt-0.5",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),t.totalBudget?A(t.totalBudget):"-"]})]})]}),t.description&&e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"my-2"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"현장 설명"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.description})]})]})]})]}),e.jsxs(u,{className:"shadow-sm",children:[e.jsx(g,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(xe,{className:"h-5 w-5 mr-2 text-blue-600"}),"일정 정보"]})}),e.jsx(y,{className:"pt-0 pb-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"시작일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.startDate?j(new Date(t.startDate)):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"종료일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.endDate?j(new Date(t.endDate)):"-"})]})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(u,{className:"shadow-sm",children:[e.jsx(g,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(ee,{className:"h-5 w-5 mr-2 text-blue-600"}),"담당자 정보"]})}),e.jsxs(y,{className:"pt-0 pb-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"현장 관리자"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.projectManagerId?S(t.projectManagerId):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"발주 담당자"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:V()})]})]})]}),e.jsxs(u,{className:"shadow-sm",children:[e.jsx(g,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(z,{className:"h-5 w-5 mr-2 text-blue-600"}),"현장 통계"]})}),e.jsxs(y,{className:"pt-0 pb-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"활성 상태"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.isActive?"활성":"비활성"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"생성일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.createdAt?j(new Date(t.createdAt)):"-"})]}),t.updatedAt&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"최종 수정일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:j(new Date(t.updatedAt))})]})]})]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs(u,{className:"shadow-sm",children:[e.jsx(g,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(P,{className:"h-5 w-5 mr-2 text-blue-600"}),"현장 발주서 목록",n&&e.jsxs(k,{variant:"secondary",className:"ml-2 text-xs",children:[n.totalCount||n.orders?.length||0,"건"]})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(T,{to:"/orders/create",children:e.jsxs(i,{size:"sm",className:"text-xs h-7",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"발주서 생성"]})})})]})}),e.jsx(y,{className:"pt-0 pb-2",children:O?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((s,a)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-8 bg-gray-200 rounded"})},a))}):n?.orders&&n.orders.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs(ae,{children:[e.jsx(re,{children:e.jsxs(F,{className:"hover:bg-transparent",children:[e.jsx(x,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("orderNumber"),children:e.jsxs("div",{className:"flex items-center",children:["발주번호",o("orderNumber")]})}),e.jsx(x,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("vendor"),children:e.jsxs("div",{className:"flex items-center",children:["거래처",o("vendor")]})}),e.jsx(x,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("orderDate"),children:e.jsxs("div",{className:"flex items-center",children:["발주일자",o("orderDate")]})}),e.jsx(x,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("deliveryDate"),children:e.jsxs("div",{className:"flex items-center",children:["납기희망일",o("deliveryDate")]})}),e.jsx(x,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("totalAmount"),children:e.jsxs("div",{className:"flex items-center",children:["총금액",o("totalAmount")]})}),e.jsx(x,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("status"),children:e.jsxs("div",{className:"flex items-center",children:["상태",o("status")]})}),e.jsx(x,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>m("user"),children:e.jsxs("div",{className:"flex items-center",children:["작성자",o("user")]})}),e.jsx(x,{className:"text-xs h-8",children:"액션"})]})}),e.jsx(le,{children:H.map(s=>e.jsxs(F,{className:"h-8",children:[e.jsx(d,{className:"font-medium text-xs py-1",children:s.orderNumber}),e.jsx(d,{className:"text-xs py-1",children:s.vendor?.name||"-"}),e.jsx(d,{className:"text-xs py-1",children:s.orderDate?j(new Date(s.orderDate)):"-"}),e.jsx(d,{className:"text-xs py-1",children:s.deliveryDate?j(new Date(s.deliveryDate)):"-"}),e.jsx(d,{className:"text-xs py-1 font-semibold text-blue-600",children:s.totalAmount?A(s.totalAmount):"-"}),e.jsx(d,{className:"text-xs py-1",children:e.jsx(k,{className:`${Q(s.status)} text-xs px-1 py-0`,children:W(s.status)})}),e.jsx(d,{className:"text-xs py-1",children:s.user?.name||s.user?.email||"-"}),e.jsx(d,{className:"text-xs py-1",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(v,{children:e.jsxs(f,{children:[e.jsx(w,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-blue-50 hover:text-blue-600",onClick:()=>p(`/orders/${s.id}`),children:e.jsx(se,{className:"h-3 w-3"})})}),e.jsx(C,{children:e.jsx("p",{children:"상세 보기"})})]})}),e.jsx(v,{children:e.jsxs(f,{children:[e.jsx(w,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-green-50 hover:text-green-600",onClick:()=>p(`/orders/${s.id}/edit`),children:e.jsx(I,{className:"h-3 w-3"})})}),e.jsx(C,{children:e.jsx("p",{children:"수정"})})]})}),e.jsx(v,{children:e.jsxs(f,{children:[e.jsx(w,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-orange-50 hover:text-orange-600",onClick:()=>{console.log("PDF 보기:",s.id)},children:e.jsx(z,{className:"h-3 w-3"})})}),e.jsx(C,{children:e.jsx("p",{children:"PDF 보기"})})]})}),e.jsx(v,{children:e.jsxs(f,{children:[e.jsx(w,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-purple-50 hover:text-purple-600",onClick:()=>{console.log("이메일 전송:",s.id)},children:e.jsx(de,{className:"h-3 w-3"})})}),e.jsx(C,{children:e.jsx("p",{children:"이메일 전송"})})]})})]})})]},s.id))})]}),n.totalCount>10&&e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx(T,{to:`/orders?projectId=${c}`,children:e.jsxs(i,{variant:"outline",size:"sm",className:"text-xs",children:["모든 발주서 보기 (",n.totalCount,"건)"]})})})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(P,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"발주서가 없습니다"}),e.jsx("p",{className:"text-gray-600 mb-2 text-xs",children:"이 프로젝트에 대한 발주서가 아직 생성되지 않았습니다."}),e.jsx(T,{to:"/orders/create",children:e.jsxs(i,{size:"sm",className:"text-xs",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"첫 발주서 생성하기"]})})]})})]})})]})}):e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"프로젝트를 찾을 수 없습니다"}),e.jsx("p",{className:"text-gray-600 mb-3 text-sm",children:"요청하신 프로젝트가 존재하지 않거나 삭제되었습니다."}),e.jsxs(i,{size:"sm",onClick:()=>p("/projects"),children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"목록으로"]})]})})}export{De as default};
