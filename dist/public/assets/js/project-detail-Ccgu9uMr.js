import{i as U,w as R,b as V,k as h,r as _,j as e,m as o,n as w,o as p,z as u,A as N,y as Q,q as g,f as D,av as j,U as W,F as G,bw as b,P as k,E as J,s as X}from"./index-BhrwCNPD.js";import{S as Y}from"./separator-BvzjYwHY.js";import{T as Z,a as ee,b as S,c as i,d as se,e as x}from"./table-CqaIJSKK.js";import{A}from"./arrow-left-C_C7So9A.js";import{F as te}from"./folder-open-CV-b0orC.js";import{S as ae}from"./square-pen-D43op1U2.js";import{M as re}from"./map-pin-CX-0G62P.js";import{D as le}from"./dollar-sign--E-vojnL.js";import{C as ce}from"./calendar-Cj_XSFBK.js";import{C as ne}from"./chevron-up-BIYCZ_Ay.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=U("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);function ge(){const{id:c}=R(),[,f]=V(),{data:t,isLoading:q}=h({queryKey:["/api/projects",c],queryFn:()=>fetch(`/api/projects/${c}`).then(s=>s.json()),enabled:!!c}),{data:z=[]}=h({queryKey:["/api/project-statuses"]}),{data:I=[]}=h({queryKey:["/api/project-types"]}),{data:F=[]}=h({queryKey:["/api/users"]}),{data:v=[]}=h({queryKey:["/api/project-members",{projectId:c}],queryFn:()=>fetch(`/api/project-members?projectId=${c}`).then(s=>s.json()),enabled:!!c}),{data:n,isLoading:M}=h({queryKey:["/api/orders",{projectId:c}],queryFn:()=>fetch(`/api/orders?projectId=${c}&limit=100`).then(s=>s.json()),enabled:!!c}),[l,K]=_.useState({key:"",direction:null}),d=s=>{let a="asc";l.key===s&&l.direction==="asc"&&(a="desc"),K({key:s,direction:a})},m=s=>l.key!==s?e.jsx("div",{className:"w-4 h-4"}):l.direction==="asc"?e.jsx(ne,{className:"w-4 h-4"}):e.jsx(X,{className:"w-4 h-4"}),L=n?.orders?[...n.orders].sort((s,a)=>{if(!l.key||!l.direction)return 0;let r=s[l.key],y=a[l.key];return l.key==="vendor"?(r=s.vendor?.name||"",y=a.vendor?.name||""):l.key==="user"&&(r=s.user?.name||s.user?.email||"",y=a.user?.name||a.user?.email||""),r<y?l.direction==="asc"?-1:1:r>y?l.direction==="asc"?1:-1:0}):[],$=s=>{const a=z.find(r=>r.statusCode===s);return a?a.statusName:s},B=s=>{const a=I.find(r=>r.typeCode===s);return a?a.typeName:s},C=s=>{const a=F.find(r=>r.id===s);return a?a.name||a.email:s},P=()=>{if(!v||v.length===0)return"-";const s=v.filter(r=>r.role==="order_manager");return s.length===0?"-":s.map(r=>C(r.userId)).join(", ")},O=s=>{switch(s){case"active":return"bg-green-100 text-green-800";case"standby":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},E=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-blue-100 text-blue-800";case"sent":return"bg-green-100 text-green-800";case"completed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},H=s=>{switch(s){case"pending":return"대기중";case"approved":return"승인됨";case"sent":return"발송됨";case"completed":return"완료됨";default:return s}};return q?e.jsx("div",{className:"p-2 space-y-2",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3 mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})]})}):t?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.projectName}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.projectCode})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>f("/projects"),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"목록으로"]}),e.jsx(w,{className:O(t.status),children:$(t.status)}),e.jsxs(o,{size:"sm",onClick:()=>f(`/projects/${c}/edit`),children:[e.jsx(ae,{className:"h-4 w-4 mr-2"}),"수정"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-2",children:[e.jsxs(p,{className:"shadow-sm",children:[e.jsx(u,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(Q,{className:"h-5 w-5 mr-2 text-blue-600"}),"현장 정보"]})}),e.jsxs(g,{className:"pt-0 pb-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"클라이언트"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.clientName||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"현장 유형"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:B(t.projectType)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"위치"}),e.jsxs("p",{className:"text-xs text-gray-900 flex items-center mt-0.5",children:[e.jsx(re,{className:"h-3 w-3 mr-1"}),t.location||"-"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"총 예산"}),e.jsxs("p",{className:"text-xs font-semibold text-blue-600 flex items-center mt-0.5",children:[e.jsx(le,{className:"h-3 w-3 mr-1"}),t.totalBudget?D(t.totalBudget):"-"]})]})]}),t.description&&e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"my-2"}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"현장 설명"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.description})]})]})]})]}),e.jsxs(p,{className:"shadow-sm",children:[e.jsx(u,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(ce,{className:"h-5 w-5 mr-2 text-blue-600"}),"일정 정보"]})}),e.jsx(g,{className:"pt-0 pb-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"시작일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.startDate?j(new Date(t.startDate)):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"종료일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.endDate?j(new Date(t.endDate)):"-"})]})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{className:"shadow-sm",children:[e.jsx(u,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(W,{className:"h-5 w-5 mr-2 text-blue-600"}),"담당자 정보"]})}),e.jsxs(g,{className:"pt-0 pb-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"현장 관리자"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.projectManagerId?C(t.projectManagerId):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"발주 담당자"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:P()})]})]})]}),e.jsxs(p,{className:"shadow-sm",children:[e.jsx(u,{className:"pb-2",children:e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(G,{className:"h-5 w-5 mr-2 text-blue-600"}),"현장 통계"]})}),e.jsxs(g,{className:"pt-0 pb-3 space-y-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"활성 상태"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.isActive?"활성":"비활성"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"생성일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:t.createdAt?j(new Date(t.createdAt)):"-"})]}),t.updatedAt&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-500",children:"최종 수정일"}),e.jsx("p",{className:"text-xs text-gray-900 mt-0.5",children:j(new Date(t.updatedAt))})]})]})]})]})]}),e.jsx("div",{className:"mt-2",children:e.jsxs(p,{className:"shadow-sm",children:[e.jsx(u,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(N,{className:"flex items-center text-lg font-semibold",children:[e.jsx(T,{className:"h-5 w-5 mr-2 text-blue-600"}),"프로젝트 발주서 목록",n&&e.jsxs(w,{variant:"secondary",className:"ml-2 text-xs",children:[n.totalCount||n.orders?.length||0,"건"]})]}),e.jsx("div",{className:"flex items-center space-x-1",children:e.jsx(b,{to:"/orders/create",children:e.jsxs(o,{size:"sm",className:"text-xs h-7",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),"발주서 생성"]})})})]})}),e.jsx(g,{className:"pt-0 pb-2",children:M?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((s,a)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-8 bg-gray-200 rounded"})},a))}):n?.orders&&n.orders.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Z,{children:[e.jsx(ee,{children:e.jsxs(S,{className:"hover:bg-transparent",children:[e.jsx(i,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>d("orderNumber"),children:e.jsxs("div",{className:"flex items-center",children:["발주번호",m("orderNumber")]})}),e.jsx(i,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>d("vendor"),children:e.jsxs("div",{className:"flex items-center",children:["거래처",m("vendor")]})}),e.jsx(i,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>d("orderDate"),children:e.jsxs("div",{className:"flex items-center",children:["발주일자",m("orderDate")]})}),e.jsx(i,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>d("deliveryDate"),children:e.jsxs("div",{className:"flex items-center",children:["납기희망일",m("deliveryDate")]})}),e.jsx(i,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>d("totalAmount"),children:e.jsxs("div",{className:"flex items-center",children:["총금액",m("totalAmount")]})}),e.jsx(i,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>d("status"),children:e.jsxs("div",{className:"flex items-center",children:["상태",m("status")]})}),e.jsx(i,{className:"text-xs h-8 cursor-pointer hover:bg-gray-50",onClick:()=>d("user"),children:e.jsxs("div",{className:"flex items-center",children:["작성자",m("user")]})}),e.jsx(i,{className:"text-xs h-8",children:"액션"})]})}),e.jsx(se,{children:L.map(s=>e.jsxs(S,{className:"h-8",children:[e.jsx(x,{className:"font-medium text-xs py-1",children:s.orderNumber}),e.jsx(x,{className:"text-xs py-1",children:s.vendor?.name||"-"}),e.jsx(x,{className:"text-xs py-1",children:s.orderDate?j(new Date(s.orderDate)):"-"}),e.jsx(x,{className:"text-xs py-1",children:s.deliveryDate?j(new Date(s.deliveryDate)):"-"}),e.jsx(x,{className:"text-xs py-1 font-semibold text-blue-600",children:s.totalAmount?D(s.totalAmount):"-"}),e.jsx(x,{className:"text-xs py-1",children:e.jsx(w,{className:`${E(s.status)} text-xs px-1 py-0`,children:H(s.status)})}),e.jsx(x,{className:"text-xs py-1",children:s.user?.name||s.user?.email||"-"}),e.jsx(x,{className:"text-xs py-1",children:e.jsx(b,{to:`/orders/${s.id}`,children:e.jsxs(o,{variant:"outline",size:"sm",className:"h-6 text-xs px-2",children:[e.jsx(J,{className:"h-3 w-3 mr-0.5"}),"보기"]})})})]},s.id))})]}),n.totalCount>10&&e.jsx("div",{className:"flex justify-center pt-2",children:e.jsx(b,{to:`/orders?projectId=${c}`,children:e.jsxs(o,{variant:"outline",size:"sm",className:"text-xs",children:["모든 발주서 보기 (",n.totalCount,"건)"]})})})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(T,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-1",children:"발주서가 없습니다"}),e.jsx("p",{className:"text-gray-600 mb-2 text-xs",children:"이 프로젝트에 대한 발주서가 아직 생성되지 않았습니다."}),e.jsx(b,{to:"/orders/create",children:e.jsxs(o,{size:"sm",className:"text-xs",children:[e.jsx(k,{className:"h-3 w-3 mr-1"}),"첫 발주서 생성하기"]})})]})})]})})]})}):e.jsx("div",{className:"p-2",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"프로젝트를 찾을 수 없습니다"}),e.jsx("p",{className:"text-gray-600 mb-3 text-sm",children:"요청하신 프로젝트가 존재하지 않거나 삭제되었습니다."}),e.jsxs(o,{size:"sm",onClick:()=>f("/projects"),children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"목록으로"]})]})})}export{ge as default};
