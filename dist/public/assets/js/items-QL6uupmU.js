var go=Object.defineProperty;var fo=(t,e,r)=>e in t?go(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var s=(t,e,r)=>fo(t,typeof e!="symbol"?e+"":e,r);import{at as g,am as ho,au as yo,o as Be,j as i,an as xo,ao as J,ap as H,aq as W,ar as k,I as qe,as as ne,B as K,n as ii,b as _o,c as No,u as bo,e as vo,r as R,m as ke,P as wo,p as he,s as Ye,w as Pe,f as Ze,av as et,t as tt}from"./index-D-7Lp4md.js";import{T as So,a as jo,b as ye,c as Y,d as Ao,e as L}from"./table-Dsr3RMlA.js";import{S as Ve,a as Fe,b as Le,c as ze,d as Ne}from"./select-vc-iSqVP.js";import{P as Io}from"./page-header-D2SATJB9.js";import{T as rt}from"./textarea-ClAI1pm9.js";import{S as To}from"./switch-BDVd9Hjc.js";import{S as Po}from"./search-DVVeKnCh.js";import{L as Co}from"./list-BJI9SGtW.js";import{G as Do}from"./grid-3x3-D5VRNI8E.js";import{S as nt}from"./square-pen-__MuDsDh.js";import{T as st}from"./trash-2-CdMGAMxm.js";import{R as $o,S as Bo}from"./scale-Cuomw6WA.js";import{D as qo}from"./dollar-sign-Bg33cCnB.js";import{C as Vo}from"./chevron-up-BFAKrKoj.js";import{C as Fo}from"./chevron-down-Dju_PAhQ.js";import"./index-BdQq_4o_.js";import"./index-D_EVk0Np.js";const o=Symbol.for("drizzle:entityKind");function $(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,o))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(o in r&&r[o]===e[o])return!0;r=Object.getPrototypeOf(r)}return!1}var dt;dt=o;class ae{constructor(e,r){s(this,"name");s(this,"keyAsName");s(this,"primary");s(this,"notNull");s(this,"default");s(this,"defaultFn");s(this,"onUpdateFn");s(this,"hasDefault");s(this,"isUnique");s(this,"uniqueName");s(this,"uniqueType");s(this,"dataType");s(this,"columnType");s(this,"enumValues");s(this,"generated");s(this,"generatedIdentity");s(this,"config");this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}s(ae,dt,"Column");var mt;mt=o;class ai{constructor(e,r,n){s(this,"config");s(this,"$default",this.$defaultFn);s(this,"$onUpdate",this.$onUpdateFn);this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}s(ai,mt,"ColumnBuilder");const se=Symbol.for("drizzle:Name");var pt;pt=o;class oi{constructor(e,r){s(this,"reference");s(this,"_onUpdate","no action");s(this,"_onDelete","no action");this.reference=()=>{const{name:n,columns:a,foreignColumns:c}=e();return{name:n,columns:a,foreignTable:c[0].table,foreignColumns:c}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new li(e,this)}}s(oi,pt,"PgForeignKeyBuilder");var gt;gt=o;class li{constructor(e,r){s(this,"reference");s(this,"onUpdate");s(this,"onDelete");this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}getName(){const{name:e,columns:r,foreignColumns:n}=this.reference(),a=r.map(h=>h.name),c=n.map(h=>h.name),p=[this.table[se],...a,n[0].table[se],...c];return e??`${p.join("_")}_fk`}}s(li,gt,"PgForeignKey");function Lo(t,...e){return t(...e)}function ci(t){return new mi(t)}function ui(t,e){return`${t[se]}_${e.join("_")}_unique`}var ft;ft=o;class di{constructor(e,r){s(this,"columns");s(this,"nullsNotDistinctConfig",!1);this.name=r,this.columns=e}nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new pi(e,this.columns,this.nullsNotDistinctConfig,this.name)}}s(di,ft,"PgUniqueConstraintBuilder");var ht;ht=o;class mi{constructor(e){s(this,"name");this.name=e}on(...e){return new di(e,this.name)}}s(mi,ht,"PgUniqueOnConstraintBuilder");var yt;yt=o;class pi{constructor(e,r,n,a){s(this,"columns");s(this,"name");s(this,"nullsNotDistinct",!1);this.table=e,this.columns=r,this.name=a??ui(this.table,this.columns.map(c=>c.name)),this.nullsNotDistinct=n}getName(){return this.name}}s(pi,yt,"PgUniqueConstraint");function it(t,e,r){for(let n=e;n<t.length;n++){const a=t[n];if(a==="\\"){n++;continue}if(a==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(a===","||a==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function gi(t,e=0){const r=[];let n=e,a=!1;for(;n<t.length;){const c=t[n];if(c===","){(a||n===e)&&r.push(""),a=!0,n++;continue}if(a=!1,c==="\\"){n+=2;continue}if(c==='"'){const[N,_]=it(t,n+1,!0);r.push(N),n=_;continue}if(c==="}")return[r,n+1];if(c==="{"){const[N,_]=gi(t,n+1);r.push(N),n=_;continue}const[p,h]=it(t,n,!1);r.push(p),n=h}return[r,n]}function zo(t){const[e]=gi(t,1);return e}function fi(t){return`{${t.map(e=>Array.isArray(e)?fi(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var xt,_t;class b extends(_t=ai,xt=o,_t){constructor(){super(...arguments);s(this,"foreignKeyConfigs",[])}array(r){return new yi(this.config.name,this,r)}references(r,n={}){return this.foreignKeyConfigs.push({ref:r,actions:n}),this}unique(r,n){return this.config.isUnique=!0,this.config.uniqueName=r,this.config.uniqueType=n?.nulls,this}generatedAlwaysAs(r){return this.config.generated={as:r,type:"always",mode:"stored"},this}buildForeignKeys(r,n){return this.foreignKeyConfigs.map(({ref:a,actions:c})=>Lo((p,h)=>{const N=new oi(()=>{const _=p();return{columns:[r],foreignColumns:[_]}});return h.onUpdate&&N.onUpdate(h.onUpdate),h.onDelete&&N.onDelete(h.onDelete),N.build(n)},a,c))}buildExtraConfigColumn(r){return new hi(r,this.config)}}s(b,xt,"PgColumnBuilder");var Nt,bt;class x extends(bt=ae,Nt=o,bt){constructor(e,r){r.uniqueName||(r.uniqueName=ui(e,[r.name])),super(e,r),this.table=e}}s(x,Nt,"PgColumn");var vt,wt;class hi extends(wt=x,vt=o,wt){constructor(){super(...arguments);s(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});s(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(r){return this.indexConfig.opClass=r,this}}s(hi,vt,"ExtraConfigColumn");var St;St=o;class xe{constructor(e,r,n,a){s(this,"name");s(this,"keyAsName");s(this,"type");s(this,"indexConfig");this.name=e,this.keyAsName=r,this.type=n,this.indexConfig=a}}s(xe,St,"IndexedColumn");var jt,At;class yi extends(At=b,jt=o,At){constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){const r=this.config.baseBuilder.build(e);return new Me(e,this.config,r)}}s(yi,jt,"PgArrayBuilder");var It,Tt;const je=class je extends(Tt=x,It=o,Tt){constructor(r,n,a,c){super(r,n);s(this,"size");this.baseColumn=a,this.range=c,this.size=n.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(r){return typeof r=="string"&&(r=zo(r)),r.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(r,n=!1){const a=r.map(c=>c===null?null:$(this.baseColumn,je)?this.baseColumn.mapToDriverValue(c,!0):this.baseColumn.mapToDriverValue(c));return n?a:fi(a)}};s(je,It,"PgArray");let Me=je;const Ee=Symbol.for("drizzle:isPgEnum");function Mo(t){return!!t&&typeof t=="function"&&Ee in t&&t[Ee]===!0}var Pt,Ct;class xi extends(Ct=b,Pt=o,Ct){constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new _i(e,this.config)}}s(xi,Pt,"PgEnumColumnBuilder");var Dt,$t;class _i extends($t=x,Dt=o,$t){constructor(r,n){super(r,n);s(this,"enum",this.config.enum);s(this,"enumValues",this.config.enum.enumValues);this.enum=n.enum}getSQLType(){return this.enum.enumName}}s(_i,Dt,"PgEnumColumn");function X(t,e){return Eo(t,e,void 0)}function Eo(t,e,r){const n=Object.assign(a=>new xi(a??"",n),{enumName:t,enumValues:e,schema:r,[Ee]:!0});return n}var Bt;Bt=o;class Ue{constructor(e,r,n,a=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:a}}}s(Ue,Bt,"Subquery");const Qo={startActiveSpan(t,e){return e()}},ie=Symbol.for("drizzle:ViewBaseConfig"),Ce=Symbol.for("drizzle:Schema"),at=Symbol.for("drizzle:Columns"),ot=Symbol.for("drizzle:ExtraConfigColumns"),De=Symbol.for("drizzle:OriginalName"),$e=Symbol.for("drizzle:BaseName"),be=Symbol.for("drizzle:IsAlias"),lt=Symbol.for("drizzle:ExtraConfigBuilder"),Ni=Symbol.for("drizzle:IsDrizzleTable");var qt,Vt,Ft,Lt,zt,Mt,Et,Qt,Ut,Ot;Ot=o,Ut=se,Qt=De,Et=Ce,Mt=at,zt=ot,Lt=$e,Ft=be,Vt=Ni,qt=lt;class z{constructor(e,r,n){s(this,Ut);s(this,Qt);s(this,Et);s(this,Mt);s(this,zt);s(this,Lt);s(this,Ft,!1);s(this,Vt,!0);s(this,qt);this[se]=this[De]=e,this[Ce]=r,this[$e]=n}}s(z,Ot,"Table"),s(z,"Symbol",{Name:se,Schema:Ce,OriginalName:De,Columns:at,ExtraConfigColumns:ot,BaseName:$e,IsAlias:be,ExtraConfigBuilder:lt});function bi(t){return typeof t=="object"&&t!==null&&Ni in t}function Uo(t){return t!=null&&typeof t.getSQL=="function"}function Oo(t){const e={sql:"",params:[]};for(const r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}var Kt;Kt=o;class Q{constructor(e){s(this,"value");this.value=Array.isArray(e)?e:[e]}getSQL(){return new C([this])}}s(Q,Kt,"StringChunk");var Rt;Rt=o;const Z=class Z{constructor(e){s(this,"decoder",vi);s(this,"shouldInlineParams",!1);this.queryChunks=e}append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return Qo.startActiveSpan("drizzle.buildSQL",r=>{const n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){const n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:a,escapeName:c,escapeParam:p,prepareTyping:h,inlineParams:N,paramStartIndex:_}=n;return Oo(e.map(l=>{if($(l,Q))return{sql:l.value.join(""),params:[]};if($(l,ve))return{sql:c(l.value),params:[]};if(l===void 0)return{sql:"",params:[]};if(Array.isArray(l)){const y=[new Q("(")];for(const[w,O]of l.entries())y.push(O),w<l.length-1&&y.push(new Q(", "));return y.push(new Q(")")),this.buildQueryFromSourceParams(y,n)}if($(l,Z))return this.buildQueryFromSourceParams(l.queryChunks,{...n,inlineParams:N||l.shouldInlineParams});if($(l,z)){const y=l[z.Symbol.Schema],w=l[z.Symbol.Name];return{sql:y===void 0||l[be]?c(w):c(y)+"."+c(w),params:[]}}if($(l,ae)){const y=a.getColumnCasing(l);if(r.invokeSource==="indexes")return{sql:c(y),params:[]};const w=l.table[z.Symbol.Schema];return{sql:l.table[be]||w===void 0?c(l.table[z.Symbol.Name])+"."+c(y):c(w)+"."+c(l.table[z.Symbol.Name])+"."+c(y),params:[]}}if($(l,ji)){const y=l[ie].schema,w=l[ie].name;return{sql:y===void 0||l[ie].isAlias?c(w):c(y)+"."+c(w),params:[]}}if($(l,Oe)){if($(l.value,Se))return{sql:p(_.value++,l),params:[l],typings:["none"]};const y=l.value===null?null:l.encoder.mapToDriverValue(l.value);if($(y,Z))return this.buildQueryFromSourceParams([y],n);if(N)return{sql:this.mapInlineParam(y,n),params:[]};let w=["none"];return h&&(w=[h(l.encoder)]),{sql:p(_.value++,y),params:[y],typings:w}}return $(l,Se)?{sql:p(_.value++,l),params:[l],typings:["none"]}:$(l,Z.Aliased)&&l.fieldAlias!==void 0?{sql:c(l.fieldAlias),params:[]}:$(l,Ue)?l._.isWith?{sql:c(l._.alias),params:[]}:this.buildQueryFromSourceParams([new Q("("),l._.sql,new Q(") "),new ve(l._.alias)],n):Mo(l)?l.schema?{sql:c(l.schema)+"."+c(l.enumName),params:[]}:{sql:c(l.enumName),params:[]}:Uo(l)?l.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([l.getSQL()],n):this.buildQueryFromSourceParams([new Q("("),l.getSQL(),new Q(")")],n):N?{sql:this.mapInlineParam(l,n),params:[]}:{sql:p(_.value++,l),params:[l],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){const n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new Z.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}};s(Z,Rt,"SQL");let C=Z;var Xt;Xt=o;class ve{constructor(e){s(this,"brand");this.value=e}getSQL(){return new C([this])}}s(ve,Xt,"Name");const vi={mapFromDriverValue:t=>t},wi={mapToDriverValue:t=>t};({...vi,...wi});var Gt;Gt=o;class Oe{constructor(e,r=wi){s(this,"brand");this.value=e,this.encoder=r}getSQL(){return new C([this])}}s(Oe,Gt,"Param");function we(t,...e){const r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new Q(t[0]));for(const[n,a]of e.entries())r.push(a,new Q(t[n+1]));return new C(r)}(t=>{function e(){return new C([])}t.empty=e;function r(N){return new C(N)}t.fromList=r;function n(N){return new C([new Q(N)])}t.raw=n;function a(N,_){const l=[];for(const[y,w]of N.entries())y>0&&_!==void 0&&l.push(_),l.push(w);return new C(l)}t.join=a;function c(N){return new ve(N)}t.identifier=c;function p(N){return new Se(N)}t.placeholder=p;function h(N,_){return new Oe(N,_)}t.param=h})(we||(we={}));(t=>{var r;r=o;const n=class n{constructor(c,p){s(this,"isSelectionField",!1);this.sql=c,this.fieldAlias=p}getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}};s(n,r,"SQL.Aliased");let e=n;t.Aliased=e})(C||(C={}));var Jt;Jt=o;class Se{constructor(e){this.name=e}getSQL(){return new C([this])}}s(Se,Jt,"Placeholder");const Si=Symbol.for("drizzle:IsDrizzleView");var Ht,Wt,kt;kt=o,Wt=ie,Ht=Si;class ji{constructor({name:e,schema:r,selectedFields:n,query:a}){s(this,Wt);s(this,Ht,!0);this[ie]={name:e,originalName:e,schema:r,selectedFields:n,query:a,isExisting:!a,isAlias:!1}}getSQL(){return new C([this])}}s(ji,kt,"View");function Ko(t){return typeof t=="object"&&t!==null&&Si in t}ae.prototype.getSQL=function(){return new C([this])};z.prototype.getSQL=function(){return new C([this])};Ue.prototype.getSQL=function(){return new C([this])};function Ro(t){return t[z.Symbol.Columns]}function Xo(t){return t[ie].selectedFields}function q(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}var Yt,Zt;class de extends(Zt=b,Yt=o,Zt){generatedAlwaysAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}s(de,Yt,"PgIntColumnBaseBuilder");var er,tr;class Ai extends(tr=de,er=o,tr){constructor(e){super(e,"number","PgBigInt53")}build(e){return new Ii(e,this.config)}}s(Ai,er,"PgBigInt53Builder");var rr,nr;class Ii extends(nr=x,rr=o,nr){getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}s(Ii,rr,"PgBigInt53");var sr,ir;class Ti extends(ir=de,sr=o,ir){constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Pi(e,this.config)}}s(Ti,sr,"PgBigInt64Builder");var ar,or;class Pi extends(or=x,ar=o,or){getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}s(Pi,ar,"PgBigInt64");function Go(t,e){const{name:r,config:n}=q(t,e);return n.mode==="number"?new Ai(r):new Ti(r)}var lr,cr;class Ci extends(cr=b,lr=o,cr){constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Di(e,this.config)}}s(Ci,lr,"PgBigSerial53Builder");var ur,dr;class Di extends(dr=x,ur=o,dr){getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}s(Di,ur,"PgBigSerial53");var mr,pr;class $i extends(pr=b,mr=o,pr){constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Bi(e,this.config)}}s($i,mr,"PgBigSerial64Builder");var gr,fr;class Bi extends(fr=x,gr=o,fr){getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}s(Bi,gr,"PgBigSerial64");function Jo(t,e){const{name:r,config:n}=q(t,e);return n.mode==="number"?new Ci(r):new $i(r)}var hr,yr;class qi extends(yr=b,hr=o,yr){constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Vi(e,this.config)}}s(qi,hr,"PgBooleanBuilder");var xr,_r;class Vi extends(_r=x,xr=o,_r){getSQLType(){return"boolean"}}s(Vi,xr,"PgBoolean");function T(t){return new qi(t??"")}var Nr,br;class Fi extends(br=b,Nr=o,br){constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Li(e,this.config)}}s(Fi,Nr,"PgCharBuilder");var vr,wr;class Li extends(wr=x,vr=o,wr){constructor(){super(...arguments);s(this,"length",this.config.length);s(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}s(Li,vr,"PgChar");function Ho(t,e={}){const{name:r,config:n}=q(t,e);return new Fi(r,n)}var Sr,jr;class zi extends(jr=b,Sr=o,jr){constructor(e){super(e,"string","PgCidr")}build(e){return new Mi(e,this.config)}}s(zi,Sr,"PgCidrBuilder");var Ar,Ir;class Mi extends(Ir=x,Ar=o,Ir){getSQLType(){return"cidr"}}s(Mi,Ar,"PgCidr");function Wo(t){return new zi(t??"")}var Tr,Pr;class Ei extends(Pr=b,Tr=o,Pr){constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new Qi(e,this.config)}}s(Ei,Tr,"PgCustomColumnBuilder");var Cr,Dr;class Qi extends(Dr=x,Cr=o,Dr){constructor(r,n){super(r,n);s(this,"sqlName");s(this,"mapTo");s(this,"mapFrom");this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(r){return typeof this.mapFrom=="function"?this.mapFrom(r):r}mapToDriverValue(r){return typeof this.mapTo=="function"?this.mapTo(r):r}}s(Qi,Cr,"PgCustomColumn");function ko(t){return(e,r)=>{const{name:n,config:a}=q(e,r);return new Ei(n,a,t)}}var $r,Br;class oe extends(Br=b,$r=o,Br){defaultNow(){return this.default(we`now()`)}}s(oe,$r,"PgDateColumnBaseBuilder");var qr,Vr;class Ui extends(Vr=oe,qr=o,Vr){constructor(e){super(e,"date","PgDate")}build(e){return new Oi(e,this.config)}}s(Ui,qr,"PgDateBuilder");var Fr,Lr;class Oi extends(Lr=x,Fr=o,Lr){getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}s(Oi,Fr,"PgDate");var zr,Mr;class Ki extends(Mr=oe,zr=o,Mr){constructor(e){super(e,"string","PgDateString")}build(e){return new Ri(e,this.config)}}s(Ki,zr,"PgDateStringBuilder");var Er,Qr;class Ri extends(Qr=x,Er=o,Qr){getSQLType(){return"date"}}s(Ri,Er,"PgDateString");function ue(t,e){const{name:r,config:n}=q(t,e);return n?.mode==="date"?new Ui(r):new Ki(r)}var Ur,Or;class Xi extends(Or=b,Ur=o,Or){constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Gi(e,this.config)}}s(Xi,Ur,"PgDoublePrecisionBuilder");var Kr,Rr;class Gi extends(Rr=x,Kr=o,Rr){getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}s(Gi,Kr,"PgDoublePrecision");function Yo(t){return new Xi(t??"")}var Xr,Gr;class Ji extends(Gr=b,Xr=o,Gr){constructor(e){super(e,"string","PgInet")}build(e){return new Hi(e,this.config)}}s(Ji,Xr,"PgInetBuilder");var Jr,Hr;class Hi extends(Hr=x,Jr=o,Hr){getSQLType(){return"inet"}}s(Hi,Jr,"PgInet");function Zo(t){return new Ji(t??"")}var Wr,kr;class Wi extends(kr=de,Wr=o,kr){constructor(e){super(e,"number","PgInteger")}build(e){return new ki(e,this.config)}}s(Wi,Wr,"PgIntegerBuilder");var Yr,Zr;class ki extends(Zr=x,Yr=o,Zr){getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}s(ki,Yr,"PgInteger");function v(t){return new Wi(t??"")}var en,tn;class Yi extends(tn=b,en=o,tn){constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new Zi(e,this.config)}}s(Yi,en,"PgIntervalBuilder");var rn,nn;class Zi extends(nn=x,rn=o,nn){constructor(){super(...arguments);s(this,"fields",this.config.intervalConfig.fields);s(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const r=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${r}${n}`}}s(Zi,rn,"PgInterval");function el(t,e={}){const{name:r,config:n}=q(t,e);return new Yi(r,n)}var sn,an;class ea extends(an=b,sn=o,an){constructor(e){super(e,"json","PgJson")}build(e){return new ta(e,this.config)}}s(ea,sn,"PgJsonBuilder");var on,ln;class ta extends(ln=x,on=o,ln){constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}s(ta,on,"PgJson");function tl(t){return new ea(t??"")}var cn,un;class ra extends(un=b,cn=o,un){constructor(e){super(e,"json","PgJsonb")}build(e){return new na(e,this.config)}}s(ra,cn,"PgJsonbBuilder");var dn,mn;class na extends(mn=x,dn=o,mn){constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}s(na,dn,"PgJsonb");function B(t){return new ra(t??"")}var pn,gn;class sa extends(gn=b,pn=o,gn){constructor(e){super(e,"array","PgLine")}build(e){return new ia(e,this.config)}}s(sa,pn,"PgLineBuilder");var fn,hn;class ia extends(hn=x,fn=o,hn){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,a]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(a)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}s(ia,fn,"PgLine");var yn,xn;class aa extends(xn=b,yn=o,xn){constructor(e){super(e,"json","PgLineABC")}build(e){return new oa(e,this.config)}}s(aa,yn,"PgLineABCBuilder");var _n,Nn;class oa extends(Nn=x,_n=o,Nn){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,a]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(a)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}s(oa,_n,"PgLineABC");function rl(t,e){const{name:r,config:n}=q(t,e);return!n?.mode||n.mode==="tuple"?new sa(r):new aa(r)}var bn,vn;class la extends(vn=b,bn=o,vn){constructor(e){super(e,"string","PgMacaddr")}build(e){return new ca(e,this.config)}}s(la,bn,"PgMacaddrBuilder");var wn,Sn;class ca extends(Sn=x,wn=o,Sn){getSQLType(){return"macaddr"}}s(ca,wn,"PgMacaddr");function nl(t){return new la(t??"")}var jn,An;class ua extends(An=b,jn=o,An){constructor(e){super(e,"string","PgMacaddr8")}build(e){return new da(e,this.config)}}s(ua,jn,"PgMacaddr8Builder");var In,Tn;class da extends(Tn=x,In=o,Tn){getSQLType(){return"macaddr8"}}s(da,In,"PgMacaddr8");function sl(t){return new ua(t??"")}var Pn,Cn;class ma extends(Cn=b,Pn=o,Cn){constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new pa(e,this.config)}}s(ma,Pn,"PgNumericBuilder");var Dn,$n;class pa extends($n=x,Dn=o,$n){constructor(r,n){super(r,n);s(this,"precision");s(this,"scale");this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}s(pa,Dn,"PgNumeric");function ga(t,e){const{name:r,config:n}=q(t,e);return new ma(r,n?.precision,n?.scale)}const U=ga;var Bn,qn;class fa extends(qn=b,Bn=o,qn){constructor(e){super(e,"array","PgPointTuple")}build(e){return new ha(e,this.config)}}s(fa,Bn,"PgPointTupleBuilder");var Vn,Fn;class ha extends(Fn=x,Vn=o,Fn){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}s(ha,Vn,"PgPointTuple");var Ln,zn;class ya extends(zn=b,Ln=o,zn){constructor(e){super(e,"json","PgPointObject")}build(e){return new xa(e,this.config)}}s(ya,Ln,"PgPointObjectBuilder");var Mn,En;class xa extends(En=x,Mn=o,En){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}s(xa,Mn,"PgPointObject");function il(t,e){const{name:r,config:n}=q(t,e);return!n?.mode||n.mode==="tuple"?new fa(r):new ya(r)}function al(t){const e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function ct(t,e){const r=new ArrayBuffer(8),n=new DataView(r);for(let a=0;a<8;a++)n.setUint8(a,t[e+a]);return n.getFloat64(0,!0)}function _a(t){const e=al(t);let r=0;const n=e[r];r+=1;const a=new DataView(e.buffer),c=a.getUint32(r,n===1);if(r+=4,c&536870912&&(a.getUint32(r,n===1),r+=4),(c&65535)===1){const p=ct(e,r);r+=8;const h=ct(e,r);return r+=8,[p,h]}throw new Error("Unsupported geometry type")}var Qn,Un;class Na extends(Un=b,Qn=o,Un){constructor(e){super(e,"array","PgGeometry")}build(e){return new ba(e,this.config)}}s(Na,Qn,"PgGeometryBuilder");var On,Kn;class ba extends(Kn=x,On=o,Kn){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return _a(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}s(ba,On,"PgGeometry");var Rn,Xn;class va extends(Xn=b,Rn=o,Xn){constructor(e){super(e,"json","PgGeometryObject")}build(e){return new wa(e,this.config)}}s(va,Rn,"PgGeometryObjectBuilder");var Gn,Jn;class wa extends(Jn=x,Gn=o,Jn){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){const r=_a(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}s(wa,Gn,"PgGeometryObject");function ol(t,e){const{name:r,config:n}=q(t,e);return!n?.mode||n.mode==="tuple"?new Na(r):new va(r)}var Hn,Wn;class Sa extends(Wn=b,Hn=o,Wn){constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new ja(e,this.config)}}s(Sa,Hn,"PgRealBuilder");var kn,Yn;class ja extends(Yn=x,kn=o,Yn){constructor(r,n){super(r,n);s(this,"mapFromDriverValue",r=>typeof r=="string"?Number.parseFloat(r):r)}getSQLType(){return"real"}}s(ja,kn,"PgReal");function ll(t){return new Sa(t??"")}var Zn,es;class Aa extends(es=b,Zn=o,es){constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Ia(e,this.config)}}s(Aa,Zn,"PgSerialBuilder");var ts,rs;class Ia extends(rs=x,ts=o,rs){getSQLType(){return"serial"}}s(Ia,ts,"PgSerial");function A(t){return new Aa(t??"")}var ns,ss;class Ta extends(ss=de,ns=o,ss){constructor(e){super(e,"number","PgSmallInt")}build(e){return new Pa(e,this.config)}}s(Ta,ns,"PgSmallIntBuilder");var is,as;class Pa extends(as=x,is=o,as){constructor(){super(...arguments);s(this,"mapFromDriverValue",r=>typeof r=="string"?Number(r):r)}getSQLType(){return"smallint"}}s(Pa,is,"PgSmallInt");function cl(t){return new Ta(t??"")}var os,ls;class Ca extends(ls=b,os=o,ls){constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Da(e,this.config)}}s(Ca,os,"PgSmallSerialBuilder");var cs,us;class Da extends(us=x,cs=o,us){getSQLType(){return"smallserial"}}s(Da,cs,"PgSmallSerial");function ul(t){return new Ca(t??"")}var ds,ms;class $a extends(ms=b,ds=o,ms){constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new Ba(e,this.config)}}s($a,ds,"PgTextBuilder");var ps,gs;class Ba extends(gs=x,ps=o,gs){constructor(){super(...arguments);s(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}s(Ba,ps,"PgText");function S(t,e={}){const{name:r,config:n}=q(t,e);return new $a(r,n)}var fs,hs;class qa extends(hs=oe,fs=o,hs){constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}build(e){return new Va(e,this.config)}}s(qa,fs,"PgTimeBuilder");var ys,xs;class Va extends(xs=x,ys=o,xs){constructor(r,n){super(r,n);s(this,"withTimezone");s(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}s(Va,ys,"PgTime");function dl(t,e={}){const{name:r,config:n}=q(t,e);return new qa(r,n.withTimezone??!1,n.precision)}var _s,Ns;class Fa extends(Ns=oe,_s=o,Ns){constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new La(e,this.config)}}s(Fa,_s,"PgTimestampBuilder");var bs,vs;class La extends(vs=x,bs=o,vs){constructor(r,n){super(r,n);s(this,"withTimezone");s(this,"precision");s(this,"mapFromDriverValue",r=>new Date(this.withTimezone?r:r+"+0000"));s(this,"mapToDriverValue",r=>r.toISOString());this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}s(La,bs,"PgTimestamp");var ws,Ss;class za extends(Ss=oe,ws=o,Ss){constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new Ma(e,this.config)}}s(za,ws,"PgTimestampStringBuilder");var js,As;class Ma extends(As=x,js=o,As){constructor(r,n){super(r,n);s(this,"withTimezone");s(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}s(Ma,js,"PgTimestampString");function m(t,e={}){const{name:r,config:n}=q(t,e);return n?.mode==="string"?new za(r,n.withTimezone??!1,n.precision):new Fa(r,n?.withTimezone??!1,n?.precision)}var Is,Ts;class Ea extends(Ts=b,Is=o,Ts){constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(we`gen_random_uuid()`)}build(e){return new Qa(e,this.config)}}s(Ea,Is,"PgUUIDBuilder");var Ps,Cs;class Qa extends(Cs=x,Ps=o,Cs){getSQLType(){return"uuid"}}s(Qa,Ps,"PgUUID");function ml(t){return new Ea(t??"")}var Ds,$s;class Ua extends($s=b,Ds=o,$s){constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new Oa(e,this.config)}}s(Ua,Ds,"PgVarcharBuilder");var Bs,qs;class Oa extends(qs=x,Bs=o,qs){constructor(){super(...arguments);s(this,"length",this.config.length);s(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}s(Oa,Bs,"PgVarchar");function u(t,e={}){const{name:r,config:n}=q(t,e);return new Ua(r,n)}var Vs,Fs;class Ka extends(Fs=b,Vs=o,Fs){constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Ra(e,this.config)}}s(Ka,Vs,"PgBinaryVectorBuilder");var Ls,zs;class Ra extends(zs=x,Ls=o,zs){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}s(Ra,Ls,"PgBinaryVector");function pl(t,e){const{name:r,config:n}=q(t,e);return new Ka(r,n)}var Ms,Es;class Xa extends(Es=b,Ms=o,Es){constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){return new Ga(e,this.config)}}s(Xa,Ms,"PgHalfVectorBuilder");var Qs,Us;class Ga extends(Us=x,Qs=o,Us){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}s(Ga,Qs,"PgHalfVector");function gl(t,e){const{name:r,config:n}=q(t,e);return new Xa(r,n)}var Os,Ks;class Ja extends(Ks=b,Os=o,Ks){constructor(e,r){super(e,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(e){return new Ha(e,this.config)}}s(Ja,Os,"PgSparseVectorBuilder");var Rs,Xs;class Ha extends(Xs=x,Rs=o,Xs){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}s(Ha,Rs,"PgSparseVector");function fl(t,e){const{name:r,config:n}=q(t,e);return new Ja(r,n)}var Gs,Js;class Wa extends(Js=b,Gs=o,Js){constructor(e,r){super(e,"array","PgVector"),this.config.dimensions=r.dimensions}build(e){return new ka(e,this.config)}}s(Wa,Gs,"PgVectorBuilder");var Hs,Ws;class ka extends(Ws=x,Hs=o,Ws){constructor(){super(...arguments);s(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}s(ka,Hs,"PgVector");function hl(t,e){const{name:r,config:n}=q(t,e);return new Wa(r,n)}function yl(){return{bigint:Go,bigserial:Jo,boolean:T,char:Ho,cidr:Wo,customType:ko,date:ue,doublePrecision:Yo,inet:Zo,integer:v,interval:el,json:tl,jsonb:B,line:rl,macaddr:nl,macaddr8:sl,numeric:ga,point:il,geometry:ol,real:ll,serial:A,smallint:cl,smallserial:ul,text:S,time:dl,timestamp:m,uuid:ml,varchar:u,bit:pl,halfvec:gl,sparsevec:fl,vector:hl}}const Qe=Symbol.for("drizzle:PgInlineForeignKeys"),ut=Symbol.for("drizzle:EnableRLS");var ks,Ys,Zs,ei,ti;class ce extends(ti=z,ei=o,Zs=Qe,Ys=ut,ks=z.Symbol.ExtraConfigBuilder,ti){constructor(){super(...arguments);s(this,Zs,[]);s(this,Ys,!1);s(this,ks)}}s(ce,ei,"PgTable"),s(ce,"Symbol",Object.assign({},z.Symbol,{InlineForeignKeys:Qe,EnableRLS:ut}));function xl(t,e,r,n,a=t){const c=new ce(t,n,a),p=typeof e=="function"?e(yl()):e,h=Object.fromEntries(Object.entries(p).map(([l,y])=>{const w=y;w.setName(l);const O=w.build(c);return c[Qe].push(...w.buildForeignKeys(O,c)),[l,O]})),N=Object.fromEntries(Object.entries(p).map(([l,y])=>{const w=y;w.setName(l);const O=w.buildExtraConfigColumn(c);return[l,O]})),_=Object.assign(c,h);return _[z.Symbol.Columns]=h,_[z.Symbol.ExtraConfigColumns]=N,r&&(_[ce.Symbol.ExtraConfigBuilder]=r),Object.assign(_,{enableRLS:()=>(_[ce.Symbol.EnableRLS]=!0,_)})}const j=(t,e,r)=>xl(t,e,r,void 0);var ri;ri=o;class Ya{constructor(e,r){this.unique=e,this.name=r}on(...e){return new _e(e.map(r=>{if($(r,C))return r;r=r;const n=new xe(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=JSON.parse(JSON.stringify(r.defaultConfig)),n}),this.unique,!1,this.name)}onOnly(...e){return new _e(e.map(r=>{if($(r,C))return r;r=r;const n=new xe(r.name,!!r.keyAsName,r.columnType,r.indexConfig);return r.indexConfig=r.defaultConfig,n}),this.unique,!0,this.name)}using(e,...r){return new _e(r.map(n=>{if($(n,C))return n;n=n;const a=new xe(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),a}),this.unique,!0,this.name,e)}}s(Ya,ri,"PgIndexBuilderOn");var ni;ni=o;class _e{constructor(e,r,n,a,c="btree"){s(this,"config");this.config={name:a,columns:e,unique:r,only:n,method:c}}concurrently(){return this.config.concurrently=!0,this}with(e){return this.config.with=e,this}where(e){return this.config.where=e,this}build(e){return new Za(this.config,e)}}s(_e,ni,"PgIndexBuilder");var si;si=o;class Za{constructor(e,r){s(this,"config");this.config={...e,table:r}}}s(Za,si,"PgIndex");function f(t){return new Ya(!1,t)}const P={INT8_MIN:-128,INT8_MAX:127,INT8_UNSIGNED_MAX:255,INT16_MIN:-32768,INT16_MAX:32767,INT16_UNSIGNED_MAX:65535,INT24_MIN:-8388608,INT24_MAX:8388607,INT24_UNSIGNED_MAX:16777215,INT32_MIN:-2147483648,INT32_MAX:2147483647,INT32_UNSIGNED_MAX:4294967295,INT48_MIN:-0x800000000000,INT48_MAX:0x7fffffffffff,INT48_UNSIGNED_MAX:0xffffffffffff,INT64_MIN:-9223372036854775808n,INT64_MAX:9223372036854775807n,INT64_UNSIGNED_MAX:18446744073709551615n};function D(t,e){return e.includes(t.columnType)}function _l(t){return"enumValues"in t&&Array.isArray(t.enumValues)&&t.enumValues.length>0}const Nl=g.union([g.string(),g.number(),g.boolean(),g.null()]),bl=g.union([Nl,g.record(g.any()),g.array(g.any())]),vl=g.custom(t=>t instanceof Buffer);function eo(t,e){const r=e?.zodInstance??g,n=e?.coerce??{};let a;return _l(t)&&(a=t.enumValues.length?r.enum(t.enumValues):r.string()),a||(D(t,["PgGeometry","PgPointTuple"])?a=r.tuple([r.number(),r.number()]):D(t,["PgGeometryObject","PgPointObject"])?a=r.object({x:r.number(),y:r.number()}):D(t,["PgHalfVector","PgVector"])?(a=r.array(r.number()),a=t.dimensions?a.length(t.dimensions):a):D(t,["PgLine"])?a=r.tuple([r.number(),r.number(),r.number()]):D(t,["PgLineABC"])?a=r.object({a:r.number(),b:r.number(),c:r.number()}):D(t,["PgArray"])?(a=r.array(eo(t.baseColumn,r)),a=t.size?a.length(t.size):a):t.dataType==="array"?a=r.array(r.any()):t.dataType==="number"?a=wl(t,r,n):t.dataType==="bigint"?a=Sl(t,r,n):t.dataType==="boolean"?a=n===!0||n.boolean?r.coerce.boolean():r.boolean():t.dataType==="date"?a=n===!0||n.date?r.coerce.date():r.date():t.dataType==="string"?a=jl(t,r,n):t.dataType==="json"?a=bl:t.dataType==="custom"?a=r.any():t.dataType==="buffer"&&(a=vl)),a||(a=r.any()),a}function wl(t,e,r){let n=t.getSQLType().includes("unsigned"),a,c,p=!1;D(t,["MySqlTinyInt","SingleStoreTinyInt"])?(a=n?0:P.INT8_MIN,c=n?P.INT8_UNSIGNED_MAX:P.INT8_MAX,p=!0):D(t,["PgSmallInt","PgSmallSerial","MySqlSmallInt","SingleStoreSmallInt"])?(a=n?0:P.INT16_MIN,c=n?P.INT16_UNSIGNED_MAX:P.INT16_MAX,p=!0):D(t,["PgReal","MySqlFloat","MySqlMediumInt","SingleStoreMediumInt","SingleStoreFloat"])?(a=n?0:P.INT24_MIN,c=n?P.INT24_UNSIGNED_MAX:P.INT24_MAX,p=D(t,["MySqlMediumInt","SingleStoreMediumInt"])):D(t,["PgInteger","PgSerial","MySqlInt","SingleStoreInt"])?(a=n?0:P.INT32_MIN,c=n?P.INT32_UNSIGNED_MAX:P.INT32_MAX,p=!0):D(t,["PgDoublePrecision","MySqlReal","MySqlDouble","SingleStoreReal","SingleStoreDouble","SQLiteReal"])?(a=n?0:P.INT48_MIN,c=n?P.INT48_UNSIGNED_MAX:P.INT48_MAX):D(t,["PgBigInt53","PgBigSerial53","MySqlBigInt53","MySqlSerial","SingleStoreBigInt53","SingleStoreSerial","SQLiteInteger"])?(n=n||D(t,["MySqlSerial","SingleStoreSerial"]),a=n?0:Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,p=!0):D(t,["MySqlYear","SingleStoreYear"])?(a=1901,c=2155,p=!0):(a=Number.MIN_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER);let h=r===!0||r?.number?e.coerce.number():e.number();return h=h.min(a).max(c),p?h.int():h}function Sl(t,e,r){const n=t.getSQLType().includes("unsigned"),a=n?0n:P.INT64_MIN,c=n?P.INT64_UNSIGNED_MAX:P.INT64_MAX;return(r===!0||r?.bigint?e.coerce.bigint():e.bigint()).min(a).max(c)}function jl(t,e,r){if(D(t,["PgUUID"]))return e.string().uuid();let n,a,c=!1;D(t,["PgVarchar","SQLiteText"])?n=t.length:D(t,["MySqlVarChar","SingleStoreVarChar"])?n=t.length??P.INT16_UNSIGNED_MAX:D(t,["MySqlText","SingleStoreText"])&&(t.textType==="longtext"?n=P.INT32_UNSIGNED_MAX:t.textType==="mediumtext"?n=P.INT24_UNSIGNED_MAX:t.textType==="text"?n=P.INT16_UNSIGNED_MAX:n=P.INT8_UNSIGNED_MAX),D(t,["PgChar","MySqlChar","SingleStoreChar"])&&(n=t.length,c=!0),D(t,["PgBinaryVector"])&&(a=/^[01]+$/,n=t.dimensions);let p=r===!0||r?.string?e.coerce.string():e.string();return p=a?p.regex(a):p,n&&c?p.length(n):n?p.max(n):p}function to(t){return bi(t)?Ro(t):Xo(t)}function ro(t,e,r,n){const a={};for(const[c,p]of Object.entries(t)){if(!$(p,ae)&&!$(p,C)&&!$(p,C.Aliased)&&typeof p=="object"){const y=bi(p)||Ko(p)?to(p):p;a[c]=ro(y,e[c]??{},r,n);continue}const h=e[c];if(h!==void 0&&typeof h!="function"){a[c]=h;continue}const N=$(p,ae)?p:void 0,_=N?eo(N,n):g.any(),l=typeof h=="function"?h(_):_;r.never(N)||(a[c]=l,N&&(r.nullable(N)&&(a[c]=a[c].nullable()),r.optional(N)&&(a[c]=a[c].optional())))}return g.object(a)}const Al={never:t=>t?.generated?.type==="always"||t?.generatedIdentity?.type==="always",optional:t=>!t.notNull||t.notNull&&t.hasDefault,nullable:t=>!t.notNull},I=(t,e)=>{const r=to(t);return ro(r,{},Al)};j("sessions",{sid:u("sid").primaryKey(),sess:B("sess").notNull(),expire:m("expire").notNull()},t=>[f("IDX_session_expire").on(t.expire)]);const no=j("ui_terms",{id:A("id").primaryKey(),termKey:u("term_key",{length:100}).notNull().unique(),termValue:u("term_value",{length:255}).notNull(),category:u("category",{length:50}).default("general"),description:S("description"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()}),Il=j("item_categories",{id:A("id").primaryKey(),categoryType:u("category_type",{length:20}).notNull(),categoryName:u("category_name",{length:100}).notNull(),parentId:v("parent_id"),displayOrder:v("display_order").default(0),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[f("idx_item_categories_type").on(t.categoryType),f("idx_item_categories_parent").on(t.parentId)]),me=X("user_role",["field_worker","project_manager","hq_management","executive","admin"]),Tl=X("purchase_order_status",["draft","pending","approved","sent","completed"]),Pl=X("project_status",["planning","active","on_hold","completed","cancelled"]),Cl=X("project_type",["commercial","residential","industrial","infrastructure"]),Dl=X("invoice_status",["pending","verified","paid"]),$l=X("item_receipt_status",["pending","approved","rejected"]),Bl=X("verification_action",["invoice_uploaded","item_verified","quality_checked"]),ql=X("approval_step_status",["pending","approved","rejected","skipped"]),Vl=j("approval_authorities",{id:A("id").primaryKey(),role:me("role").notNull(),maxAmount:U("max_amount",{precision:15,scale:2}).notNull(),description:S("description"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[ci("unique_role_approval").on(t.role)]),V=j("users",{id:u("id").primaryKey().notNull(),email:u("email").unique().notNull(),name:u("name").notNull(),password:u("hashed_password").notNull(),phoneNumber:u("phone_number"),profileImageUrl:u("profile_image_url"),role:me("role").notNull().default("field_worker"),position:u("position"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[f("idx_users_email").on(t.email),f("idx_users_role").on(t.role)]),Ke=j("companies",{id:A("id").primaryKey(),companyName:u("company_name",{length:255}).notNull(),businessNumber:u("business_number",{length:50}),address:S("address"),contactPerson:u("contact_person",{length:100}),phone:u("phone",{length:50}),email:u("email",{length:255}),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()}),so=j("vendors",{id:A("id").primaryKey(),name:u("name",{length:255}).notNull(),vendorCode:u("vendor_code",{length:50}),aliases:B("aliases").default([]).$type(),businessNumber:u("business_number",{length:50}),contactPerson:u("contact_person",{length:100}).notNull(),email:u("email",{length:255}).notNull(),phone:u("phone",{length:50}),address:S("address"),businessType:u("business_type",{length:100}),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[f("idx_vendors_name").on(t.name),f("idx_vendors_business_number").on(t.businessNumber),f("idx_vendors_email").on(t.email),f("idx_vendors_active").on(t.isActive)]),Fl=j("items",{id:A("id").primaryKey(),name:u("name",{length:255}).notNull(),specification:S("specification"),unit:u("unit",{length:50}).notNull(),unitPrice:U("unit_price",{precision:15,scale:2}),category:u("category",{length:100}),majorCategory:u("major_category",{length:100}),middleCategory:u("middle_category",{length:100}),minorCategory:u("minor_category",{length:100}),description:S("description"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[f("idx_items_name").on(t.name),f("idx_items_category").on(t.category),f("idx_items_active").on(t.isActive)]),Ll=j("terminology",{id:A("id").primaryKey(),termKey:u("term_key",{length:100}).notNull().unique(),termValue:u("term_value",{length:255}).notNull(),category:u("category",{length:100}),description:S("description"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[f("idx_terminology_key").on(t.termKey),f("idx_terminology_category").on(t.category),f("idx_terminology_active").on(t.isActive)]),Ae=j("projects",{id:A("id").primaryKey(),projectName:u("project_name",{length:255}).notNull(),projectCode:u("project_code",{length:100}).notNull().unique(),clientName:u("client_name",{length:255}),projectType:Cl("project_type").notNull().default("commercial"),location:S("location"),startDate:ue("start_date"),endDate:ue("end_date"),status:Pl("status").notNull().default("active"),totalBudget:U("total_budget",{precision:15,scale:2}),projectManagerId:u("project_manager_id").references(()=>V.id),orderManagerId:u("order_manager_id").references(()=>V.id),description:S("description"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[f("idx_projects_name").on(t.projectName),f("idx_projects_code").on(t.projectCode),f("idx_projects_status").on(t.status),f("idx_projects_start_date").on(t.startDate),f("idx_projects_active").on(t.isActive),f("idx_projects_manager").on(t.projectManagerId)]),zl=j("project_members",{id:A("id").primaryKey(),projectId:v("project_id").references(()=>Ae.id,{onDelete:"cascade"}).notNull(),userId:u("user_id").references(()=>V.id,{onDelete:"cascade"}).notNull(),role:u("role",{length:50}).notNull(),assignedAt:m("assigned_at").defaultNow(),assignedBy:u("assigned_by").references(()=>V.id),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[ci("project_members_project_user_unique").on(t.projectId,t.userId)]),Ml=j("project_history",{id:A("id").primaryKey(),projectId:v("project_id").references(()=>Ae.id,{onDelete:"cascade"}).notNull(),fieldName:u("field_name",{length:100}).notNull(),oldValue:S("old_value"),newValue:S("new_value"),changedBy:u("changed_by").references(()=>V.id).notNull(),changedAt:m("changed_at").defaultNow(),changeReason:S("change_reason")}),pe=j("order_templates",{id:A("id").primaryKey(),templateName:u("template_name",{length:100}).notNull(),templateType:u("template_type",{length:50}).notNull(),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()}),El=j("template_fields",{id:A("id").primaryKey(),templateId:v("template_id").references(()=>pe.id,{onDelete:"cascade"}),fieldType:u("field_type",{length:50}).notNull(),fieldName:u("field_name",{length:100}).notNull(),label:u("label",{length:255}).notNull(),placeholder:u("placeholder",{length:255}),required:T("required").default(!1),validation:B("validation"),options:B("options"),gridPosition:B("grid_position").notNull(),sectionName:u("section_name",{length:100}).notNull(),sortOrder:v("sort_order").default(0),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()}),Ql=j("handsontable_configs",{id:A("id").primaryKey(),templateId:v("template_id").references(()=>pe.id,{onDelete:"cascade"}),colHeaders:B("col_headers").notNull(),columns:B("columns").notNull(),rowsCount:v("rows_count").default(10),formulas:B("formulas"),validationRules:B("validation_rules"),customStyles:B("custom_styles"),settings:B("settings"),sortOrder:v("sort_order").default(0),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()}),Ul=j("template_versions",{id:A("id").primaryKey(),templateId:v("template_id").references(()=>pe.id,{onDelete:"cascade"}),versionNumber:u("version_number",{length:20}).notNull(),changes:B("changes"),templateConfig:B("template_config").notNull(),createdBy:u("created_by",{length:255}),createdAt:m("created_at").defaultNow()}),G=j("purchase_orders",{id:A("id").primaryKey(),orderNumber:u("order_number",{length:50}).notNull().unique(),projectId:v("project_id").references(()=>Ae.id).notNull(),vendorId:v("vendor_id").references(()=>so.id),userId:u("user_id").references(()=>V.id).notNull(),templateId:v("template_id").references(()=>pe.id),orderDate:ue("order_date").notNull(),deliveryDate:ue("delivery_date"),status:Tl("status").notNull().default("pending"),totalAmount:U("total_amount",{precision:15,scale:2}).default("0").$type(),notes:S("notes"),isApproved:T("is_approved").default(!1),approvedBy:u("approved_by").references(()=>V.id),approvedAt:m("approved_at"),currentApproverRole:me("current_approver_role"),approvalLevel:v("approval_level").default(1),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()},t=>[f("idx_purchase_orders_number").on(t.orderNumber),f("idx_purchase_orders_project").on(t.projectId),f("idx_purchase_orders_vendor").on(t.vendorId),f("idx_purchase_orders_user").on(t.userId),f("idx_purchase_orders_status").on(t.status),f("idx_purchase_orders_date").on(t.orderDate),f("idx_purchase_orders_delivery").on(t.deliveryDate),f("idx_purchase_orders_created").on(t.createdAt),f("idx_purchase_orders_approver").on(t.currentApproverRole)]),io=j("purchase_order_items",{id:A("id").primaryKey(),orderId:v("order_id").references(()=>G.id).notNull(),itemName:u("item_name",{length:255}).notNull(),specification:S("specification"),unit:u("unit",{length:50}),quantity:U("quantity",{precision:10,scale:2}).notNull().$type(),unitPrice:U("unit_price",{precision:15,scale:2}).notNull().$type(),totalAmount:U("total_amount",{precision:15,scale:2}).notNull().$type(),majorCategory:u("major_category",{length:100}),middleCategory:u("middle_category",{length:100}),minorCategory:u("minor_category",{length:100}),notes:S("notes"),createdAt:m("created_at").defaultNow()},t=>[f("idx_poi_major_category").on(t.majorCategory),f("idx_poi_middle_category").on(t.middleCategory),f("idx_poi_minor_category").on(t.minorCategory),f("idx_poi_category_hierarchy").on(t.majorCategory,t.middleCategory,t.minorCategory)]),Ol=j("attachments",{id:A("id").primaryKey(),orderId:v("order_id").references(()=>G.id).notNull(),originalName:u("original_name",{length:255}).notNull(),storedName:u("stored_name",{length:255}).notNull(),filePath:u("file_path",{length:500}).notNull(),fileSize:v("file_size"),mimeType:u("mime_type",{length:100}),uploadedBy:u("uploaded_by",{length:50}),uploadedAt:m("uploaded_at").defaultNow()}),Kl=j("order_history",{id:A("id").primaryKey(),orderId:v("order_id").references(()=>G.id).notNull(),userId:u("user_id").references(()=>V.id).notNull(),action:u("action",{length:100}).notNull(),changes:B("changes"),createdAt:m("created_at").defaultNow()}),Rl=j("email_send_history",{id:A("id").primaryKey(),orderId:v("order_id").notNull().references(()=>G.id,{onDelete:"cascade"}),sentAt:m("sent_at").defaultNow().notNull(),sentBy:u("sent_by",{length:255}).notNull().references(()=>V.id),recipientEmail:u("recipient_email",{length:255}).notNull(),recipientName:u("recipient_name",{length:255}),ccEmails:S("cc_emails"),subject:S("subject").notNull(),body:S("body").notNull(),attachments:B("attachments").$type(),status:u("status",{length:50}).notNull().default("sent"),errorMessage:S("error_message"),openedAt:m("opened_at"),clickedAt:m("clicked_at"),ipAddress:u("ip_address",{length:50}),userAgent:S("user_agent"),trackingId:u("tracking_id",{length:100}).unique(),emailProvider:u("email_provider",{length:50}).default("naver"),messageId:u("message_id",{length:255}),createdAt:m("created_at").defaultNow().notNull()},t=>[f("idx_email_history_order").on(t.orderId),f("idx_email_history_sent_by").on(t.sentBy),f("idx_email_history_recipient").on(t.recipientEmail),f("idx_email_history_tracking").on(t.trackingId),f("idx_email_history_status").on(t.status),f("idx_email_history_sent_at").on(t.sentAt)]),Re=j("invoices",{id:A("id").primaryKey(),orderId:v("order_id").notNull().references(()=>G.id,{onDelete:"cascade"}),invoiceNumber:u("invoice_number",{length:100}).notNull().unique(),invoiceType:u("invoice_type",{length:20}).notNull(),issueDate:m("issue_date").notNull(),dueDate:m("due_date"),totalAmount:U("total_amount",{precision:15,scale:2}).notNull().$type(),vatAmount:U("vat_amount",{precision:15,scale:2}).default("0").$type(),status:Dl("status").notNull().default("pending"),filePath:u("file_path",{length:500}),uploadedBy:u("uploaded_by").notNull().references(()=>V.id),verifiedBy:u("verified_by").references(()=>V.id),verifiedAt:m("verified_at"),taxInvoiceIssued:T("tax_invoice_issued").default(!1),taxInvoiceIssuedDate:m("tax_invoice_issued_date"),taxInvoiceIssuedBy:u("tax_invoice_issued_by").references(()=>V.id),notes:S("notes"),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()}),ao=j("item_receipts",{id:A("id").primaryKey(),orderItemId:v("order_item_id").notNull().references(()=>io.id,{onDelete:"cascade"}),invoiceId:v("invoice_id").references(()=>Re.id,{onDelete:"set null"}),receivedQuantity:U("received_quantity",{precision:10,scale:2}).notNull().$type(),receivedDate:m("received_date").notNull(),qualityCheck:T("quality_check").default(!1),qualityNotes:S("quality_notes"),verifiedBy:u("verified_by").notNull().references(()=>V.id),status:$l("status").notNull().default("pending"),notes:S("notes"),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()}),Xl=j("verification_logs",{id:A("id").primaryKey(),orderId:v("order_id").notNull().references(()=>G.id,{onDelete:"cascade"}),invoiceId:v("invoice_id").references(()=>Re.id,{onDelete:"set null"}),itemReceiptId:v("item_receipt_id").references(()=>ao.id,{onDelete:"set null"}),action:Bl("action").notNull(),details:S("details"),performedBy:u("performed_by").notNull().references(()=>V.id),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow()});I(Ke).omit({id:!0,createdAt:!0,updatedAt:!0});I(so).omit({id:!0,createdAt:!0,updatedAt:!0});const Gl=I(Fl).omit({id:!0,createdAt:!0,updatedAt:!0});I(Ae).omit({id:!0,createdAt:!0,updatedAt:!0});I(pe).omit({id:!0,createdAt:!0,updatedAt:!0});I(Il).omit({id:!0,createdAt:!0,updatedAt:!0});I(G).omit({id:!0,createdAt:!0,updatedAt:!0,orderNumber:!0,userId:!0,isApproved:!0,approvedBy:!0,approvedAt:!0}).extend({userId:g.string().min(1),templateId:g.number().nullable().optional(),totalAmount:g.number().positive(),customFields:g.record(g.any()).optional(),items:g.array(g.object({itemName:g.string().min(1),specification:g.string().nullable().optional(),quantity:g.number().positive(),unitPrice:g.number().positive(),totalAmount:g.number().positive(),notes:g.string().nullable().optional()}))});I(io).omit({id:!0,createdAt:!0}).extend({supplyAmount:g.number().nonnegative().optional(),taxAmount:g.number().nonnegative().optional()});I(Ol).omit({id:!0,uploadedAt:!0});I(Kl).omit({id:!0,createdAt:!0});I(Re).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({totalAmount:g.union([g.string(),g.number()]).transform(t=>String(t)),vatAmount:g.union([g.string(),g.number()]).transform(t=>String(t))});I(ao).omit({id:!0,createdAt:!0,updatedAt:!0}).extend({receivedQuantity:g.union([g.string(),g.number()]).transform(t=>Number(t)),receivedDate:g.union([g.string(),g.date()]).transform(t=>new Date(t))});I(Xl).omit({id:!0,createdAt:!0});I(Rl).omit({id:!0,sentAt:!0,createdAt:!0}).extend({ccEmails:g.string().nullable().optional(),attachments:g.array(g.object({filename:g.string(),path:g.string(),size:g.number()})).nullable().optional()});I(El).omit({id:!0,createdAt:!0,updatedAt:!0});I(Ql).omit({id:!0,createdAt:!0,updatedAt:!0});I(Ul).omit({id:!0,createdAt:!0});I(zl).omit({id:!0,createdAt:!0,updatedAt:!0});I(Ml).omit({id:!0,changedAt:!0});I(no);I(Ll).omit({id:!0,createdAt:!0,updatedAt:!0});I(no).omit({id:!0,createdAt:!0,updatedAt:!0});I(Vl).omit({id:!0,createdAt:!0,updatedAt:!0});const Jl=j("approval_workflow_settings",{id:A("id").primaryKey(),companyId:v("company_id").references(()=>Ke.id),approvalMode:u("approval_mode",{length:20}).notNull().default("staged"),directApprovalRoles:B("direct_approval_roles").default([]).$type(),stagedApprovalThresholds:B("staged_approval_thresholds").default({}).$type(),requireAllStages:T("require_all_stages").default(!0),skipLowerStages:T("skip_lower_stages").default(!1),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow().$onUpdate(()=>new Date),createdBy:u("created_by",{length:255}).references(()=>V.id)},t=>({companyIdx:f("idx_approval_workflow_company").on(t.companyId),activeIdx:f("idx_approval_workflow_active").on(t.isActive)})),oo=j("approval_step_templates",{id:A("id").primaryKey(),templateName:u("template_name",{length:100}).notNull(),companyId:v("company_id").references(()=>Ke.id),stepOrder:v("step_order").notNull(),requiredRole:me("required_role").notNull(),minAmount:U("min_amount",{precision:15,scale:2}).default("0"),maxAmount:U("max_amount",{precision:15,scale:2}),isOptional:T("is_optional").default(!1),canSkip:T("can_skip").default(!1),description:S("description"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow().$onUpdate(()=>new Date)},t=>({templateCompanyIdx:f("idx_approval_step_template_company").on(t.companyId),templateOrderIdx:f("idx_approval_step_order").on(t.templateName,t.stepOrder)})),Hl=j("approval_step_instances",{id:A("id").primaryKey(),orderId:v("order_id").references(()=>G.id).notNull(),templateId:v("template_id").references(()=>oo.id),stepOrder:v("step_order").notNull(),requiredRole:me("required_role").notNull(),assignedUserId:u("assigned_user_id",{length:255}).references(()=>V.id),status:ql("status").default("pending"),approvedBy:u("approved_by",{length:255}).references(()=>V.id),approvedAt:m("approved_at"),rejectionReason:S("rejection_reason"),comments:S("comments"),isActive:T("is_active").default(!0),createdAt:m("created_at").defaultNow(),updatedAt:m("updated_at").defaultNow().$onUpdate(()=>new Date)},t=>({orderIdx:f("idx_approval_step_instance_order").on(t.orderId),statusIdx:f("idx_approval_step_instance_status").on(t.status),assignedUserIdx:f("idx_approval_step_instance_user").on(t.assignedUserId)}));I(Jl).omit({id:!0,createdAt:!0,updatedAt:!0});I(oo).omit({id:!0,createdAt:!0,updatedAt:!0});I(Hl).omit({id:!0,createdAt:!0,updatedAt:!0});const Wl=Gl.extend({standardPrice:g.string().optional().transform(t=>t&&t!==""?t:void 0)});function kl({item:t,onSuccess:e,onCancel:r}){const n=ho({resolver:yo(Wl),defaultValues:{name:t?.name||"",category:t?.category||"",specification:t?.specification||"",unit:t?.unit||"",unitPrice:t?.unitPrice||void 0,description:t?.description||"",isActive:t?.isActive??!0}}),a=Be({mutationFn:async l=>{const y={...l,unitPrice:l.unitPrice||null};return await ii("POST","/api/items",y)},onSuccess:e}),c=Be({mutationFn:async l=>{const y={...l,unitPrice:l.unitPrice||null},w=await fetch(`/api/items/${t.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(!w.ok)throw new Error("Failed to update item");return w.json()},onSuccess:e}),p=l=>{t?c.mutate(l):a.mutate(l)},h=a.isPending||c.isPending,N=["원자재","부품","소모품","장비","기타"],_=["개","박스","세트","kg","g","L","mL","m","cm","mm","㎡","㎥","시간","일"];return i.jsx(xo,{...n,children:i.jsxs("form",{onSubmit:n.handleSubmit(p),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(J,{control:n.control,name:"name",render:({field:l})=>i.jsxs(H,{children:[i.jsx(W,{children:"품목명 *"}),i.jsx(k,{children:i.jsx(qe,{...l,placeholder:"품목명을 입력하세요"})}),i.jsx(ne,{})]})}),i.jsx(J,{control:n.control,name:"category",render:({field:l})=>i.jsxs(H,{children:[i.jsx(W,{children:"카테고리"}),i.jsxs(Ve,{onValueChange:l.onChange,value:l.value||"",children:[i.jsx(k,{children:i.jsx(Fe,{children:i.jsx(Le,{placeholder:"카테고리를 선택하세요"})})}),i.jsx(ze,{children:N.map(y=>i.jsx(Ne,{value:y,children:y},y))})]}),i.jsx(ne,{})]})}),i.jsx(J,{control:n.control,name:"unit",render:({field:l})=>i.jsxs(H,{children:[i.jsx(W,{children:"단위 *"}),i.jsxs(Ve,{onValueChange:l.onChange,value:l.value||"",children:[i.jsx(k,{children:i.jsx(Fe,{children:i.jsx(Le,{placeholder:"단위를 선택하세요"})})}),i.jsx(ze,{children:_.map(y=>i.jsx(Ne,{value:y,children:y},y))})]}),i.jsx(ne,{})]})}),i.jsx(J,{control:n.control,name:"standardPrice",render:({field:l})=>i.jsxs(H,{children:[i.jsx(W,{children:"표준단가"}),i.jsx(k,{children:i.jsx(qe,{...l,type:"number",step:"0.01",placeholder:"0.00"})}),i.jsx(ne,{})]})})]}),i.jsx(J,{control:n.control,name:"specification",render:({field:l})=>i.jsxs(H,{children:[i.jsx(W,{children:"규격"}),i.jsx(k,{children:i.jsx(rt,{...l,value:l.value||"",placeholder:"품목의 상세 규격을 입력하세요",rows:3})}),i.jsx(ne,{})]})}),i.jsx(J,{control:n.control,name:"description",render:({field:l})=>i.jsxs(H,{children:[i.jsx(W,{children:"설명"}),i.jsx(k,{children:i.jsx(rt,{...l,value:l.value||"",placeholder:"품목에 대한 추가 설명을 입력하세요",rows:3})}),i.jsx(ne,{})]})}),i.jsx(J,{control:n.control,name:"isActive",render:({field:l})=>i.jsxs(H,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[i.jsxs("div",{className:"space-y-0.5",children:[i.jsx(W,{className:"text-base",children:"활성 상태"}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"품목을 활성화하여 발주에서 사용할 수 있도록 합니다"})]}),i.jsx(k,{children:i.jsx(To,{checked:l.value||!1,onCheckedChange:l.onChange})})]})}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[i.jsx(K,{type:"button",variant:"outline",onClick:r,disabled:h,children:"취소"}),i.jsx(K,{type:"submit",disabled:h,children:h?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?"수정 중...":"생성 중..."]}):t?"수정":"생성"})]})]})})}function hc(){const{user:t}=_o(),{toast:e}=No(),[,r]=bo(),{theme:n}=vo(),a=n==="dark",[c,p]=R.useState(""),[h,N]=R.useState("all"),[_,l]=R.useState(null),[y,w]=R.useState("asc"),[O,ge]=R.useState(!1),[lo,Ie]=R.useState(null),[Te,Xe]=R.useState("table"),{data:fe={items:[],total:0},isLoading:Ge}=ke({queryKey:["/api/items",{category:h==="all"?void 0:h,searchText:c}],queryFn:async()=>{const d=new URLSearchParams({limit:"1000"});h!=="all"&&d.append("category",h),c&&d.append("searchText",c);const F=await fetch(`/api/items?${d.toString()}`);if(!F.ok)throw new Error("Failed to fetch items");return F.json()}}),{data:co=[]}=ke({queryKey:["/api/items/categories"]}),le=R.useMemo(()=>{if(!fe.items||!Array.isArray(fe.items))return[];let d=fe.items;if(h!=="all"&&(d=d.filter(F=>F.category===h)),c.trim()){const F=c.toLowerCase();d=d.filter(re=>re.name?.toLowerCase().includes(F)||re.category?.toLowerCase().includes(F)||re.specification?.toLowerCase().includes(F)||re.unit?.toLowerCase().includes(F))}return _&&(d=[...d].sort((F,re)=>{let M=F[_],E=re[_];return M==null&&(M=""),E==null&&(E=""),_==="unitPrice"?(M=parseFloat(M||"0"),E=parseFloat(E||"0")):_==="createdAt"||_==="updatedAt"?(M=M?new Date(M).getTime():0,E=E?new Date(E).getTime():0):(M=String(M).toLowerCase(),E=String(E).toLowerCase()),y==="asc"?M<E?-1:M>E?1:0:E<M?-1:E>M?1:0})),d},[fe.items,h,c,_,y]),uo=Be({mutationFn:async d=>{await ii("DELETE",`/api/items/${d}`)},onSuccess:()=>{e({title:"성공",description:"품목이 삭제되었습니다."}),tt.invalidateQueries({queryKey:["/api/items"]})},onError:d=>{if(d.status===401){e({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{r("/login")},500);return}e({title:"오류",description:"품목 삭제에 실패했습니다.",variant:"destructive"})}}),ee=d=>{_===d?w(y==="asc"?"desc":"asc"):(l(d),w("asc"))},te=d=>_!==d?null:y==="asc"?i.jsx(Vo,{className:"h-4 w-4"}):i.jsx(Fo,{className:"h-4 w-4"}),mo=()=>{Ie(null),ge(!0)},Je=d=>{Ie(d),ge(!0)},He=d=>{confirm("정말로 이 품목을 삭제하시겠습니까?")&&uo.mutate(d)},po=()=>{ge(!1),Ie(null),tt.invalidateQueries({queryKey:["/api/items"]})},We=d=>({강재:"default",강판:"secondary",단열재:"outline",도장재:"destructive",마감재:"default",방수재:"secondary"})[d]||"outline";return i.jsx("div",{className:`min-h-screen transition-colors ${a?"bg-gray-900":"bg-gray-50"}`,children:i.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[i.jsx(Io,{title:"품목 관리",action:t?.role==="admin"?i.jsxs(K,{onClick:mo,className:"flex items-center",children:[i.jsx(wo,{className:"h-4 w-4 mr-2"}),"품목 추가"]}):void 0}),i.jsx(he,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:i.jsx(Ye,{className:"p-4",children:i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[i.jsxs("div",{className:"relative flex-1 max-w-md",children:[i.jsx(Po,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 transition-colors ${a?"text-gray-500":"text-gray-400"}`}),i.jsx(qe,{placeholder:"품목명, 카테고리, 규격으로 검색...",value:c,onChange:d=>p(d.target.value),className:`pl-10 h-10 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100 placeholder:text-gray-400":"bg-white border-gray-300"}`})]}),i.jsx("div",{className:"w-full sm:w-48",children:i.jsxs(Ve,{value:h,onValueChange:N,children:[i.jsx(Fe,{className:`h-10 transition-colors ${a?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"}`,children:i.jsx(Le,{placeholder:"카테고리 선택"})}),i.jsxs(ze,{className:`transition-colors ${a?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[i.jsx(Ne,{value:"all",children:"모든 카테고리"}),co.map(d=>i.jsx(Ne,{value:d,children:d},d))]})]})})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("span",{className:`text-sm transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[le.length,"개 품목"]}),i.jsxs("div",{className:`flex items-center rounded-lg p-1 transition-colors ${a?"bg-gray-700":"bg-gray-100"}`,children:[i.jsx(K,{variant:Te==="table"?"default":"ghost",size:"sm",onClick:()=>Xe("table"),className:"h-8 w-8 p-0",title:"목록 보기",children:i.jsx(Co,{className:"h-4 w-4"})}),i.jsx(K,{variant:Te==="cards"?"default":"ghost",size:"sm",onClick:()=>Xe("cards"),className:"h-8 w-8 p-0",title:"카드 보기",children:i.jsx(Do,{className:"h-4 w-4"})})]})]})]})})}),Te==="table"?i.jsx(he,{className:`shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:i.jsx(Ye,{className:"p-0",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs(So,{children:[i.jsx(jo,{children:i.jsxs(ye,{className:`border-b transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[i.jsx(Y,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ee("name"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"품목명"}),te("name")]})}),i.jsx(Y,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ee("category"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"카테고리"}),te("category")]})}),i.jsx(Y,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ee("specification"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"규격"}),te("specification")]})}),i.jsx(Y,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ee("unit"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"단위"}),te("unit")]})}),i.jsx(Y,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ee("standardPrice"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"단가"}),te("standardPrice")]})}),i.jsx(Y,{className:`h-11 px-4 text-sm font-semibold cursor-pointer select-none transition-colors ${a?"text-gray-400 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,onClick:()=>ee("createdAt"),children:i.jsxs("div",{className:"flex items-center space-x-1",children:[i.jsx("span",{children:"등록일"}),te("createdAt")]})}),t?.role==="admin"&&i.jsx(Y,{className:`h-11 px-4 text-sm font-semibold text-right transition-colors ${a?"text-gray-400":"text-gray-700"}`,children:"관리"})]})}),i.jsx(Ao,{children:Ge?[...Array(5)].map((d,F)=>i.jsxs(ye,{children:[i.jsx(L,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(L,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(L,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(L,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(L,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),i.jsx(L,{children:i.jsx("div",{className:`h-4 rounded animate-pulse ${a?"bg-gray-600":"bg-gray-200"}`})}),t?.role==="admin"&&i.jsx(L,{})]},F)):le.length===0?i.jsx(ye,{children:i.jsx(L,{colSpan:t?.role==="admin"?7:6,className:`text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:c||h!=="all"?"검색 결과가 없습니다":"등록된 품목이 없습니다"})}):le.map(d=>i.jsxs(ye,{className:`h-12 border-b transition-colors ${a?"hover:bg-gray-700 border-gray-600":"hover:bg-gray-50 border-gray-100"}`,children:[i.jsx(L,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm font-medium cursor-pointer hover:underline overflow-hidden text-ellipsis whitespace-nowrap transition-colors ${a?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"}`,onClick:()=>r(`/items/${d.id}`),title:d.name,children:d.name})}),i.jsx(L,{className:"py-2 px-4",children:d.category?i.jsx(Pe,{variant:We(d.category),className:"text-xs",children:d.category}):"-"}),i.jsx(L,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm max-w-32 truncate transition-colors ${a?"text-gray-300":"text-gray-600"}`,title:d.specification,children:d.specification||"-"})}),i.jsx(L,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:d.unit||"-"})}),i.jsx(L,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm font-semibold transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:Ze(d.standardPrice)})}),i.jsx(L,{className:"py-2 px-4",children:i.jsx("div",{className:`text-sm transition-colors ${a?"text-gray-300":"text-gray-600"}`,children:et(d.createdAt)})}),t?.role==="admin"&&i.jsx(L,{className:"py-2 px-4",children:i.jsxs("div",{className:"flex items-center justify-end gap-1",children:[i.jsx(K,{variant:"ghost",size:"sm",onClick:()=>Je(d),className:"h-7 w-7 p-0",title:"수정",children:i.jsx(nt,{className:"h-3 w-3"})}),i.jsx(K,{variant:"ghost",size:"sm",onClick:()=>He(d.id),className:`h-7 w-7 p-0 transition-colors ${a?"text-red-400 hover:text-red-300":"text-red-600 hover:text-red-700"}`,title:"삭제",children:i.jsx(st,{className:"h-3 w-3"})})]})})]},d.id))})]})})})}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:Ge?[...Array(6)].map((d,F)=>i.jsx(he,{className:`p-6 shadow-sm transition-colors ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:i.jsxs("div",{className:"animate-pulse",children:[i.jsx("div",{className:`h-4 rounded mb-3 ${a?"bg-gray-600":"bg-gray-200"}`}),i.jsx("div",{className:`h-3 rounded w-3/4 mb-2 ${a?"bg-gray-600":"bg-gray-200"}`}),i.jsx("div",{className:`h-3 rounded w-1/2 ${a?"bg-gray-600":"bg-gray-200"}`})]})},F)):le.length===0?i.jsx("div",{className:`col-span-full text-center py-8 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:c||h!=="all"?"검색 결과가 없습니다":"등록된 품목이 없습니다"}):le.map(d=>i.jsxs(he,{className:`p-4 hover:shadow-md transition-shadow shadow-sm ${a?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:`font-semibold cursor-pointer truncate transition-colors ${a?"text-gray-100 hover:text-blue-400":"text-gray-900 hover:text-blue-600"}`,onClick:()=>r(`/items/${d.id}`),children:d.name}),d.category&&i.jsx(Pe,{variant:We(d.category),className:"text-xs mt-1",children:d.category})]}),d.specification&&i.jsx(Pe,{variant:"outline",className:"text-xs ml-2 flex-shrink-0 max-w-[120px] truncate",title:d.specification,children:d.specification})]}),i.jsxs("div",{className:"space-y-2 mb-3",children:[i.jsxs("div",{className:`flex items-center text-sm gap-2 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[i.jsx($o,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:"규격:"}),i.jsx("span",{className:"ml-1",children:d.specification||"-"})]}),i.jsxs("div",{className:`flex items-center text-sm gap-2 transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:[i.jsx(Bo,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:"단위:"}),i.jsx("span",{className:"ml-1",children:d.unit||"-"})]}),i.jsxs("div",{className:"flex items-center text-sm gap-2",children:[i.jsx(qo,{className:`h-4 w-4 transition-colors ${a?"text-gray-400":"text-gray-600"}`}),i.jsx("span",{className:`font-medium transition-colors ${a?"text-gray-400":"text-gray-600"}`,children:"단가:"}),i.jsx("span",{className:`ml-1 font-semibold transition-colors ${a?"text-blue-400":"text-blue-600"}`,children:Ze(d.standardPrice)})]})]}),i.jsx("div",{className:`flex items-center justify-between text-xs mb-3 transition-colors ${a?"text-gray-400":"text-gray-500"}`,children:i.jsxs("span",{children:["등록일: ",et(d.createdAt)]})}),t?.role==="admin"&&i.jsxs("div",{className:`flex items-center justify-end -space-x-1 pt-2 border-t transition-colors ${a?"border-gray-600":"border-gray-200"}`,children:[i.jsx(K,{variant:"ghost",size:"sm",onClick:()=>Je(d),className:`h-8 w-8 p-0 transition-colors ${a?"text-blue-400 hover:text-blue-300 hover:bg-blue-900/20":"text-blue-600 hover:text-blue-700 hover:bg-blue-50"}`,title:"수정",children:i.jsx(nt,{className:"h-3 w-3"})}),i.jsx(K,{variant:"ghost",size:"sm",onClick:()=>He(d.id),className:`h-8 w-8 p-0 transition-colors ${a?"text-red-400 hover:text-red-300 hover:bg-red-900/20":"text-red-600 hover:text-red-700 hover:bg-red-50"}`,title:"삭제",children:i.jsx(st,{className:"h-3 w-3"})})]})]},d.id))}),O&&i.jsx(kl,{isOpen:O,item:lo,onClose:()=>ge(!1),onSuccess:po})]})})}export{hc as default};
