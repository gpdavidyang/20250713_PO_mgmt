# 발주서 관리 시스템 - 업무 프로세스 상세 가이드

## 목차
1. [개요](#개요)
2. [주요 업무 프로세스](#주요-업무-프로세스)
3. [화면별 기능 상세](#화면별-기능-상세)
4. [권한별 접근 가능 기능](#권한별-접근-가능-기능)

---

## 개요

발주서 관리 시스템은 발주서 생성부터 청구서 처리, 자재 수령 확인까지 전체 구매 프로세스를 관리합니다. 각 단계별로 명확한 화면과 기능이 제공되며, 사용자 권한에 따라 접근 가능한 기능이 구분됩니다.

## 주요 업무 프로세스

### 전체 업무 흐름도
```
발주서 작성 → 승인 요청 → 승인 → 발송 → 자재 수령 → 청구서 처리 → 완료
```

### 1. 발주서 작성 단계

#### 1.1 수동 작성
- **화면**: `/create-order`
- **주요 기능**:
  - 프로젝트 선택
  - 거래처 선택/신규 등록
  - 품목 추가 (품명, 규격, 수량, 단가)
  - 첨부파일 업로드
  - 임시 저장 (draft 상태)
  - 승인 요청

#### 1.2 엑셀 업로드
- **화면**: `/create-order-excel`
- **주요 기능**:
  - 엑셀 파일 드래그 앤 드롭 업로드
  - 자동 데이터 파싱
  - 거래처 자동 매칭/검증
  - 일괄 발주서 생성

### 2. 발주서 관리 단계

#### 2.1 발주서 목록
- **화면**: `/orders`
- **주요 기능**:
  - **필터링 옵션**:
    - 상태별 (초안/대기/승인/발송/완료)
    - 프로젝트별
    - 거래처별
    - 날짜 범위
    - 금액 범위
  - **목록 표시 정보**:
    - 발주번호 (축약형)
    - 현장명
    - 거래처
    - 주요 품목
    - 발주일자
    - 총 금액
    - 상태
    - 작성자
  - **빠른 작업 버튼**:
    - 상세보기 (눈 아이콘)
    - 수정 (연필 아이콘)
    - 이메일 발송 (메일 아이콘)
    - 삭제 (휴지통 아이콘)

#### 2.2 발주서 상세
- **화면**: `/order/:id`
- **주요 기능**:
  - **기본 정보 표시**:
    - 발주서 번호
    - 프로젝트 정보
    - 거래처 정보
    - 작성자/작성일
    - 현재 상태
  - **품목 상세 테이블**:
    - 품명, 규격, 단위
    - 수량, 단가, 금액
    - 합계 금액 자동 계산
  - **작업 버튼** (상태별):
    - 수정 (draft/pending 상태)
    - 승인 (관리자, pending 상태)
    - 발송 (approved 상태)
    - 미리보기
    - PDF 다운로드
    - 엑셀 다운로드
    - 인쇄
  - **하위 관리 섹션**:
    - 청구서 관리 탭
    - 자재수령 확인 탭
    - 상태 변경 이력

### 3. 발주서 처리 기능

#### 3.1 수정
- **화면**: `/order/:id/edit`
- **접근 조건**: draft 또는 pending 상태
- **수정 가능 항목**:
  - 거래처 정보
  - 품목 추가/삭제/수정
  - 첨부파일 관리
  - 메모/특기사항

#### 3.2 미리보기
- **화면**: 모달 팝업
- **기능**:
  - 실제 발송될 발주서 형식 확인
  - 워터마크 표시
  - 인쇄 미리보기

#### 3.3 이메일 발송
- **화면**: 이메일 발송 다이얼로그
- **기능**:
  - 수신자 이메일 확인/수정
  - 제목/본문 템플릿
  - 첨부파일 선택 (PDF/Excel)
  - 발송 이력 기록

#### 3.4 PDF 생성
- **기능**:
  - 발주서 PDF 변환
  - 워터마크 자동 추가
  - 암호화 옵션 (거래처 사업자번호)
  - 다운로드/이메일 첨부

#### 3.5 엑셀 다운로드
- **기능**:
  - 원본 서식 유지
  - Input 시트 제거 (보안)
  - 갑지/을지 포함

### 4. 후속 관리 프로세스

#### 4.1 청구서 관리
- **화면**: 발주서 상세 내 청구서 탭
- **주요 기능**:
  - **청구서 업로드**:
    - 파일 선택/드래그 앤 드롭
    - 청구 금액 입력
    - 청구일자 기록
  - **청구서 목록**:
    - 업로드 날짜
    - 청구 금액
    - 처리 상태
    - 담당자
  - **청구서 검증**:
    - 발주 금액 대비 청구 금액 비교
    - 승인/반려 처리
    - 검증 이력 기록

#### 4.2 자재수령 확인
- **화면**: 발주서 상세 내 자재수령 탭
- **주요 기능**:
  - **수령 등록**:
    - 품목별 수령 수량 입력
    - 수령 일자 기록
    - 수령 담당자 정보
    - 품질 상태 체크
  - **부분 수령 관리**:
    - 분할 수령 지원
    - 잔량 자동 계산
    - 수령 이력 추적
  - **검수 처리**:
    - 품질 확인 체크리스트
    - 불량품 처리 기록
    - 최종 승인

### 5. 대시보드 및 통계

#### 5.1 메인 대시보드
- **화면**: `/dashboard`
- **표시 정보**:
  - 상태별 발주 현황 (차트)
  - 이번 달 발주 금액
  - 승인 대기 건수
  - 최근 발주 목록
  - 거래처별 발주 현황

#### 5.2 프로젝트별 현황
- **화면**: `/projects`
- **기능**:
  - 프로젝트별 발주 통계
  - 예산 대비 실행률
  - 주요 거래처 현황

## 화면별 기능 상세

### 발주서 목록 화면 (`/orders`)

```
┌─────────────────────────────────────────────────────────────┐
│  [필터] [검색창]                    [엑셀다운로드] [새발주서] │
├─────────────────────────────────────────────────────────────┤
│  발주번호 │ 현장 │ 거래처 │ 품목 │ 일자 │ 금액 │ 상태 │ 작업│
├─────────────────────────────────────────────────────────────┤
│  PO-0612-001 │ A현장 │ B업체 │ 자재 │ 24.01 │ 1.2M │ 승인 │ 👁 ✏ 📧│
└─────────────────────────────────────────────────────────────┘
```

### 발주서 상세 화면 (`/order/:id`)

```
┌─────────────────────────────────────────────────────────────┐
│  [← 목록으로]                   [수정] [미리보기] [PDF] [인쇄] │
├─────────────────────────────────────────────────────────────┤
│  발주서 번호: PO-2025-0612-001         상태: [승인됨]        │
│  프로젝트: A현장                       작성일: 2025.01.15     │
│  거래처: B업체                         작성자: 홍길동        │
├─────────────────────────────────────────────────────────────┤
│  [기본정보] [품목상세] [청구서관리] [자재수령] [변경이력]     │
├─────────────────────────────────────────────────────────────┤
│  (선택된 탭의 내용 표시)                                     │
└─────────────────────────────────────────────────────────────┘
```

## 권한별 접근 가능 기능

### 1. 현장 실무자 (field_worker)
- 발주서 작성 (수동/엑셀)
- 본인 작성 발주서 조회
- 발주서 수정 (draft 상태만)
- 자재수령 확인 등록

### 2. 프로젝트 매니저 (project_manager)
- 현장 실무자 권한 + 
- 프로젝트 내 모든 발주서 조회
- 1,000만원 이하 발주서 승인
- 청구서 업로드 및 검증

### 3. 본사 관리자 (hq_management)
- 프로젝트 매니저 권한 +
- 전체 발주서 조회
- 5,000만원 이하 발주서 승인
- 통계 및 리포트 접근

### 4. 임원 (executive)
- 본사 관리자 권한 +
- 1억원 이하 발주서 승인
- 전체 대시보드 접근

### 5. 관리자 (admin)
- 모든 권한
- 금액 제한 없는 승인
- 시스템 설정 관리
- 사용자 관리

## 주요 특징

### 1. 상태 기반 기능 제어
- 각 상태별로 가능한 작업이 자동으로 활성화/비활성화
- 명확한 워크플로우 진행

### 2. 통합 문서 관리
- 발주서, 청구서, 수령 확인서 통합 관리
- 문서간 연관 관계 추적

### 3. 실시간 협업
- 여러 사용자가 동시에 다른 발주서 작업 가능
- 상태 변경 시 실시간 반영

### 4. 감사 추적
- 모든 변경 사항 이력 관리
- 누가, 언제, 무엇을 변경했는지 추적

---

이 문서는 발주서 관리 시스템의 전체 업무 프로세스를 체계적으로 정리한 것입니다. 각 단계별로 제공되는 화면과 기능을 명확히 구분하여, 사용자가 업무 흐름을 쉽게 이해하고 따라갈 수 있도록 구성되었습니다.