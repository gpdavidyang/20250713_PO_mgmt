import{i as M,u as S,a as E,b as O,c as R,d as V,r as C,e as U,j as e,C as B,F as K,f as u,B as y,h as P,aX as w,g as $}from"./index-BmMnSXV0.js";import{D as z}from"./dashboard-skeleton-DV8zyTRv.js";import{AdvancedPieChart as F}from"./advanced-chart-BXCirGar.js";import{useRealTimeData as X}from"./dashboard-widgets-CgxxuKhZ.js";import{C as g}from"./clock-WTWVlGVw.js";import{D as Y}from"./dollar-sign-BokIEFvU.js";import{U as I}from"./users-CUATfcrO.js";import{T as k}from"./trending-up-y3aTIrrC.js";import{R as G,C as H,X as Q,Y as W,T as q,B as J}from"./PieChart-3_w6TUIJ.js";import{B as Z}from"./BarChart-C-0TffVE.js";import{P as A}from"./package-DeogsenO.js";import"./download-t2riQs1n.js";import"./AreaChart-iDJcEF5x.js";import"./refresh-cw-CHQImglB.js";import"./index-702oAgPD.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=M("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);function he(){const{user:d,isLoading:N}=S(),{toast:p}=E(),[,c]=O();R();const{actualTheme:T}=V(),s=T==="dark";C.useEffect(()=>{if(!N&&!d){p({title:"Unauthorized",description:"You are logged out. Redirecting to login...",variant:"destructive"}),setTimeout(()=>{c("/login")},500);return}},[d,N,p]);const{data:o,isLoading:L,error:h}=U();C.useEffect(()=>{h&&console.error("Dashboard data fetch error:",h),o&&console.log("Dashboard data loaded:",o)},[o,h]);const t=o?.statistics||{},v=o?.recentOrders||[],i=o?.monthlyStats||[],f=o?.statusStats||[],x=o?.projectStats||[],m=o?.categoryStats||[];t.activeProjects;const{data:b,loading:j,refresh:D}=X(t,async()=>(await(await fetch("/api/dashboard/unified")).json()).statistics||{},3e4,!!d);b.totalOrders||t.totalOrders,t.totalOrders,b.totalAmount||t.totalAmount,t.totalAmount,b.pendingOrders||t.pendingOrders,t.pendingOrders,t.pendingOrders>10;const n=L;return n?e.jsx(z,{}):d?e.jsxs("div",{className:"p-2 min-h-screen",style:{backgroundColor:s?"#111827":"#f9fafb"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-semibold",style:{color:s?"#f3f4f6":"#111827"},children:"대시보드"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:D,disabled:j,className:"text-xs flex items-center gap-1 px-1 py-0.5 rounded transition-colors",style:{color:s?"#9ca3af":"#6b7280",backgroundColor:"transparent"},onMouseEnter:a=>{a.currentTarget.style.color=s?"#d1d5db":"#374151",a.currentTarget.style.backgroundColor=s?"#374151":"#f3f4f6"},onMouseLeave:a=>{a.currentTarget.style.color=s?"#9ca3af":"#6b7280",a.currentTarget.style.backgroundColor="transparent"},children:[e.jsx(_,{className:`h-3 w-3 ${j?"animate-spin":""}`}),j?"업데이트":"새로고침"]}),e.jsx("span",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:new Date().toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-1 mb-2",children:[e.jsx("div",{className:"rounded border p-2 hover:shadow-sm transition-all cursor-pointer",style:{backgroundColor:s?"rgba(30, 58, 138, 0.2)":"rgba(239, 246, 255, 0.3)",borderColor:s?"#1e40af":"#93c5fd"},onClick:()=>c("/orders?status=pending"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:s?"rgba(180, 83, 9, 0.3)":"#fef3c7"},children:e.jsx(g,{className:"h-3 w-3",style:{color:s?"#fbbf24":"#d97706"}})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",style:{color:s?"#f3f4f6":"#111827"},children:t.pendingOrders||0}),e.jsx("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:"승인대기"})]})]})}),e.jsx("div",{className:"rounded border p-2 hover:shadow-sm transition-all cursor-pointer",style:{backgroundColor:s?"rgba(30, 58, 138, 0.2)":"rgba(239, 246, 255, 0.3)",borderColor:s?"#1e40af":"#93c5fd"},onClick:()=>c("/orders?filter=urgent"),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:s?"rgba(127, 29, 29, 0.3)":"#fecaca"},children:e.jsx(B,{className:"h-3 w-3",style:{color:s?"#f87171":"#dc2626"}})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",style:{color:s?"#f3f4f6":"#111827"},children:t.urgentOrders||0}),e.jsx("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:"긴급발주"})]})]})}),e.jsx("div",{className:"rounded border p-2",style:{backgroundColor:s?"rgba(30, 58, 138, 0.2)":"rgba(239, 246, 255, 0.3)",borderColor:s?"#1e40af":"#93c5fd"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:s?"rgba(30, 58, 138, 0.3)":"#dbeafe"},children:e.jsx(K,{className:"h-3 w-3",style:{color:s?"#60a5fa":"#2563eb"}})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",style:{color:s?"#f3f4f6":"#111827"},children:t.totalOrders||0}),e.jsx("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:"총발주서"})]})]})}),e.jsx("div",{className:"rounded border p-2",style:{backgroundColor:s?"rgba(30, 58, 138, 0.2)":"rgba(239, 246, 255, 0.3)",borderColor:s?"#1e40af":"#93c5fd"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:s?"rgba(5, 150, 105, 0.3)":"#d1fae5"},children:e.jsx(Y,{className:"h-3 w-3",style:{color:s?"#34d399":"#059669"}})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-bold",style:{color:s?"#60a5fa":"#2563eb"},children:u(t.totalAmount||0).replace("₩","").replace(",000,000","M")}),e.jsx("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:"총금액"})]})]})}),e.jsx("div",{className:"rounded border p-2",style:{backgroundColor:s?"rgba(30, 58, 138, 0.2)":"rgba(239, 246, 255, 0.3)",borderColor:s?"#1e40af":"#93c5fd"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:s?"rgba(107, 33, 168, 0.3)":"#ede9fe"},children:e.jsx(y,{className:"h-3 w-3",style:{color:s?"#a855f7":"#7c3aed"}})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",style:{color:s?"#f3f4f6":"#111827"},children:t.activeProjects||0}),e.jsx("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:"활성현장"})]})]})}),e.jsx("div",{className:"rounded border p-2",style:{backgroundColor:s?"rgba(30, 58, 138, 0.2)":"rgba(239, 246, 255, 0.3)",borderColor:s?"#1e40af":"#93c5fd"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center",style:{backgroundColor:s?"rgba(67, 56, 202, 0.3)":"#e0e7ff"},children:e.jsx(I,{className:"h-3 w-3",style:{color:s?"#818cf8":"#4f46e5"}})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold",style:{color:s?"#f3f4f6":"#111827"},children:t.activeVendors||0}),e.jsx("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:"활성거래처"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[e.jsxs("div",{className:"space-y-1",children:[!n&&i&&Array.isArray(i)&&i.length>0?(()=>{const a=i.map(r=>({month:r.month.replace("-","/"),orders:Number(r.count)||0}));return e.jsxs("div",{className:"rounded border p-2",style:{backgroundColor:s?"#1f2937":"#ffffff",borderColor:s?"#374151":"#93c5fd"},children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(k,{className:"h-3 w-3",style:{color:s?"#9ca3af":"#4b5563"}}),e.jsx("h3",{className:"text-xs font-semibold",style:{color:s?"#f3f4f6":"#111827"},children:"월별 발주 통계"})]}),e.jsx("div",{className:"h-[140px] w-full",children:e.jsx(G,{width:"100%",height:"100%",children:e.jsxs(Z,{data:a,margin:{top:5,right:5,left:5,bottom:5},children:[e.jsx(H,{strokeDasharray:"2 2",stroke:"#f3f4f6"}),e.jsx(Q,{dataKey:"month",fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(W,{fontSize:9,axisLine:!1,tickLine:!1}),e.jsx(q,{formatter:r=>[`${r}건`,"발주 건수"]}),e.jsx(J,{dataKey:"orders",fill:"#3b82f6",radius:[2,2,0,0]})]})})})]})})():e.jsxs("div",{className:"rounded border p-2",style:{backgroundColor:s?"#1f2937":"#ffffff",borderColor:s?"#374151":"#93c5fd"},children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(k,{className:"h-3 w-3",style:{color:s?"#9ca3af":"#4b5563"}}),e.jsx("h3",{className:"text-xs font-semibold",style:{color:s?"#f3f4f6":"#111827"},children:"월별 발주 통계"})]}),e.jsx("div",{className:"h-[140px] flex items-center justify-center",style:{color:s?"#9ca3af":"#6b7280"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"h-6 w-6 mx-auto mb-1",style:{color:s?"#4b5563":"#d1d5db"}}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})]}),e.jsxs("div",{className:"rounded border p-2",style:{backgroundColor:s?"#1f2937":"#ffffff",borderColor:s?"#374151":"#93c5fd"},children:[e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx(A,{className:"h-3 w-3",style:{color:s?"#9ca3af":"#4b5563"}}),e.jsx("h3",{className:"text-xs font-semibold",style:{color:s?"#f3f4f6":"#111827"},children:"발주상태분포"})]}),!n&&f&&Array.isArray(f)&&f.length>0?e.jsx("div",{className:"h-[140px] w-full",children:e.jsx(F,{data:f.map(a=>({name:a.status==="pending"?"승인대기":a.status==="approved"?"승인완료":a.status==="sent"?"발송완료":a.status==="completed"?"완료":a.status==="draft"?"임시저장":a.status==="cancelled"?"취소됨":a.status,value:parseInt(a.count),status:a.status})),dataKey:"value",nameKey:"name",height:140,showExport:!1,showLabels:!1,showLegend:!1,innerRadius:20,outerRadius:45,colors:["#f59e0b","#10b981","#3b82f6","#8b5cf6","#6b7280","#ef4444"],formatValue:a=>`${a}건`})}):e.jsx("div",{className:"h-[140px] flex items-center justify-center",style:{color:s?"#9ca3af":"#6b7280"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(A,{className:"h-6 w-6 mx-auto mb-1",style:{color:s?"#4b5563":"#d1d5db"}}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})]})]}),e.jsxs("div",{className:"rounded border p-2",style:{backgroundColor:s?"#1f2937":"#ffffff",borderColor:s?"#374151":"#e5e7eb"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3",style:{color:s?"#9ca3af":"#4b5563"}}),e.jsx("h3",{className:"text-xs font-semibold",style:{color:s?"#f3f4f6":"#111827"},children:"현장별 발주 현황"})]}),e.jsx("span",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:"상위 10개"})]}),e.jsx("div",{className:"h-[260px] overflow-y-auto",children:!n&&x&&Array.isArray(x)&&x.length>0?e.jsx("div",{className:"space-y-1",children:x.slice(0,10).map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded cursor-pointer transition-colors",style:{backgroundColor:"transparent"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor=s?"#374151":"#f9fafb"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor="transparent"},onClick:()=>c(`/projects/${a.id}`),children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[e.jsx("span",{className:"text-xs font-medium w-4 text-center",style:{color:s?"#9ca3af":"#4b5563"},children:r+1}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs font-medium truncate",style:{color:s?"#f3f4f6":"#111827"},title:a.projectName,children:a.projectName}),e.jsxs("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:[a.orderCount,"건"]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-xs font-semibold",style:{color:s?"#60a5fa":"#2563eb"},children:u(a.totalAmount||0).replace("₩","").replace(",000,000","M")})})]},r))}):e.jsx("div",{className:"h-[240px] flex items-center justify-center",style:{color:s?"#9ca3af":"#6b7280"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(y,{className:"h-6 w-6 mx-auto mb-1",style:{color:s?"#4b5563":"#d1d5db"}}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"rounded border p-2",style:{backgroundColor:s?"#1f2937":"#ffffff",borderColor:s?"#374151":"#e5e7eb"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"h-3 w-3",style:{color:s?"#9ca3af":"#4b5563"}}),e.jsx("h3",{className:"text-xs font-semibold",style:{color:s?"#f3f4f6":"#111827"},children:"최근 발주서"})]}),e.jsx("button",{onClick:()=>c("/orders"),className:"text-xs font-medium transition-colors",style:{color:s?"#60a5fa":"#2563eb"},onMouseEnter:a=>{a.currentTarget.style.color=s?"#3b82f6":"#1d4ed8"},onMouseLeave:a=>{a.currentTarget.style.color=s?"#60a5fa":"#2563eb"},children:"전체보기"})]}),e.jsx("div",{className:"h-[120px] overflow-y-auto",children:!n&&v.length>0?e.jsx("div",{className:"space-y-1",children:v.slice(0,6).map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-1 rounded cursor-pointer transition-colors",style:{backgroundColor:"transparent"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor=s?"#374151":"#f9fafb"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor="transparent"},onClick:()=>c(`/orders/${a.id}`),children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"text-xs font-medium truncate",style:{color:s?"#f3f4f6":"#111827"},children:a.orderNumber}),e.jsx("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:a.vendor?.name})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-xs font-semibold",style:{color:s?"#60a5fa":"#2563eb"},children:u(a.totalAmount||0).replace("₩","").replace(",000,000","M")})})]},r))}):e.jsx("div",{className:"h-[100px] flex items-center justify-center",style:{color:s?"#9ca3af":"#6b7280"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(g,{className:"h-6 w-6 mx-auto mb-1",style:{color:s?"#4b5563":"#d1d5db"}}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})})]}),e.jsxs("div",{className:"rounded border p-2",style:{backgroundColor:s?"#1f2937":"#ffffff",borderColor:s?"#374151":"#e5e7eb"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3",style:{color:s?"#9ca3af":"#4b5563"}}),e.jsx("h3",{className:"text-xs font-semibold",style:{color:s?"#f3f4f6":"#111827"},children:"품목 분류"})]}),e.jsx("button",{onClick:()=>c("/category-management"),className:"text-xs font-medium transition-colors",style:{color:s?"#60a5fa":"#2563eb"},onMouseEnter:a=>{a.currentTarget.style.color=s?"#3b82f6":"#1d4ed8"},onMouseLeave:a=>{a.currentTarget.style.color=s?"#60a5fa":"#2563eb"},children:"관리"})]}),e.jsx("div",{className:"h-[120px] overflow-y-auto",children:!n&&m&&Array.isArray(m)&&m.length>0?e.jsx("div",{className:"space-y-1",children:m.slice(0,6).sort((a,r)=>r.totalAmount-a.totalAmount).map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-1 rounded transition-colors",style:{backgroundColor:"transparent"},onMouseEnter:l=>{l.currentTarget.style.backgroundColor=s?"#374151":"#f9fafb"},onMouseLeave:l=>{l.currentTarget.style.backgroundColor="transparent"},children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-xs font-medium",style:{color:s?"#f3f4f6":"#111827"},children:a.majorCategory}),a.middleCategory!=="미분류"&&e.jsxs(e.Fragment,{children:[e.jsx($,{className:"h-2 w-2",style:{color:s?"#6b7280":"#9ca3af"}}),e.jsx("span",{className:"text-xs truncate",style:{color:s?"#9ca3af":"#4b5563"},children:a.middleCategory})]})]}),e.jsxs("div",{className:"text-xs",style:{color:s?"#9ca3af":"#6b7280"},children:[a.orderCount,"건"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"text-xs font-semibold",style:{color:s?"#60a5fa":"#2563eb"},children:u(a.totalAmount).replace("₩","").replace(",000,000","M")})})]},r))}):e.jsx("div",{className:"h-[100px] flex items-center justify-center",style:{color:s?"#9ca3af":"#6b7280"},children:e.jsxs("div",{className:"text-center",children:[e.jsx(w,{className:"h-6 w-6 mx-auto mb-1",style:{color:s?"#4b5563":"#d1d5db"}}),e.jsx("p",{className:"text-xs",children:"데이터 준비 중..."})]})})})]})]})]})]}):null}export{he as default};
