# 📝 발주서 시스템 테스트 시나리오

## 1. 발주서 작성 (Order Creation)

### 시나리오 1.1: 새 발주서 작성 - 기본 플로우
**목적**: 사용자가 새 발주서를 성공적으로 작성할 수 있는지 확인

**전제조건**:
- 관리자 권한으로 로그인
- 거래처 및 프로젝트 마스터 데이터 존재

**테스트 단계**:
1. 대시보드에서 "새 발주서" 버튼 클릭
2. `/orders/new` 페이지로 이동 확인
3. 필수 정보 입력:
   - 프로젝트 선택
   - 거래처 선택
   - 발주일자 입력
   - 납기일자 입력
4. 품목 추가:
   - "품목 추가" 버튼 클릭
   - 품목명, 수량, 단가 입력
   - 금액 자동 계산 확인
5. "저장" 버튼 클릭
6. 성공 메시지 확인
7. 발주서 목록에서 새 발주서 확인

**예상 결과**:
- 발주서가 "임시저장" 상태로 생성됨
- 발주번호가 자동 생성됨 (PO-YYYY-XXXXX 형식)

### 시나리오 1.2: 발주서 작성 - 유효성 검사
**목적**: 필수 필드 누락 시 적절한 에러 메시지 표시 확인

**테스트 단계**:
1. `/orders/new` 페이지 접근
2. 필수 필드를 비운 채 "저장" 클릭
3. 각 필드별 에러 메시지 확인:
   - 프로젝트: "프로젝트를 선택해주세요"
   - 거래처: "거래처를 선택해주세요"
   - 품목: "최소 1개 이상의 품목을 추가해주세요"

**예상 결과**:
- 저장이 되지 않고 에러 메시지 표시
- 포커스가 첫 번째 에러 필드로 이동

### 시나리오 1.3: 엑셀 업로드를 통한 발주서 작성
**목적**: 엑셀 파일로 대량 발주서 데이터 입력 확인

**테스트 단계**:
1. 발주서 목록에서 "엑셀 업로드" 버튼 클릭
2. 템플릿 다운로드 링크 확인
3. 샘플 엑셀 파일 선택
4. "업로드" 버튼 클릭
5. 처리 진행 상태 표시 확인
6. 업로드 결과 요약 확인

**예상 결과**:
- 엑셀 데이터가 정상적으로 파싱됨
- 오류가 있는 경우 행 번호와 함께 표시
- 성공한 발주서는 목록에 추가됨

## 2. 발주서 관리 (Order Management)

### 시나리오 2.1: 발주서 목록 조회
**목적**: 발주서 목록이 올바르게 표시되는지 확인

**테스트 단계**:
1. 메뉴에서 "발주서 관리" 클릭
2. `/orders` 페이지 로딩 확인
3. 테이블 형태의 목록 확인
4. 각 컬럼 확인:
   - 발주번호
   - 거래처
   - 프로젝트  
   - 발주일
   - 금액
   - 상태
   - 액션 버튼

**예상 결과**:
- 최신 발주서가 상단에 표시 (기본 정렬)
- 페이지당 10-20개 항목 표시
- 페이지네이션 작동

### 시나리오 2.2: 발주서 검색
**목적**: 검색 기능이 정상 작동하는지 확인

**테스트 케이스**:
1. **발주번호로 검색**:
   - "PO-2025" 입력 → 2025년 발주서만 표시
   - "PO-2025-00001" 입력 → 해당 발주서만 표시

2. **거래처명으로 검색**:
   - "제이파트너" 입력 → 해당 거래처 발주서만 표시

3. **검색 초기화**:
   - 검색어 삭제 → 전체 목록 표시

**예상 결과**:
- 실시간 검색 또는 엔터키로 검색 실행
- 검색 결과가 없을 때 "결과 없음" 메시지

### 시나리오 2.3: 발주서 필터링
**목적**: 상태별 필터링이 작동하는지 확인

**테스트 단계**:
1. 상태 필터 드롭다운 클릭
2. 각 상태별 필터링:
   - 전체
   - 임시저장
   - 승인대기
   - 승인완료
   - 발송됨
   - 완료

**예상 결과**:
- 선택한 상태의 발주서만 표시
- 필터 적용 시 URL 파라미터 업데이트
- 새로고침 후에도 필터 유지

### 시나리오 2.4: 발주서 정렬
**목적**: 컬럼별 정렬 기능 확인

**테스트 단계**:
1. 각 컬럼 헤더 클릭
2. 오름차순/내림차순 토글 확인
3. 정렬 아이콘 표시 확인

**예상 결과**:
- 클릭한 컬럼 기준으로 정렬
- 정렬 방향 아이콘 표시 (▲/▼)

## 3. 발주서 상세 (Order Detail)

### 시나리오 3.1: 발주서 상세 조회
**목적**: 발주서 상세 정보가 완전하게 표시되는지 확인

**테스트 단계**:
1. 목록에서 발주서 번호 또는 "상세보기" 클릭
2. `/orders/{id}` 페이지 로딩
3. 표시 정보 확인:
   - 기본 정보 (발주번호, 상태, 작성일 등)
   - 거래처 정보
   - 프로젝트 정보
   - 품목 상세 목록
   - 총 금액
   - 첨부파일

**예상 결과**:
- 모든 정보가 읽기 전용으로 표시
- 상태에 따른 액션 버튼 표시

### 시나리오 3.2: PDF 미리보기
**목적**: PDF 미리보기 기능이 작동하는지 확인

**테스트 단계**:
1. 발주서 상세 페이지에서 "PDF 미리보기" 버튼 클릭
2. PDF 생성/로딩 상태 확인
3. 미리보기 모달 또는 새 탭 확인

**예상 결과**:
- 기존 PDF가 있으면: 즉시 미리보기
- 기존 PDF가 없으면: 생성 후 미리보기
- PDF에 발주서 정보가 올바르게 표시

### 시나리오 3.3: 발주서 수정
**목적**: 발주서 수정 기능 확인

**전제조건**: 발주서 상태가 "임시저장" 또는 "반려"

**테스트 단계**:
1. "수정" 버튼 클릭
2. 수정 가능 필드 활성화 확인
3. 정보 수정:
   - 납기일 변경
   - 품목 수량 변경
   - 품목 추가/삭제
4. "저장" 클릭
5. 변경사항 확인

**예상 결과**:
- 수정된 내용이 저장됨
- 수정 이력이 기록됨
- 총 금액이 재계산됨

### 시나리오 3.4: 발주서 승인
**목적**: 승인 워크플로우가 정상 작동하는지 확인

**전제조건**: 
- 관리자 권한
- 발주서 상태가 "승인대기"

**테스트 단계**:
1. "승인" 버튼 클릭
2. 승인 확인 모달 표시
3. 승인 사유 입력 (선택)
4. "확인" 클릭
5. 상태 변경 확인

**예상 결과**:
- 상태가 "승인완료"로 변경
- 승인자 정보 기록
- 승인 일시 기록
- 이메일 알림 발송 (설정된 경우)

### 시나리오 3.5: 발주서 발송
**목적**: 거래처에 발주서 발송 기능 확인

**전제조건**: 발주서 상태가 "승인완료"

**테스트 단계**:
1. "발송" 버튼 클릭
2. 발송 정보 확인:
   - 수신자 이메일
   - 발송 내용 미리보기
3. "발송" 확인
4. 발송 결과 확인

**예상 결과**:
- 이메일로 PDF 발주서 발송
- 상태가 "발송됨"으로 변경
- 발송 일시 기록

## 4. 통합 시나리오

### 시나리오 4.1: 전체 발주 프로세스
**목적**: 발주서 생성부터 완료까지 전체 프로세스 확인

**테스트 단계**:
1. **작성 단계**:
   - 새 발주서 작성
   - 임시저장 상태 확인

2. **검토 단계**:
   - 발주서 상세 조회
   - PDF 미리보기
   - 필요시 수정

3. **승인 단계**:
   - 승인 요청
   - 관리자 승인

4. **발송 단계**:
   - 거래처 발송
   - 발송 확인

5. **완료 단계**:
   - 수령 확인
   - 완료 처리

**예상 결과**:
- 각 단계별 상태 변경이 정확함
- 권한에 따른 액션 제한이 작동
- 전체 프로세스가 원활하게 진행

## 5. 예외 상황 테스트

### 시나리오 5.1: 네트워크 오류 처리
**테스트 케이스**:
- 발주서 저장 중 네트워크 끊김
- 대용량 엑셀 업로드 중 타임아웃
- API 서버 응답 지연

**예상 결과**:
- 적절한 에러 메시지 표시
- 재시도 옵션 제공
- 데이터 손실 방지

### 시나리오 5.2: 동시 편집 충돌
**테스트 케이스**:
- 두 사용자가 동시에 같은 발주서 수정
- 승인 중 다른 사용자가 수정 시도

**예상 결과**:
- 충돌 감지 및 경고
- 최신 버전 확인 옵션
- 변경사항 병합 또는 선택

### 시나리오 5.3: 권한 검증
**테스트 케이스**:
- 일반 사용자가 승인 시도
- 로그아웃 상태에서 페이지 접근
- URL 직접 입력으로 권한 없는 페이지 접근

**예상 결과**:
- 권한 없음 메시지
- 로그인 페이지로 리다이렉트
- 적절한 HTTP 상태 코드 반환

## 6. 성능 테스트 시나리오

### 시나리오 6.1: 대량 데이터 처리
**테스트 케이스**:
- 1000개 이상 발주서 목록 조회
- 100개 품목이 포함된 발주서 처리
- 10MB 이상 엑셀 파일 업로드

**성능 기준**:
- 목록 로딩: 3초 이내
- 검색 응답: 1초 이내
- PDF 생성: 5초 이내

### 시나리오 6.2: 동시 사용자 부하
**테스트 케이스**:
- 50명 동시 접속
- 10명 동시 발주서 작성
- 5명 동시 PDF 생성

**성능 기준**:
- 응답 시간 저하 20% 이내
- 에러율 1% 이하
- 시스템 가용성 99.9%

---

**참고사항**:
- 각 시나리오는 독립적으로 실행 가능해야 함
- 테스트 데이터는 초기화 가능해야 함
- 실제 이메일 발송은 테스트 환경에서 비활성화
- 모든 테스트는 롤백 가능해야 함