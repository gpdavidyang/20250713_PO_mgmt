import{j as e,a as K}from"./chunk-D67rGsji.js";import{r as S}from"./chunk-BgLp_VvL.js";import{B as F,C as R,h as $,i as L,g as O,k as ke,l as Se,I as se,L as f}from"./chunk-DV-F1ehd.js";import{u as Ae}from"./chunk-CFxRDIMf.js";import{S as w,h as C,i as D,j as k,k as r,D as Fe,a as Te,b as Ie,c as Re,f as te}from"./chunk-bdHBeqB0.js";import{C as q}from"./chunk-Qrbxos93.js";import{h as $e,E as Le}from"./chunk-DWlBX1KS.js";import{G as Oe}from"./chunk-Bw5QEQRA.js";import{F as ee,D as ue,R as ae,P as Ee,m as Pe,n as Ke,T as J,j as re,g as le,X as ne,Y as de,h as ce,k as ie,x as pe,ao as Me,_ as Ue,ag as Ve,a as ze,aS as qe,aT as Be,aU as Ge}from"./chunk-CVirgo2y.js";import{a as j}from"./chunk-gd6aBVnV.js";import"./chunk-CZez8RVl.js";import"./index-B9Zn91qv.js";function He({config:u,orders:h,onClose:Q}){const T=S.useRef(null),B=h.reduce((a,d)=>{const c=parseFloat(d.totalAmount)||0;return a+c},0),n=B/h.length,E=Object.entries(h.reduce((a,d)=>{const c=Oe(d.status);return a[c]=(a[c]||0)+1,a},{})).map(([a,d])=>({name:a,value:d})),P=Object.entries(h.reduce((a,d)=>{const c=new Date(d.orderDate).toLocaleDateString("ko-KR",{year:"numeric",month:"long"});return a[c]=(a[c]||0)+1,a},{})).map(([a,d])=>({month:a,orders:d})),W=Object.entries(h.reduce((a,d)=>{const c=d.vendor?.name||"알 수 없음";return a[c]=(a[c]||0)+1,a},{})).sort(([,a],[,d])=>d-a).slice(0,10).map(([a,d])=>({name:a,orders:d})),N=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"],b=async()=>{if(T.current)try{const a=await $e(T.current,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff"}),d=a.toDataURL("image/png"),c=new Le("p","mm","a4"),M=210,X=295,A=a.height*M/a.width;let G=A,H=0;for(c.addImage(d,"PNG",0,H,M,A),G-=X;G>=0;)H=G-A,c.addPage(),c.addImage(d,"PNG",0,H,M,A),G-=X;const m=`${u.title.replace(/[^a-zA-Z0-9가-힣]/g,"_")}.pdf`;c.save(m)}catch(a){console.error("PDF 생성 실패:",a)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"보고서 미리보기"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{onClick:b,className:"bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(ue,{className:"h-4 w-4 mr-2"}),"PDF 다운로드"]}),e.jsx(F,{variant:"outline",onClick:Q,children:"닫기"})]})]}),e.jsxs("div",{ref:T,className:"p-8 bg-white",style:{minHeight:"297mm"},children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-2",children:u.title}),e.jsxs("p",{className:"text-gray-600",children:["생성일: ",new Date().toLocaleDateString("ko-KR")]}),e.jsxs("p",{className:"text-gray-600",children:["분석 데이터: ",h.length,"건"]})]}),e.jsxs(R,{className:"mb-6",children:[e.jsx($,{children:e.jsx(L,{children:"요약 정보"})}),e.jsx(O,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"총 발주 건수"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["₩",Math.floor(B).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"총 발주 금액"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["₩",Math.floor(n).toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"평균 발주 금액"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:W.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"거래처 수"})]})]})})]}),u.summary&&e.jsxs(R,{className:"mb-6",children:[e.jsx($,{children:e.jsx(L,{children:"분석 요약"})}),e.jsx(O,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:u.summary})})]}),e.jsxs("div",{className:"space-y-6",children:[u.includeCharts.statusDistribution&&e.jsxs(R,{children:[e.jsx($,{children:e.jsx(L,{children:"발주 상태별 분포"})}),e.jsx(O,{children:e.jsx(ae,{width:"100%",height:300,children:u.chartTypes.statusDistribution==="pie"?e.jsxs(Ee,{children:[e.jsx(Pe,{data:E,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,value:d,percent:c})=>`${a}: ${d}건 (${(c*100).toFixed(1)}%)`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:E.map((a,d)=>e.jsx(Ke,{fill:N[d%N.length]},`cell-${d}`))}),e.jsx(J,{})]}):e.jsxs(re,{data:E,children:[e.jsx(le,{strokeDasharray:"3 3"}),e.jsx(ne,{dataKey:"name"}),e.jsx(de,{}),e.jsx(J,{}),e.jsx(ce,{}),e.jsx(ie,{dataKey:"value",fill:"#8884d8"})]})})})]}),u.includeCharts.monthlyTrend&&e.jsxs(R,{children:[e.jsx($,{children:e.jsx(L,{children:"월별 발주 현황"})}),e.jsx(O,{children:e.jsx(ae,{width:"100%",height:300,children:e.jsxs(re,{data:P,children:[e.jsx(le,{strokeDasharray:"3 3"}),e.jsx(ne,{dataKey:"month"}),e.jsx(de,{}),e.jsx(J,{}),e.jsx(ce,{}),e.jsx(ie,{dataKey:"orders",fill:"#82ca9d"})]})})})]}),u.includeCharts.vendorAnalysis&&e.jsxs(R,{children:[e.jsx($,{children:e.jsx(L,{children:"거래처별 발주 현황 (상위 10개)"})}),e.jsx(O,{children:u.chartTypes.vendorAnalysis==="table"?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"거래처명"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-center",children:"발주 건수"})]})}),e.jsx("tbody",{children:W.map((a,d)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border border-gray-200 px-4 py-2",children:a.name}),e.jsxs("td",{className:"border border-gray-200 px-4 py-2 text-center",children:[a.orders,"건"]})]},d))})]})}):e.jsx(ae,{width:"100%",height:300,children:e.jsxs(re,{data:W,layout:u.chartTypes.vendorAnalysis==="horizontal"?"horizontal":"vertical",children:[e.jsx(le,{strokeDasharray:"3 3"}),e.jsx(ne,{dataKey:u.chartTypes.vendorAnalysis==="horizontal"?"orders":"name"}),e.jsx(de,{dataKey:u.chartTypes.vendorAnalysis==="horizontal"?"name":void 0}),e.jsx(J,{}),e.jsx(ce,{}),e.jsx(ie,{dataKey:"orders",fill:"#ffc658"})]})})})]})]}),u.insights&&e.jsxs(R,{className:"mt-6",children:[e.jsx($,{children:e.jsx(L,{children:"주요 인사이트"})}),e.jsx(O,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:u.insights})})]}),u.comments&&e.jsxs(R,{className:"mt-6",children:[e.jsx($,{children:e.jsx(L,{children:"추가 코멘트"})}),e.jsx(O,{children:e.jsx("div",{className:"whitespace-pre-line text-sm",children:u.comments})})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t text-center text-xs text-gray-500",children:[e.jsx("p",{children:"본 보고서는 발주 관리 시스템에서 자동 생성되었습니다."}),e.jsxs("p",{children:["생성 시간: ",new Date().toLocaleString("ko-KR")]})]})]})]})})}function ls(){const{user:u,isAuthenticated:h,isLoading:Q}=ke(),{toast:T}=Se(),[,B]=Ae(),[n,E]=S.useState("orders"),[P,W]=S.useState("major"),[N,b]=S.useState({year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all"}),[a,d]=S.useState(null),[c,M]=S.useState(new Set),[X,A]=S.useState(!1),[G,H]=S.useState(!1),[m,g]=S.useState({title:"",includeCharts:{statusDistribution:!0,monthlyTrend:!0,vendorAnalysis:!0,amountAnalysis:!1},chartTypes:{statusDistribution:"pie",monthlyTrend:"bar",vendorAnalysis:"bar",amountAnalysis:"bar"},summary:"",insights:"",comments:"",outputOptions:{includePdf:!0,includeExcel:!1,sendEmail:!1}}),[y,je]=S.useState(null),U=s=>{let t="asc";y&&y.key===s&&y.direction==="asc"&&(t="desc"),je({key:s,direction:t})},ge=s=>y?[...s].sort((t,l)=>{let i=t[y.key],x=l[y.key];return y.key==="vendor"?(i=t.vendor?.name||"",x=l.vendor?.name||""):y.key==="user"?(i=t.user?`${t.user.lastName||""} ${t.user.firstName||""}`.trim():"",x=l.user?`${l.user.lastName||""} ${l.user.firstName||""}`.trim():""):y.key==="orderDate"?(i=new Date(i||0),x=new Date(x||0)):y.key==="totalAmount"&&(i=Number(i)||0,x=Number(x)||0),i<x?y.direction==="asc"?-1:1:i>x?y.direction==="asc"?1:-1:0}):s,V=s=>!y||y.key!==s?e.jsx(qe,{className:"h-4 w-4 text-gray-400"}):y.direction==="asc"?e.jsx(Be,{className:"h-4 w-4 text-blue-600"}):e.jsx(Ge,{className:"h-4 w-4 text-blue-600"}),ye=(s,t)=>{if(s){const l=new Set(t.map(i=>i.id));M(l)}else M(new Set)},Ne=(s,t)=>{const l=new Set(c);t?l.add(s):l.delete(s),M(l)},be=s=>s.length>0&&s.every(t=>c.has(t.id)),ve=s=>{const t=s.filter(l=>c.has(l.id)).length;return t>0&&t<s.length},fe=()=>{const s=o?.orders?.filter(l=>c.has(l.id))||[],t=`발주 현황 보고서 (${s.length}건) - ${new Date().toLocaleDateString("ko-KR")}`;g(l=>({...l,title:t,summary:we(s)})),A(!0)},we=s=>{if(s.length===0)return"";const t=s.reduce((p,v)=>{const Z=parseFloat(v.totalAmount)||0;return p+Z},0),l=t/s.length,i=s.reduce((p,v)=>(p[v.status]=(p[v.status]||0)+1,p),{}),x=Object.entries(s.reduce((p,v)=>{const Z=v.vendor?.name||"알 수 없음";return p[Z]=(p[Z]||0)+1,p},{})).sort(([,p],[,v])=>v-p).slice(0,3),z=p=>{switch(p){case"draft":return"임시 저장";case"pending":return"승인 대기";case"approved":return"승인 완료";case"sent":return"발송됨";case"completed":return"발주 완료";case"rejected":return"반려";default:return p}};return`총 ${s.length}건의 발주 데이터를 분석한 결과:
• 총 발주 금액: ₩${Math.floor(t).toLocaleString()}
• 평균 발주 금액: ₩${Math.floor(l).toLocaleString()}
• 주요 거래처: ${x.map(([p,v])=>`${p}(${v}건)`).join(", ")}
• 상태 분포: ${Object.entries(i).map(([p,v])=>`${z(p)}(${v}건)`).join(", ")}`},Ce=async()=>{try{A(!1),H(!0)}catch{T({title:"오류",description:"보고서 생성에 실패했습니다.",variant:"destructive"})}};S.useEffect(()=>{if(!Q&&!h){T({title:"권한 없음",description:"로그아웃되었습니다. 다시 로그인합니다...",variant:"destructive"}),setTimeout(()=>{B("/login")},500);return}},[h,Q,T]);const{data:oe}=K({queryKey:["/api/vendors"],enabled:h}),{data:xe}=K({queryKey:["/api/order-templates"],enabled:h}),{data:me}=K({queryKey:["/api/users"],enabled:h}),{data:o,isLoading:he}=K({queryKey:["/api/orders",a],queryFn:async()=>{if(!a)return{orders:[],total:0};const s=new URLSearchParams;a.year&&s.append("year",a.year),a.startDate&&s.append("startDate",a.startDate),a.endDate&&s.append("endDate",a.endDate),a.vendorId&&a.vendorId!=="all"&&s.append("vendorId",a.vendorId),a.status&&a.status!=="all"&&s.append("status",a.status),a.templateId&&a.templateId!=="all"&&s.append("templateId",a.templateId),a.userId&&a.userId!=="all"&&s.append("userId",a.userId),s.append("limit","1000");const t=await fetch(`/api/orders?${s.toString()}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()},enabled:h&&!!a});K({queryKey:["/api/reports/summary",a?.startDate,a?.endDate],queryFn:async()=>{const s=new URLSearchParams;a?.startDate&&s.append("startDate",a.startDate),a?.endDate&&s.append("endDate",a.endDate);const t=await fetch(`/api/reports/summary?${s.toString()}`);if(!t.ok)throw new Error("Failed to fetch summary report");return t.json()},enabled:h&&!!a});const{data:Y}=K({queryKey:["/api/reports/by-category",a?.startDate,a?.endDate,P],queryFn:async()=>{const s=new URLSearchParams;a?.startDate&&s.append("startDate",a.startDate),a?.endDate&&s.append("endDate",a.endDate),s.append("categoryType",P);const t=await fetch(`/api/reports/by-category?${s.toString()}`);if(!t.ok)throw new Error("Failed to fetch category report");return t.json()},enabled:h&&!!a&&n==="category"}),{data:_}=K({queryKey:["/api/reports/by-project",a?.startDate,a?.endDate],queryFn:async()=>{const s=new URLSearchParams;a?.startDate&&s.append("startDate",a.startDate),a?.endDate&&s.append("endDate",a.endDate);const t=await fetch(`/api/reports/by-project?${s.toString()}`);if(!t.ok)throw new Error("Failed to fetch project report");return t.json()},enabled:h&&!!a&&n==="project"}),{data:I}=K({queryKey:["/api/reports/by-vendor",a?.startDate,a?.endDate],queryFn:async()=>{const s=new URLSearchParams;a?.startDate&&s.append("startDate",a.startDate),a?.endDate&&s.append("endDate",a.endDate);const t=await fetch(`/api/reports/by-vendor?${s.toString()}`);if(!t.ok)throw new Error("Failed to fetch vendor report");return t.json()},enabled:h&&!!a&&n==="vendor"}),De=async()=>{try{const s=new URLSearchParams;if(n==="orders"){const t=new URLSearchParams;a?.startDate&&t.append("startDate",a.startDate),a?.endDate&&t.append("endDate",a.endDate);const l=await fetch(`/api/reports/export-excel?type=processing&${t.toString()}`);if(!l.ok)throw new Error("Export failed");const i=await l.blob(),x=window.URL.createObjectURL(i),z=document.createElement("a");z.style.display="none",z.href=x,z.download=`orders_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(z),z.click(),window.URL.revokeObjectURL(x)}else{s.append("type",n),a?.startDate&&s.append("startDate",a.startDate),a?.endDate&&s.append("endDate",a.endDate),n==="category"&&s.append("categoryType",P);const t=await fetch(`/api/reports/export-excel?${s.toString()}`);if(!t.ok)throw new Error("Export failed");const l=await t.blob(),i=window.URL.createObjectURL(l),x=document.createElement("a");x.style.display="none",x.href=i,x.download=`${n}_report_${new Date().toISOString().slice(0,10)}.xlsx`,document.body.appendChild(x),x.click(),window.URL.revokeObjectURL(i)}T({title:"성공",description:"Excel 파일이 다운로드되었습니다."})}catch{T({title:"오류",description:"Excel 내보내기에 실패했습니다.",variant:"destructive"})}};return Q?e.jsx("div",{className:"p-6 space-y-6",children:e.jsx("div",{className:"animate-pulse text-lg",children:"로딩 중..."})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(pe,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"보고서 및 분석"}),e.jsx("p",{className:"text-sm text-gray-600",children:"발주 현황 및 통계를 확인하고 보고서를 생성하세요"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(F,{onClick:()=>A(!0),variant:"default",className:"gap-2",children:[e.jsx(ee,{className:"w-4 h-4"}),"보고서 생성"]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow border",children:e.jsx("div",{className:"border-b",children:e.jsxs("nav",{className:"-mb-px flex",children:[e.jsx("button",{onClick:()=>E("orders"),className:`py-2 px-6 text-sm font-medium border-b-2 ${n==="orders"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"발주 내역 검색"}),e.jsx("button",{onClick:()=>E("category"),className:`py-2 px-6 text-sm font-medium border-b-2 ${n==="category"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"분류별 보고서"}),e.jsx("button",{onClick:()=>E("project"),className:`py-2 px-6 text-sm font-medium border-b-2 ${n==="project"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"프로젝트별 보고서"}),e.jsx("button",{onClick:()=>E("vendor"),className:`py-2 px-6 text-sm font-medium border-b-2 ${n==="vendor"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"거래처별 보고서"})]})})}),e.jsxs(R,{children:[e.jsx($,{className:"pb-3",children:e.jsxs(L,{className:"text-lg font-semibold flex items-center gap-2 text-gray-900",children:[e.jsx(Me,{className:"h-5 w-5 text-blue-600"}),"필터 조건"]})}),e.jsxs(O,{className:"pt-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(n==="orders"||n==="category"||n==="project"||n==="vendor")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"시작일"}),e.jsx(se,{type:"date",value:N.startDate,onChange:s=>b(t=>({...t,startDate:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"종료일"}),e.jsx(se,{type:"date",value:N.endDate,onChange:s=>b(t=>({...t,endDate:s.target.value}))})]})]}),n==="category"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"분류 유형"}),e.jsxs(w,{value:P,onValueChange:s=>W(s),children:[e.jsx(C,{children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"major",children:"대분류"}),e.jsx(r,{value:"middle",children:"중분류"}),e.jsx(r,{value:"minor",children:"소분류"})]})]})]}),n==="orders"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"연도"}),e.jsxs(w,{value:N.year,onValueChange:s=>b(t=>({...t,year:s})),children:[e.jsx(C,{children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"all",children:"전체 연도"}),e.jsx(r,{value:"2025",children:"2025년"}),e.jsx(r,{value:"2024",children:"2024년"}),e.jsx(r,{value:"2023",children:"2023년"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"거래처"}),e.jsxs(w,{value:N.vendorId,onValueChange:s=>b(t=>({...t,vendorId:s})),children:[e.jsx(C,{children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"all",children:"전체 거래처"}),Array.isArray(oe)&&oe.map(s=>e.jsx(r,{value:s.id.toString(),children:s.name},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"발주 상태"}),e.jsxs(w,{value:N.status,onValueChange:s=>b(t=>({...t,status:s})),children:[e.jsx(C,{children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"all",children:"전체 상태"}),e.jsx(r,{value:"draft",children:"임시 저장"}),e.jsx(r,{value:"pending",children:"승인 대기"}),e.jsx(r,{value:"approved",children:"승인 완료"}),e.jsx(r,{value:"sent",children:"발송됨"}),e.jsx(r,{value:"completed",children:"발주 완료"}),e.jsx(r,{value:"rejected",children:"반려"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"발주 템플릿"}),e.jsxs(w,{value:N.templateId,onValueChange:s=>b(t=>({...t,templateId:s})),children:[e.jsx(C,{children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"all",children:"전체 템플릿"}),Array.isArray(xe)&&xe.map(s=>e.jsx(r,{value:s.id.toString(),children:s.templateName},s.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"금액 범위"}),e.jsxs(w,{value:N.amountRange,onValueChange:s=>b(t=>({...t,amountRange:s})),children:[e.jsx(C,{children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"all",children:"전체 금액"}),e.jsx(r,{value:"0-100000",children:"10만원 이하"}),e.jsx(r,{value:"100000-500000",children:"10만원 ~ 50만원"}),e.jsx(r,{value:"500000-1000000",children:"50만원 ~ 100만원"}),e.jsx(r,{value:"1000000-5000000",children:"100만원 ~ 500만원"}),e.jsx(r,{value:"5000000-99999999",children:"500만원 이상"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"담당자"}),e.jsxs(w,{value:N.userId,onValueChange:s=>b(t=>({...t,userId:s})),children:[e.jsx(C,{children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"all",children:"전체 담당자"}),Array.isArray(me)&&me.map(s=>e.jsxs(r,{value:s.id,children:[s.firstName," ",s.lastName]},s.id))]})]})]})]})]}),a&&Object.values(a).some(s=>s!=="all"&&s!=="")&&e.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"적용된 필터: "}),a.year!==new Date().getFullYear().toString()&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["연도: ",a.year,"년"]}),a.startDate&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["시작일: ",a.startDate]}),a.endDate&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["종료일: ",a.endDate]}),a.vendorId!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"거래처 필터링"}),a.status!=="all"&&e.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:["상태: ",a.status==="pending"?"승인 대기":a.status==="approved"?"승인 완료":a.status==="completed"?"발주 완료":"반려"]}),a.templateId!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"템플릿 필터링"}),a.amountRange!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"금액 범위 필터링"}),a.userId!=="all"&&e.jsx("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs mr-2",children:"담당자 필터링"})]}),e.jsx(F,{variant:"outline",size:"sm",onClick:()=>{const s={year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all"};b(s),d(s)},className:"text-gray-600 hover:text-gray-800",children:"필터 초기화"})]})}),e.jsxs("div",{className:"flex justify-end mt-4 gap-2",children:[e.jsx(F,{variant:"outline",size:"sm",onClick:()=>{const s={year:new Date().getFullYear().toString(),startDate:"",endDate:"",vendorId:"all",status:"all",templateId:"all",amountRange:"all",userId:"all"};b(s)},className:"text-gray-600 hover:text-gray-800",children:"초기화"}),e.jsx(F,{onClick:()=>{d(N)},size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"검색"})]})]})]}),e.jsxs(R,{children:[e.jsx($,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(L,{className:"text-lg font-semibold flex items-center gap-2 text-gray-900",children:[e.jsx(Ue,{className:"h-5 w-5 text-blue-600"}),n==="orders"?"검색 결과":n==="category"?"분류별 보고서 결과":n==="project"?"프로젝트별 보고서 결과":"거래처별 보고서 결과"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:n==="orders"?he?"데이터 로딩 중...":o&&o.orders?`총 ${o.orders.length}건의 발주 데이터`:"검색된 데이터가 없습니다":"필터를 설정하고 검색 버튼을 클릭하세요"})]}),e.jsxs("div",{className:"flex gap-2",children:[n==="orders"&&e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>fe(),disabled:c.size===0,className:"bg-green-600 hover:bg-green-700 text-white disabled:bg-gray-300",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"보고서 생성 (",c.size,"건)"]}),e.jsxs(F,{variant:"outline",size:"sm",onClick:()=>De(),className:"gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Excel 내보내기"]})]})]})}),e.jsx(O,{children:a?e.jsxs(e.Fragment,{children:[n==="orders"&&(he?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-gray-500",children:"데이터를 불러오는 중..."})}):o&&Array.isArray(o.orders)&&o.orders.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:(()=>{o.orders.reduce((l,i)=>(l[i.status]=(l[i.status]||0)+1,l),{});const s=o.orders.reduce((l,i)=>{const x=parseFloat(i.totalAmount)||0;return l+x},0),t=o.orders.length>0?s/o.orders.length:0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-700",children:o.orders.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"총 발주"})]}),e.jsxs("div",{className:"bg-blue-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 font-semibold",children:j(Math.floor(s))}),e.jsx("div",{className:"text-sm text-blue-600",children:"총 발주금액"})]}),e.jsxs("div",{className:"bg-purple-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 font-semibold",children:j(Math.floor(t))}),e.jsx("div",{className:"text-sm text-purple-600",children:"평균 발주금액"})]})]})})()}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:(()=>{const s=o.orders.reduce((t,l)=>(t[l.status]=(t[l.status]||0)+1,t),{});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-yellow-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:s.pending||0}),e.jsx("div",{className:"text-sm text-yellow-600",children:"승인 대기"})]}),e.jsxs("div",{className:"bg-blue-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-700",children:s.approved||0}),e.jsx("div",{className:"text-sm text-blue-600",children:"승인 완료"})]}),e.jsxs("div",{className:"bg-green-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-700",children:s.completed||0}),e.jsx("div",{className:"text-sm text-green-600",children:"발주 완료"})]}),e.jsxs("div",{className:"bg-red-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-700",children:s.rejected||0}),e.jsx("div",{className:"text-sm text-red-600",children:"반려"})]})]})})()})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900",children:e.jsx("input",{type:"checkbox",className:"rounded",checked:be(o.orders||[]),ref:s=>{s&&(s.indeterminate=ve(o.orders||[]))},onChange:s=>ye(s.target.checked,o.orders||[])})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>U("orderNumber"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["발주번호",V("orderNumber")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>U("vendor"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["거래처",V("vendor")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>U("orderDate"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["발주일자",V("orderDate")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>U("totalAmount"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["총금액",V("totalAmount")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>U("templateName"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["발주 템플릿",V("templateName")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>U("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["상태",V("status")]})}),e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-900 cursor-pointer hover:bg-gray-100 select-none",onClick:()=>U("user"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["작성자",V("user")]})})]})}),e.jsx("tbody",{children:ge(o.orders).map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-200",children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",className:"rounded",checked:c.has(s.id),onChange:t=>Ne(s.id,t.target.checked)})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx("button",{onClick:()=>B(`/order-preview/${s.id}`),className:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer",children:s.orderNumber})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:s.vendor?e.jsx("button",{onClick:()=>B(`/vendors/${s.vendor.id}`),className:"text-blue-600 hover:text-blue-800 hover:underline cursor-pointer",children:s.vendor.name}):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:s.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:s.totalAmount?j(Math.floor(s.totalAmount)):"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:s.templateName||"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="draft"?"bg-gray-100 text-gray-800":s.status==="pending"?"bg-yellow-100 text-yellow-800":s.status==="approved"?"bg-blue-100 text-blue-800":s.status==="sent"?"bg-purple-100 text-purple-800":s.status==="completed"?"bg-green-100 text-green-800":s.status==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:s.status==="draft"?"임시 저장":s.status==="pending"?"승인 대기":s.status==="approved"?"진행 중":s.status==="sent"?"발송됨":s.status==="completed"?"완료":s.status==="rejected"?"반려":s.status})}),e.jsx("td",{className:"py-3 px-4 text-sm",children:s.user?`${s.user.lastName||""} ${s.user.firstName||""}`.trim():"-"})]},s.id))}),e.jsxs("tfoot",{children:[(()=>{const s=o.orders.reduce((t,l)=>{const i=parseFloat(l.totalAmount)||0;return t+i},0);return o.orders.length>0&&s/o.orders.length,e.jsxs("tr",{className:"bg-gray-100 font-medium",children:[e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:"합계"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsx("span",{className:"font-bold text-blue-600 font-semibold",children:j(Math.floor(s))})}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"})]})})(),(()=>{const s=o.orders.reduce((l,i)=>{const x=parseFloat(i.totalAmount)||0;return l+x},0),t=o.orders.length>0?s/o.orders.length:0;return e.jsxs("tr",{className:"bg-gray-50 font-medium",children:[e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm font-medium",children:"평균"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm",children:e.jsx("span",{className:"font-bold text-blue-600 font-semibold",children:j(Math.floor(t))})}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"}),e.jsx("td",{className:"border border-gray-200 px-3 py-2 text-sm"})]})})()]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-500",children:"검색 조건에 맞는 데이터가 없습니다."}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"필터 조건을 변경하여 다시 검색해보세요."})]})),n==="category"&&Y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-2",children:[P==="major"?"대분류별":P==="middle"?"중분류별":"소분류별"," 발주 보고서"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 분류 수:"}),e.jsx("span",{className:"ml-2 font-medium",children:Y.summary?.totalCategories||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 발주 수:"}),e.jsx("span",{className:"ml-2 font-medium",children:Y.summary?.totalOrders||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 품목 수:"}),e.jsx("span",{className:"ml-2 font-medium",children:Y.summary?.totalItems||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 금액:"}),e.jsx("span",{className:"ml-2 font-medium",children:j(Math.floor(Y.summary?.totalAmount||0))})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"분류"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"발주 수"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"품목 수"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"총 수량"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"총 금액"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"평균 금액"})]})}),e.jsx("tbody",{children:Y.data?.map((s,t)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:s.category}),e.jsx("td",{className:"py-3 px-4 text-right",children:s.orderCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:s.itemCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:s.totalQuantity?.toLocaleString()}),e.jsx("td",{className:"py-3 px-4 text-right font-medium",children:j(Math.floor(s.totalAmount))}),e.jsx("td",{className:"py-3 px-4 text-right",children:j(Math.floor(s.averageAmount))})]},t))})]})})]}),n==="project"&&_&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"프로젝트별 발주 보고서"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 프로젝트 수:"}),e.jsx("span",{className:"ml-2 font-medium",children:_.summary?.totalProjects||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 발주 수:"}),e.jsx("span",{className:"ml-2 font-medium",children:_.summary?.totalOrders||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 금액:"}),e.jsx("span",{className:"ml-2 font-medium",children:j(Math.floor(_.summary?.totalAmount||0))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"프로젝트당 평균:"}),e.jsx("span",{className:"ml-2 font-medium",children:j(Math.floor(_.summary?.averagePerProject||0))})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"프로젝트명"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"프로젝트 코드"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"상태"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"발주 수"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"거래처 수"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"총 금액"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"평균 금액"})]})}),e.jsx("tbody",{children:_.data?.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:s.projectName}),e.jsx("td",{className:"py-3 px-4",children:s.projectCode}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.projectStatus==="active"?"bg-green-100 text-green-800":s.projectStatus==="completed"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.projectStatus==="active"?"진행중":s.projectStatus==="completed"?"완료":"대기"})}),e.jsx("td",{className:"py-3 px-4 text-right",children:s.orderCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:s.vendorCount}),e.jsx("td",{className:"py-3 px-4 text-right font-medium",children:j(Math.floor(s.totalAmount))}),e.jsx("td",{className:"py-3 px-4 text-right",children:j(Math.floor(s.averageOrderAmount))})]},s.projectId))})]})})]}),n==="vendor"&&I&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"거래처별 발주 보고서"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 거래처 수:"}),e.jsx("span",{className:"ml-2 font-medium",children:I.summary?.totalVendors||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 발주 수:"}),e.jsx("span",{className:"ml-2 font-medium",children:I.summary?.totalOrders||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"총 금액:"}),e.jsx("span",{className:"ml-2 font-medium",children:j(Math.floor(I.summary?.totalAmount||0))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"거래처당 평균:"}),e.jsx("span",{className:"ml-2 font-medium",children:j(Math.floor(I.summary?.averagePerVendor||0))})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"거래처명"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"거래처 코드"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"사업자번호"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"발주 수"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"프로젝트 수"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"총 금액"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"평균 금액"})]})}),e.jsx("tbody",{children:I.data?.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4",children:s.vendorName}),e.jsx("td",{className:"py-3 px-4",children:s.vendorCode}),e.jsx("td",{className:"py-3 px-4",children:s.businessNumber}),e.jsx("td",{className:"py-3 px-4 text-right",children:s.orderCount}),e.jsx("td",{className:"py-3 px-4 text-right",children:s.projectCount}),e.jsx("td",{className:"py-3 px-4 text-right font-medium",children:j(Math.floor(s.totalAmount))}),e.jsx("td",{className:"py-3 px-4 text-right",children:j(Math.floor(s.averageOrderAmount))})]},s.vendorId))})]})}),I.data?.length===1&&I.data[0].topItems?.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-md font-semibold mb-3",children:"주요 발주 품목"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 text-sm",children:"품목명"}),e.jsx("th",{className:"text-right py-2 text-sm",children:"수량"}),e.jsx("th",{className:"text-right py-2 text-sm",children:"금액"})]})}),e.jsx("tbody",{children:I.data[0].topItems.map((s,t)=>e.jsxs("tr",{className:"border-b last:border-0",children:[e.jsx("td",{className:"py-2 text-sm",children:s.itemName}),e.jsx("td",{className:"py-2 text-right text-sm",children:s.quantity}),e.jsx("td",{className:"py-2 text-right text-sm font-medium",children:j(Math.floor(s.amount))})]},t))})]})})]})]})]}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx("div",{className:"text-gray-500 text-lg mb-2",children:"검색 조건을 설정하고 검색 버튼을 클릭하세요"}),e.jsx("div",{className:"text-gray-400 text-sm",children:"효율적인 성능을 위해 검색 필터를 먼저 설정해주세요"})]})})]}),e.jsx(Fe,{open:X,onOpenChange:A,children:e.jsxs(Te,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ie,{children:e.jsxs(Re,{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),"보고서 생성"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"기본 정보"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(f,{htmlFor:"reportTitle",children:"보고서 제목"}),e.jsx(se,{id:"reportTitle",value:m.title,onChange:s=>g(t=>({...t,title:s.target.value})),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(f,{children:"선택된 데이터"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["총 ",c.size,"건의 발주 데이터가 선택되었습니다."]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5"}),"차트 옵션"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"statusChart",checked:m.includeCharts.statusDistribution,onCheckedChange:s=>g(t=>({...t,includeCharts:{...t.includeCharts,statusDistribution:!!s}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(f,{htmlFor:"statusChart",children:"상태별 분포"}),e.jsx("p",{className:"text-xs text-gray-600",children:"발주 상태별 통계 차트"})]}),m.includeCharts.statusDistribution&&e.jsxs(w,{value:m.chartTypes.statusDistribution,onValueChange:s=>g(t=>({...t,chartTypes:{...t.chartTypes,statusDistribution:s}})),children:[e.jsx(C,{className:"w-24",children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"pie",children:"파이"}),e.jsx(r,{value:"donut",children:"도넛"}),e.jsx(r,{value:"bar",children:"막대"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"monthlyChart",checked:m.includeCharts.monthlyTrend,onCheckedChange:s=>g(t=>({...t,includeCharts:{...t.includeCharts,monthlyTrend:!!s}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(f,{htmlFor:"monthlyChart",children:"월별 현황"}),e.jsx("p",{className:"text-xs text-gray-600",children:"월별 발주 추이 차트"})]}),m.includeCharts.monthlyTrend&&e.jsxs(w,{value:m.chartTypes.monthlyTrend,onValueChange:s=>g(t=>({...t,chartTypes:{...t.chartTypes,monthlyTrend:s}})),children:[e.jsx(C,{className:"w-24",children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"bar",children:"막대"}),e.jsx(r,{value:"line",children:"선형"}),e.jsx(r,{value:"area",children:"영역"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"vendorChart",checked:m.includeCharts.vendorAnalysis,onCheckedChange:s=>g(t=>({...t,includeCharts:{...t.includeCharts,vendorAnalysis:!!s}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(f,{htmlFor:"vendorChart",children:"거래처별 분석"}),e.jsx("p",{className:"text-xs text-gray-600",children:"거래처별 발주 통계"})]}),m.includeCharts.vendorAnalysis&&e.jsxs(w,{value:m.chartTypes.vendorAnalysis,onValueChange:s=>g(t=>({...t,chartTypes:{...t.chartTypes,vendorAnalysis:s}})),children:[e.jsx(C,{className:"w-24",children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"bar",children:"막대"}),e.jsx(r,{value:"horizontal",children:"가로막대"}),e.jsx(r,{value:"table",children:"테이블"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"amountChart",checked:m.includeCharts.amountAnalysis,onCheckedChange:s=>g(t=>({...t,includeCharts:{...t.includeCharts,amountAnalysis:!!s}}))}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(f,{htmlFor:"amountChart",children:"금액별 분석"}),e.jsx("p",{className:"text-xs text-gray-600",children:"발주 금액 분포 차트"})]}),m.includeCharts.amountAnalysis&&e.jsxs(w,{value:m.chartTypes.amountAnalysis,onValueChange:s=>g(t=>({...t,chartTypes:{...t.chartTypes,amountAnalysis:s}})),children:[e.jsx(C,{className:"w-24",children:e.jsx(D,{})}),e.jsxs(k,{children:[e.jsx(r,{value:"bar",children:"막대"}),e.jsx(r,{value:"histogram",children:"히스토그램"}),e.jsx(r,{value:"box",children:"박스플롯"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"보고서 내용"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(f,{htmlFor:"summary",children:"자동 생성된 요약"}),e.jsx(te,{id:"summary",value:m.summary,onChange:s=>g(t=>({...t,summary:s.target.value})),rows:4,className:"mt-1",placeholder:"데이터 기반 자동 요약이 여기에 표시됩니다..."})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"insights",children:"주요 인사이트"}),e.jsx(te,{id:"insights",value:m.insights,onChange:s=>g(t=>({...t,insights:s.target.value})),rows:3,className:"mt-1",placeholder:"데이터에서 발견한 주요 패턴이나 인사이트를 입력하세요..."})]}),e.jsxs("div",{children:[e.jsx(f,{htmlFor:"comments",children:"추가 코멘트"}),e.jsx(te,{id:"comments",value:m.comments,onChange:s=>g(t=>({...t,comments:s.target.value})),rows:2,className:"mt-1",placeholder:"추가적인 분석이나 권장사항을 입력하세요..."})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),"출력 옵션"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"includePdf",checked:m.outputOptions.includePdf,onCheckedChange:s=>g(t=>({...t,outputOptions:{...t.outputOptions,includePdf:!!s}}))}),e.jsx(f,{htmlFor:"includePdf",children:"PDF 다운로드"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"includeExcel",checked:m.outputOptions.includeExcel,onCheckedChange:s=>g(t=>({...t,outputOptions:{...t.outputOptions,includeExcel:!!s}}))}),e.jsx(f,{htmlFor:"includeExcel",children:"Excel 데이터 첨부"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{id:"sendEmail",checked:m.outputOptions.sendEmail,onCheckedChange:s=>g(t=>({...t,outputOptions:{...t.outputOptions,sendEmail:!!s}}))}),e.jsx(f,{htmlFor:"sendEmail",children:"이메일 전송"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx(F,{variant:"outline",onClick:()=>A(!1),children:"취소"}),e.jsxs(F,{onClick:Ce,className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),"미리보기 및 생성"]})]})]})]})}),G&&e.jsx(He,{config:m,orders:o?.orders?.filter(s=>c.has(s.id))||[],onClose:()=>H(!1)})]})}export{ls as default};
