import{e as G,r as x,bU as L,M as ue,J as C,c as he,d as pe,u as ye,H as q,K as S,j as e,N as V,O as be,I as w,B as $,F as Y,f as ve,m as ke,E as je}from"./index-CxN96faF.js";import{S as P,a as O,b as E,c as F,d as g}from"./select-BKH8vMf1.js";import{i as A}from"./authUtils-CcDzk6i0.js";import{E as fe}from"./email-send-dialog-CEBxmODP.js";import{E as Ne,a as we}from"./email-history-modal-rWr_iwUF.js";import{P as Ce}from"./PDFPreviewModal-3bHamP5O.js";import{S as De}from"./search-D8KmOjUZ.js";import{F as Se}from"./filter-CqsNJwjX.js";import{C as Pe}from"./chevron-up-CBKTm_7J.js";import{C as Oe}from"./chevron-down-B9iqE6B3.js";import{D as Ee}from"./download-xbT1eTu2.js";import{C as N}from"./chevrons-up-down-gMVpkQRW.js";import{S as Fe}from"./square-pen-B8JPU-bU.js";import{M as W}from"./mail-CoZ55rqa.js";import{S as Ie}from"./send-BlLvqeij.js";import"./index-CxV8Up4o.js";import"./dialog-DSPJ_9rD.js";import"./index-aAiXkidw.js";import"./textarea-DGjLALZg.js";import"./alert-adNDPU-2.js";import"./checkbox-CFaYHwrR.js";import"./triangle-alert-BYuXYzTr.js";import"./tabs-B8WNFYQS.js";import"./separator-Bu28nucb.js";import"./refresh-cw-D1LT9n6d.js";import"./format-XSPP9ZcP.js";import"./circle-x-YJzoaE3T.js";import"./paperclip-BILhToxC.js";import"./html2canvas.esm-Bep7g8EN.js";import"./printer-JqB2f0Nc.js";function Te(d={}){const v=G(),n=x.useMemo(()=>L.orders.optimized(d),[d]),a=ue({queryKey:n,queryFn:async()=>{const i=new URLSearchParams;Object.entries(d).forEach(([D,s])=>{s!==void 0&&s!==""&&s!=="all"&&s!==null&&i.append(D,s.toString())});const p=`/api/orders-optimized${i.toString()?`?${i}`:""}`;console.log("🚀 Fetching optimized orders:",p);const j=await C("GET",p);return console.log("✅ Optimized orders response:",{ordersCount:j.orders.length,total:j.total,queryTime:j.performance.queryTime}),j},staleTime:30*1e3,gcTime:5*60*1e3,refetchOnWindowFocus:!1,refetchOnMount:!0,retry:(i,p)=>p?.status>=400&&p?.status<500?!1:i<2}),k=()=>{if(a.data&&a.data.page<a.data.totalPages){const i={...d,page:a.data.page+1};v.prefetchQuery({queryKey:L.orders.optimized(i),queryFn:()=>C("GET",`/api/orders-optimized?${new URLSearchParams(i)}`),staleTime:30*1e3})}};return{...a,orders:a.data?.orders||[],vendors:a.data?.metadata.vendors||[],projects:a.data?.metadata.projects||[],users:a.data?.metadata.users||[],total:a.data?.total||0,page:a.data?.page||1,totalPages:a.data?.totalPages||1,performance:a.data?.performance,prefetchNextPage:k,hasNextPage:a.data?a.data.page<a.data.totalPages:!1,hasPreviousPage:a.data?a.data.page>1:!1}}function qe(d={}){const v=G(),n=Te(d);return{...n,prefetchRelatedData:()=>{v.prefetchQuery({queryKey:["orders-metadata"],queryFn:()=>C("GET","/api/orders-metadata"),staleTime:10*60*1e3}),n.hasNextPage&&n.prefetchNextPage(),v.prefetchQuery({queryKey:L.dashboard.unified(),staleTime:2*60*1e3})},isOptimized:!0,cacheHit:n.performance?.cacheHit||!1,queryTime:n.performance?.queryTime||"unknown"}}function vr(){he();const{toast:d}=pe(),[v,n]=ye(),[a,k]=x.useState({status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50,sortBy:"orderDate",sortOrder:"desc"}),[i,p]=x.useState(!1),[j,D]=x.useState(!1),[s,J]=x.useState(null),[_,X]=x.useState(!1),[I,Z]=x.useState(null),[ee,U]=x.useState(!1),[o,z]=x.useState(null);x.useEffect(()=>{const r=new URLSearchParams(window.location.search),t=r.get("status"),m=r.get("filter"),y=r.get("vendor"),l={page:1,status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",limit:50};if(t&&!m)l.status=t==="all"?"":t;else if(m==="monthly"){const b=new Date,u=b.getFullYear(),H=b.getMonth(),ie=new Date(u,H,1),ce=new Date(u,H+1,0),B=T=>{const ge=T.getFullYear(),me=String(T.getMonth()+1).padStart(2,"0"),xe=String(T.getDate()).padStart(2,"0");return`${ge}-${me}-${xe}`};l.startDate=B(ie),l.endDate=B(ce)}else if(m==="urgent"){const b=new Date,u=new Date;u.setDate(b.getDate()+7),l.startDate=b.toISOString().split("T")[0],l.endDate=u.toISOString().split("T")[0],l.status="approved"}y&&(l.vendorId=y),k(l)},[v]);const{orders:c,vendors:M,projects:re,users:ae,total:$e,page:Ae,totalPages:Le,hasNextPage:Ue,hasPreviousPage:ze,isLoading:te,error:Me,cacheHit:Re,queryTime:Ke,prefetchRelatedData:R}=qe(a);x.useEffect(()=>{R()},[R]),q({mutationFn:async({orderId:r,status:t})=>{await C("PUT",`/api/orders/${r}/status`,{status:t})},onSuccess:()=>{S.invalidateQueries({queryKey:["orders-optimized"],exact:!1}),S.invalidateQueries({queryKey:["/api/dashboard/unified"],exact:!1}),d({title:"성공",description:"발주서 상태가 변경되었습니다."})},onError:r=>{if(A(r)){d({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{n("/login")},500);return}d({title:"오류",description:"발주서 상태 변경에 실패했습니다.",variant:"destructive"})}}),q({mutationFn:async r=>{await C("DELETE",`/api/orders/${r}`)},onSuccess:()=>{S.invalidateQueries({queryKey:["orders-optimized"],exact:!1}),S.invalidateQueries({queryKey:["/api/dashboard/unified"],exact:!1}),d({title:"성공",description:"발주서가 삭제되었습니다."})},onError:r=>{if(A(r)){d({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{n("/login")},500);return}d({title:"오류",description:"발주서 삭제에 실패했습니다.",variant:"destructive"})}});const K=q({mutationFn:async()=>{const r=new URLSearchParams;Object.entries(a).forEach(([b,u])=>{u&&u!=="all"&&u!==""&&r.append(b,u.toString())});const t=await fetch(`/api/orders/export?${r}`,{credentials:"include"});if(!t.ok)throw new Error("Export failed");const m=await t.blob(),y=window.URL.createObjectURL(m),l=document.createElement("a");l.href=y,l.download="orders.xlsx",document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(y),document.body.removeChild(l)},onError:r=>{if(A(r)){d({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{n("/login")},500);return}d({title:"오류",description:"엑셀 다운로드에 실패했습니다.",variant:"destructive"})}}),h=(r,t)=>{const m=t==="all"?"":t;k(y=>({...y,[r]:m,page:1}))},f=r=>{k(t=>({...t,sortBy:r,sortOrder:t.sortBy===r&&t.sortOrder==="desc"?"asc":"desc",page:1}))},se=r=>{const t=c.find(m=>m.id===r.id);t&&(J(t),D(!0))},oe=async r=>{if(s)try{const t={orderNumber:s.orderNumber,vendorName:s.vendorName||s.vendor?.name||"",orderDate:s.orderDate,totalAmount:s.totalAmount,siteName:s.projectName||s.project?.projectName,filePath:s.filePath||""};await we.sendPurchaseOrderEmail(t,r),d({title:"이메일 발송 완료",description:`${s.vendor?.name}에게 발주서 ${s.orderNumber}를 전송했습니다.`})}catch(t){d({title:"이메일 발송 실패",description:t instanceof Error?t.message:"이메일 발송 중 오류가 발생했습니다.",variant:"destructive"})}},de=r=>{const t=c.find(m=>m.id===r.id);t&&(z(t),U(!0))};console.log("🔍 Orders Professional - orders data:",c),console.log("🔍 Orders Professional - first order:",c[0]),c[0]&&(console.log("🔍 Orders Professional - vendor info:",{vendor:c[0].vendor,vendorName:c[0].vendorName,vendorFromVendor:c[0].vendor?.name}),console.log("🔍 Orders Professional - project info:",{project:c[0].project,projectName:c[0].projectName,projectFromProject:c[0].project?.projectName}));const Q=c,ne=r=>!r.emailStatus||r.totalEmailsSent===0?e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"미발송"}):r.emailStatus==="sent"?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ie,{className:"h-3 w-3 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:"발송됨"})]}):r.emailStatus==="opened"?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(W,{className:"h-3 w-3 text-green-600 dark:text-green-400"}),e.jsx("span",{className:"text-xs text-green-600 dark:text-green-400",children:"열람됨"})]}):e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"미발송"}),le=r=>{switch(r){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-300 dark:bg-yellow-500/25 dark:text-yellow-200 dark:border-yellow-400/50";case"approved":return"bg-green-100 text-green-800 border-green-300 dark:bg-green-500/25 dark:text-green-200 dark:border-green-400/50";case"sent":return"bg-blue-100 text-blue-800 border-blue-300 dark:bg-blue-500/25 dark:text-blue-200 dark:border-blue-400/50";case"completed":return"bg-purple-100 text-purple-800 border-purple-300 dark:bg-purple-500/25 dark:text-purple-200 dark:border-purple-400/50";case"rejected":return"bg-red-100 text-red-800 border-red-300 dark:bg-red-500/25 dark:text-red-200 dark:border-red-400/50";default:return"bg-gray-100 text-gray-800 border-gray-300 dark:bg-gray-500/25 dark:text-gray-200 dark:border-gray-400/50"}};return e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-950",children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"발주서 관리"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:a.vendorId?`${M?.find(r=>r.id.toString()===a.vendorId)?.name||""} 거래처 발주서`:"전체 발주서를 조회하고 관리하세요"})]}),e.jsx("div",{className:"flex items-center gap-4"})]})}),e.jsx(V,{className:"mb-6 shadow-sm border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",style:{backgroundColor:"var(--card)",borderColor:"var(--border)"},children:e.jsxs(be,{className:"p-6 dark:text-gray-100",style:{color:"var(--card-foreground)"},children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative max-w-xl",children:[e.jsx(De,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-400 h-5 w-5"}),e.jsx(w,{placeholder:"발주번호, 품목명으로 검색...",value:a.searchText,onChange:r=>h("searchText",r.target.value),className:"pl-10 h-11 text-sm bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:border-blue-500 dark:focus:border-blue-400 focus:ring-2 focus:ring-blue-100 dark:focus:ring-blue-900",style:{backgroundColor:"var(--input)",color:"var(--foreground)",borderColor:"var(--border)"}})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-4",children:[e.jsxs(P,{value:a.status||"all",onValueChange:r=>h("status",r),children:[e.jsx(O,{className:"w-40 h-10 bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",style:{backgroundColor:"var(--secondary)",color:"var(--secondary-foreground)",borderColor:"var(--border)"},children:e.jsx(E,{placeholder:"상태 선택"})}),e.jsxs(F,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:[e.jsx(g,{value:"all",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"모든 상태"}),e.jsx(g,{value:"pending",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"승인 대기"}),e.jsx(g,{value:"approved",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"승인 완료"}),e.jsx(g,{value:"sent",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"발송 완료"}),e.jsx(g,{value:"completed",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"완료"}),e.jsx(g,{value:"rejected",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"반려"})]})]}),e.jsxs(P,{value:a.projectId||"all",onValueChange:r=>h("projectId",r),children:[e.jsx(O,{className:"w-48 h-10 bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",style:{backgroundColor:"var(--secondary)",color:"var(--secondary-foreground)",borderColor:"var(--border)"},children:e.jsx(E,{placeholder:"현장 선택"})}),e.jsxs(F,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:[e.jsx(g,{value:"all",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"모든 현장"}),re?.map(r=>e.jsx(g,{value:r.id.toString(),className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:r.projectName},r.id))]})]}),e.jsxs(P,{value:a.vendorId||"all",onValueChange:r=>h("vendorId",r),children:[e.jsx(O,{className:"w-48 h-10 bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",style:{backgroundColor:"var(--secondary)",color:"var(--secondary-foreground)",borderColor:"var(--border)"},children:e.jsx(E,{placeholder:"거래처 선택"})}),e.jsxs(F,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:[e.jsx(g,{value:"all",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"모든 거래처"}),M?.map(r=>e.jsx(g,{value:r.id.toString(),className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:r.name},r.id))]})]}),e.jsxs($,{variant:"outline",onClick:()=>p(!i),className:"h-10 px-4 bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),"고급 필터",i?e.jsx(Pe,{className:"h-4 w-4 ml-2"}):e.jsx(Oe,{className:"h-4 w-4 ml-2"})]}),e.jsxs("div",{className:"ml-auto flex gap-2",children:[Object.values(a).some(r=>r&&r!=="")&&e.jsx($,{variant:"ghost",size:"sm",onClick:()=>k({status:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50}),className:"h-10 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-gray-100",children:"필터 초기화"}),e.jsxs($,{variant:"outline",onClick:()=>K.mutate(),disabled:K.isPending,className:"h-10 bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"엑셀 다운로드"]})]})]}),i&&e.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"발주일 범위"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{type:"date",value:a.startDate,onChange:r=>h("startDate",r.target.value),className:"h-10 text-sm bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",style:{backgroundColor:"var(--input)",color:"var(--foreground)",borderColor:"var(--border)"}}),e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"~"}),e.jsx(w,{type:"date",value:a.endDate,onChange:r=>h("endDate",r.target.value),className:"h-10 text-sm bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",style:{backgroundColor:"var(--input)",color:"var(--foreground)",borderColor:"var(--border)"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"금액 범위"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{type:"number",placeholder:"최소 금액",value:a.minAmount,onChange:r=>h("minAmount",r.target.value),className:"h-10 text-sm bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",style:{backgroundColor:"var(--input)",color:"var(--foreground)",borderColor:"var(--border)"}}),e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:"~"}),e.jsx(w,{type:"number",placeholder:"최대 금액",value:a.maxAmount,onChange:r=>h("maxAmount",r.target.value),className:"h-10 text-sm bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",style:{backgroundColor:"var(--input)",color:"var(--foreground)",borderColor:"var(--border)"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 block",children:"작성자"}),e.jsxs(P,{value:a.userId||"all",onValueChange:r=>h("userId",r),children:[e.jsx(O,{className:"h-10 bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",style:{backgroundColor:"var(--secondary)",color:"var(--secondary-foreground)",borderColor:"var(--border)"},children:e.jsx(E,{placeholder:"모든 작성자"})}),e.jsxs(F,{className:"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:[e.jsx(g,{value:"all",className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:"모든 작성자"}),ae?.map(r=>e.jsx(g,{value:r.id,className:"dark:focus:bg-gray-700 dark:hover:bg-gray-700",children:r.name||r.email},r.id))]})]})]})]})})]})}),e.jsx(V,{className:"shadow-sm bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",children:e.jsx("div",{className:"overflow-x-auto",style:{backgroundColor:"var(--card)"},children:e.jsxs("table",{className:"w-full",style:{backgroundColor:"var(--card)"},children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>f("orderNumber"),className:"flex items-center gap-1 hover:text-gray-700 dark:hover:text-gray-100 transition-colors",children:["발주번호",e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>f("vendorName"),className:"flex items-center gap-1 hover:text-gray-700 dark:hover:text-gray-100 transition-colors",children:["거래처",e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>f("projectName"),className:"flex items-center gap-1 hover:text-gray-700 dark:hover:text-gray-200",children:["현장",e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>f("orderDate"),className:"flex items-center gap-1 hover:text-gray-700 dark:hover:text-gray-200",children:["발주일",e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>f("totalAmount"),className:"flex items-center gap-1 hover:text-gray-700 dark:hover:text-gray-200",children:["금액",e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:e.jsxs("button",{onClick:()=>f("status"),className:"flex items-center gap-1 hover:text-gray-700 dark:hover:text-gray-200",children:["상태",e.jsx(N,{className:"h-3 w-3"})]})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"이메일"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"액션"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",style:{backgroundColor:"var(--card)"},children:te?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-12 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 dark:border-blue-400"})})})}):Q.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-12 text-center",children:e.jsxs("div",{className:"text-gray-500 dark:text-gray-400",children:[e.jsx(Y,{className:"h-12 w-12 mx-auto mb-3 text-gray-300 dark:text-gray-600"}),e.jsx("p",{className:"text-sm",children:"발주서가 없습니다."})]})})}):Q.map(r=>e.jsxs("tr",{className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",style:{backgroundColor:"var(--card)"},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800",children:e.jsx("button",{onClick:()=>n(`/orders/${r.id}`),className:"text-sm font-medium text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:r.orderNumber})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800",children:[(r.vendorName||r.vendor?.name)&&(r.vendor?.id||r.vendorId)?e.jsx("button",{onClick:()=>n(`/vendors/${r.vendor?.id||r.vendorId}`),className:"text-sm font-medium text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:underline transition-colors",title:"거래처 상세 정보 보기",children:r.vendorName||r.vendor?.name}):e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:r.vendorName||r.vendor?.name||"-"}),r.vendor?.email&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.vendor.email})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800",children:[(r.projectName||r.project?.projectName)&&(r.project?.id||r.projectId)?e.jsx("button",{onClick:()=>n(`/projects/${r.project?.id||r.projectId}`),className:"text-sm font-medium text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:underline transition-colors",title:"현장 상세 정보 보기",children:r.projectName||r.project?.projectName}):e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:r.projectName||r.project?.projectName||"-"}),r.project?.projectCode&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r.project.projectCode})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800 text-sm text-gray-900 dark:text-gray-100",children:new Date(r.orderDate).toLocaleDateString("ko-KR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800",children:e.jsx("div",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:ve(r.totalAmount)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${le(r.status)}`,children:ke(r.status)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800",children:ne(r)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap bg-white dark:bg-gray-800 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx("button",{onClick:()=>n(`/orders/${r.id}`),className:"p-1.5 text-blue-500 hover:text-blue-700 hover:bg-blue-50 dark:text-blue-400 dark:hover:text-blue-300 dark:hover:bg-blue-900/20 rounded-md transition-all duration-200",title:"상세보기",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>n(`/orders/${r.id}/edit`),className:"p-1.5 text-green-500 hover:text-green-700 hover:bg-green-50 dark:text-green-400 dark:hover:text-green-300 dark:hover:bg-green-900/20 rounded-md transition-all duration-200",title:"수정",children:e.jsx(Fe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>de(r),className:"p-1.5 text-orange-500 hover:text-orange-700 hover:bg-orange-50 dark:text-orange-400 dark:hover:text-orange-300 dark:hover:bg-orange-900/20 rounded-md transition-all duration-200",title:"PDF 보기",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>se(r),className:"p-1.5 text-purple-500 hover:text-purple-700 hover:bg-purple-50 dark:text-purple-400 dark:hover:text-purple-300 dark:hover:bg-purple-900/20 rounded-md transition-all duration-200",title:"이메일 전송",children:e.jsx(W,{className:"h-4 w-4"})})]})})]},r.id))})]})})}),s&&e.jsx(fe,{open:j,onOpenChange:D,orderData:{orderNumber:s.orderNumber,vendorName:s.vendorName||s.vendor?.name||"",vendorEmail:s.vendor?.email,orderDate:new Date(s.orderDate).toLocaleDateString(),totalAmount:s.totalAmount,siteName:s.projectName||s.project?.projectName},onSendEmail:oe}),I&&e.jsx(Ne,{orderId:I.id,orderNumber:I.orderNumber,isOpen:_,onClose:()=>{X(!1),Z(null)}}),o&&e.jsx(Ce,{orderData:{id:o.id,orderNumber:o.orderNumber,projectName:o.projectName||o.project?.projectName,vendorName:o.vendorName||o.vendor?.name,totalAmount:o.totalAmount,orderDate:o.orderDate,deliveryDate:o.deliveryDate,status:o.status,filePath:o.filePath,items:o.items||[],notes:o.notes||o.remarks,createdBy:o.user?.name||o.createdBy},isOpen:ee,onClose:()=>{U(!1),z(null)},onDownload:r=>{const t=document.createElement("a");t.href=r,t.download=`발주서_${o.orderNumber}.pdf`,document.body.appendChild(t),t.click(),document.body.removeChild(t),d({title:"PDF 다운로드 완료",description:`발주서 ${o.orderNumber}의 PDF가 다운로드되었습니다.`})}})]})})}export{vr as default};
