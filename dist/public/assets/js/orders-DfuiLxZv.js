import{n as Se,j as e,S as _,g as Oe,R as B,o as P,I as G,B as j,p as He,F as Pe,a as fe,U as Ve,q as Re,i as De,s as he,u as Me,c as ze,r as $,f as Qe,T as se,t as oe,v as le,E as Ye,w as ne,x as ie,d as We,y as Ge,z as Xe,A as Je,D as Ze,G as er,H as me,J as ve,K as be}from"./index-BJXK4EC8.js";import{S as X,a as J,b as Z,c as ee,d as v}from"./select-Eg8tzUEN.js";import{M as $e,b as Ee,u as rr,a as tr,E as ar}from"./email-history-modal-DpJOAejZ.js";import{i as xe}from"./authUtils-CcDzk6i0.js";import{E as sr}from"./email-send-dialog-Ci5xG6S_.js";import{S as Ne}from"./search-D_PJbm7t.js";import{C as or}from"./chevrons-up-down-BEIFtaXs.js";import{C as Le}from"./chevron-up-BmR94US2.js";import{C as Fe}from"./chevron-down-CPEgYEnV.js";import{C as Y}from"./circle-check-Z1yvlTRT.js";import{S as qe}from"./send-Br2XjPrC.js";import{P as lr}from"./package-BrPiLKTW.js";import{C as je}from"./circle-x-BFgsPDTp.js";import{T as nr,M as ir}from"./trending-down-DuTkDEP2.js";import{T as dr}from"./trending-up-Dkgy-Mkj.js";import{C as Ae}from"./checkbox-DcefLmYm.js";import{D as cr,a as gr,b as ur,c as mr,d as br,e as xr}from"./dialog-C7aPrfzR.js";import{T as hr}from"./triangle-alert-DWsEOeXY.js";import{T as Be}from"./trash-2-C_vS9eM1.js";import{S as pr}from"./square-pen-WZ_jsXoC.js";import{M as yr}from"./mail-ntkB8NrZ.js";import{f as de}from"./format-DdLwavQ-.js";import{S as fr}from"./shopping-cart-3kdv4Chv.js";import{D as Ie}from"./download-BrX6C9S0.js";import{F as vr}from"./filter-DtLPPsuf.js";import"./index-CXakYd-p.js";import"./tabs-Bt1Rd8pV.js";import"./separator-CZws57Hf.js";import"./refresh-cw-Ddg07NFj.js";import"./paperclip-D2ACM-eM.js";import"./textarea-C-_oGICr.js";import"./alert-D59CLjBj.js";import"./index-C6Z6pKfJ.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=Se("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jr=Se("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kr=Se("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function Nr({rows:n=5,columns:g=6,showPagination:h=!0}){return e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden bg-white",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsx("tr",{children:Array.from({length:g}).map((k,s)=>e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsx(_,{className:"h-4 w-24"})},s))})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Array.from({length:n}).map((k,s)=>e.jsx("tr",{children:Array.from({length:g}).map((p,y)=>e.jsx("td",{className:"px-4 py-3",children:e.jsx(_,{className:"h-4 w-full max-w-xs"})},y))},s))})]})}),h&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(_,{className:"h-8 w-48"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-8 w-20"}),e.jsx(_,{className:"h-8 w-8"}),e.jsx(_,{className:"h-8 w-8"}),e.jsx(_,{className:"h-8 w-8"}),e.jsx(_,{className:"h-8 w-20"})]}),e.jsx(_,{className:"h-8 w-32"})]})]})}function wr({data:n,columns:g,searchable:h=!1,searchPlaceholder:k="검색...",showPagination:s=!1,pageSize:p=10,pageSizeOptions:y=[10,25,50,100],onRowClick:f,rowKey:t,emptyMessage:N="데이터가 없습니다",isLoading:E=!1,className:re,stickyHeader:ce=!1,maxHeight:D,sortBy:m,sortOrder:C,onSort:O}){const{theme:H,actualTheme:M}=Oe(),b=M==="dark"||H==="dark"||document.documentElement.classList.contains("dark"),U=`table-${b?"dark":"light"}-${Date.now()}`;B.useEffect(()=>(()=>{if(M==="dark"||H==="dark"||document.documentElement.classList.contains("dark")){const r=document.getElementById("enhanced-table-dark-override");r&&r.remove();const o=document.createElement("style");o.id="enhanced-table-dark-override",o.textContent=`
          /* ULTIMATE TABLE DARK MODE OVERRIDE */
          .dark-table-container table,
          [data-theme="dark"] .dark-table-container table,
          html.dark .dark-table-container table {
            background-color: rgb(31 41 55) !important;
            color: rgb(241 245 249) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody,
          [data-theme="dark"] .dark-table-container table tbody,
          html.dark .dark-table-container table tbody {
            background-color: rgb(31 41 55) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr,
          [data-theme="dark"] .dark-table-container table tbody tr,
          html.dark .dark-table-container table tbody tr {
            background-color: rgb(31 41 55) !important;
            color: rgb(241 245 249) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr:nth-child(even),
          [data-theme="dark"] .dark-table-container table tbody tr:nth-child(even),
          html.dark .dark-table-container table tbody tr:nth-child(even) {
            background-color: rgba(55 65 81, 0.7) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table tbody tr:hover,
          [data-theme="dark"] .dark-table-container table tbody tr:hover,
          html.dark .dark-table-container table tbody tr:hover {
            background-color: rgb(55 65 81) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container table thead,
          [data-theme="dark"] .dark-table-container table thead,
          html.dark .dark-table-container table thead {
            background-color: rgb(55 65 81) !important;
            forced-color-adjust: none !important;
          }
          
          .dark-table-container .table-wrapper-custom,
          [data-theme="dark"] .dark-table-container .table-wrapper-custom,
          html.dark .dark-table-container .table-wrapper-custom {
            background-color: rgb(31 41 55) !important;
            forced-color-adjust: none !important;
          }
        `,document.head.appendChild(o);const d=()=>{document.querySelectorAll(".dark-table-container table").forEach(T=>{T.style.setProperty("background-color","rgb(31 41 55)","important"),T.style.setProperty("forced-color-adjust","none","important");const I=T.querySelector("tbody");I&&(I.style.setProperty("background-color","rgb(31 41 55)","important"),I.querySelectorAll("tr").forEach((W,ae)=>{ae%2===0?W.style.setProperty("background-color","rgb(31 41 55)","important"):W.style.setProperty("background-color","rgba(55 65 81, 0.7)","important"),W.style.setProperty("forced-color-adjust","none","important")}));const te=T.querySelector("thead");te&&te.style.setProperty("background-color","rgb(55 65 81)","important");const ue=T.closest(".table-wrapper-custom");ue&&ue.style.setProperty("background-color","rgb(31 41 55)","important")})};d(),setTimeout(d,100);const S=new MutationObserver(()=>{d()});return S.observe(document.body,{childList:!0,subtree:!0}),()=>{S.disconnect();const u=document.getElementById("enhanced-table-dark-override");u&&u.remove()}}})(),[H,M,n]);const[K,V]=B.useState(""),[z,L]=B.useState(null),[F,Q]=B.useState(null),[w,a]=B.useState(1),[i,c]=B.useState(p),A=B.useMemo(()=>{if(!K)return n;const l=g.filter(x=>x.searchable!==!1);return n.filter(x=>l.some(r=>{const o=r.accessor?r.accessor(x):x[r.key];return o==null?!1:String(o).toLowerCase().includes(K.toLowerCase())}))},[n,K,g]),R=B.useMemo(()=>{if(O||!z||!F)return A;const l=g.find(x=>x.key===z);return l?[...A].sort((x,r)=>{const o=l.accessor?l.accessor(x):x[l.key],d=l.accessor?l.accessor(r):r[l.key];if(o==null)return 1;if(d==null)return-1;const S=o<d?-1:o>d?1:0;return F==="asc"?S:-S}):A},[A,z,F,g,O]),ge=B.useMemo(()=>{if(!s)return R;const l=(w-1)*i;return R.slice(l,l+i)},[R,w,i,s]),q=Math.ceil(R.length/i),pe=l=>{O?O(l):z===l?F==="asc"?Q("desc"):F==="desc"&&(Q(null),L(null)):(L(l),Q("asc"))},ye=l=>{const x=m||z,r=m===l?C:F;return x!==l?e.jsx(or,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"}):r==="asc"?e.jsx(Le,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}):e.jsx(Fe,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})};return E?e.jsx(Nr,{rows:i,columns:g.length,showPagination:s}):e.jsxs("div",{className:P("w-full dark-table-container",re),"data-theme":b?"dark":"light",style:{backgroundColor:b?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},children:[h&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 dark:text-gray-500"}),e.jsx(G,{placeholder:k,value:K,onChange:l=>{V(l.target.value),a(1)},className:"pl-10 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100"})]})}),e.jsx("div",{className:P("border rounded-lg overflow-hidden transition-colors table-wrapper-custom","border-gray-200 dark:border-gray-700"),style:{maxHeight:D,backgroundColor:b?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},"data-dark-table":b,children:e.jsxs("table",{className:P("w-full table-custom-dark",b&&"dark-table-forced"),style:{backgroundColor:b?"rgb(31 41 55)":"white",color:b?"rgb(241 245 249)":"rgb(17 24 39)",forcedColorAdjust:"none"},"data-theme":b?"dark":"light",children:[e.jsx("thead",{className:P("border-b transition-colors thead-custom","border-gray-200 dark:border-gray-600",ce&&"sticky top-0 z-10"),style:{backgroundColor:b?"rgb(55 65 81)":"rgb(249 250 251)",forcedColorAdjust:"none"},children:e.jsx("tr",{children:g.map(l=>e.jsx("th",{className:P("px-4 py-3 text-left text-xs font-medium uppercase tracking-wider transition-colors","text-gray-600 dark:text-gray-300",l.align==="center"&&"text-center",l.align==="right"&&"text-right",l.sortable!==!1&&"cursor-pointer select-none hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",l.className),style:{width:l.width},onClick:()=>l.sortable!==!1&&pe(String(l.key)),children:e.jsxs("div",{className:P("flex items-center gap-1",l.align==="center"&&"justify-center",l.align==="right"&&"justify-end"),children:[e.jsx("span",{children:l.header}),l.sortable!==!1&&ye(String(l.key))]})},String(l.key)))})}),e.jsx("tbody",{className:P("divide-y transition-colors tbody-custom","divide-gray-200 dark:divide-gray-700"),style:{backgroundColor:b?"rgb(31 41 55)":"white",forcedColorAdjust:"none"},children:ge.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:g.length,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400 td-custom-empty",style:{backgroundColor:b?"rgb(31 41 55)":"white",color:b?"rgb(156 163 175)":"rgb(107 114 128)",forcedColorAdjust:"none"},children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(Ne,{className:"h-12 w-12 text-gray-300 dark:text-gray-600 mb-3"}),e.jsx("p",{children:N})]})})}):ge.map((l,x)=>e.jsx("tr",{className:P("transition-colors tr-custom-row",f&&"cursor-pointer"),style:{backgroundColor:b?x%2===0?"rgb(31 41 55) !important":"rgba(55 65 81, 0.7) !important":x%2===0?"white !important":"rgb(249 250 251) !important",forcedColorAdjust:"none",transition:"background-color 0.2s ease"},onMouseEnter:r=>{b?r.currentTarget.style.backgroundColor="rgb(55 65 81) !important":r.currentTarget.style.backgroundColor="rgb(243 244 246) !important"},onMouseLeave:r=>{b?r.currentTarget.style.backgroundColor=x%2===0?"rgb(31 41 55) !important":"rgba(55 65 81, 0.7) !important":r.currentTarget.style.backgroundColor=x%2===0?"white !important":"rgb(249 250 251) !important"},onClick:()=>f?.(l),children:g.map(r=>e.jsx("td",{className:P("px-4 py-3 text-sm transition-colors td-custom","text-gray-900 dark:text-gray-100",r.align==="center"&&"text-center",r.align==="right"&&"text-right",r.className),style:{backgroundColor:"transparent !important",forcedColorAdjust:"none"},children:r.accessor?r.accessor(l):l[r.key]},String(r.key)))},t(l)))})]},U)}),s&&q>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"표시 개수:"}),e.jsxs(X,{value:String(i),onValueChange:l=>{c(Number(l)),a(1)},children:[e.jsx(J,{className:"w-20 h-8 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100",children:e.jsx(Z,{})}),e.jsx(ee,{className:"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600",children:y.map(l=>e.jsx(v,{value:String(l),className:"text-gray-900 dark:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700",children:l},l))})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>a(1),disabled:w===1,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"처음"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>a(l=>Math.max(1,l-1)),disabled:w===1,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"이전"}),e.jsx("div",{className:"flex items-center gap-1 mx-2",children:Array.from({length:Math.min(5,q)},(l,x)=>{let r;return q<=5||w<=3?r=x+1:w>=q-2?r=q-4+x:r=w-2+x,e.jsx(j,{variant:w===r?"default":"outline",size:"sm",onClick:()=>a(r),className:P("h-8 w-8 p-0",w===r?"bg-blue-600 dark:bg-blue-500 text-white dark:text-white border-blue-600 dark:border-blue-500":"bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700"),children:r},r)})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>a(l=>Math.min(q,l+1)),disabled:w===q,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"다음"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>a(q),disabled:w===q,className:"h-8 px-2 bg-white dark:bg-gray-800 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-gray-100 hover:bg-gray-50 dark:hover:bg-gray-700",children:"마지막"})]}),e.jsxs("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:["총 ",R.length,"개 중 ",(w-1)*i+1,"-",Math.min(w*i,R.length),"개"]})]})]})}const Sr=He("inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium transition-all duration-200 border",{variants:{variant:{default:"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600",primary:"bg-primary-50 text-primary-700 border-primary-200 dark:bg-primary-900/50 dark:text-primary-300 dark:border-primary-800",success:"bg-green-50 text-green-700 border-green-200 dark:bg-green-900/50 dark:text-green-300 dark:border-green-800",warning:"bg-yellow-50 text-yellow-700 border-yellow-200 dark:bg-yellow-900/50 dark:text-yellow-300 dark:border-yellow-800",danger:"bg-red-50 text-red-700 border-red-200 dark:bg-red-900/50 dark:text-red-300 dark:border-red-800",info:"bg-blue-50 text-blue-700 border-blue-200 dark:bg-blue-900/50 dark:text-blue-300 dark:border-blue-800",purple:"bg-purple-50 text-purple-700 border-purple-200 dark:bg-purple-900/50 dark:text-purple-300 dark:border-purple-800",outline:"bg-transparent border-current"},size:{sm:"text-xs px-2 py-0.5",md:"text-xs px-2.5 py-1",lg:"text-sm px-3 py-1.5"},pulse:{true:"animate-pulse",false:""},interactive:{true:"cursor-pointer hover:scale-105 active:scale-95",false:""}},defaultVariants:{variant:"default",size:"md",pulse:!1,interactive:!1}});function we({className:n,variant:g,size:h,pulse:k,interactive:s,icon:p,children:y,onRemove:f,animate:t=!0,...N}){return e.jsxs("div",{className:P(Sr({variant:g,size:h,pulse:k,interactive:s}),t&&"transition-all duration-200","group relative",n),...N,children:[p&&e.jsx(p,{className:"h-3 w-3 transition-transform duration-200 group-hover:scale-110"}),e.jsx("span",{className:"transition-colors duration-200",children:y}),f&&e.jsx("button",{onClick:E=>{E.stopPropagation(),f()},className:"ml-1 -mr-1 hover:bg-black/10 dark:hover:bg-white/10 rounded-full p-0.5 transition-all duration-200 hover:scale-110 active:scale-95 focus:outline-none focus:ring-2 focus:ring-current/20","aria-label":"뱃지 제거",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",className:"h-3 w-3 transition-transform duration-200",children:e.jsx("path",{d:"M5.28 4.22a.75.75 0 00-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 101.06 1.06L8 9.06l2.72 2.72a.75.75 0 101.06-1.06L9.06 8l2.72-2.72a.75.75 0 00-1.06-1.06L8 6.94 5.28 4.22z"})})})]})}function Cr({prevStatus:n,...g}){const[h,k]=B.useState(!1);return B.useEffect(()=>{if(n&&n!==g.children){k(!0);const s=setTimeout(()=>k(!1),500);return()=>clearTimeout(s)}},[n,g.children]),e.jsx(we,{...g,className:P(g.className,h&&"scale-110 shadow-lg")})}const Dr={order:{draft:{label:"임시저장",variant:"default",icon:Pe,pulse:!1,description:"작성 중인 발주서"},created:{label:"발주서 생성",variant:"info",icon:Y,pulse:!1,description:"발주서 생성 완료"},sent:{label:"발송완료",variant:"success",icon:qe,pulse:!1,description:"거래처에 발송 완료"},delivered:{label:"납품완료",variant:"success",icon:lr,pulse:!1,description:"납품 및 검수 완료"},pending:{label:"승인 대기",variant:"warning",icon:fe,pulse:!0,description:"승인자 검토 대기 중"},approved:{label:"승인됨",variant:"info",icon:Y,pulse:!1,description:"승인 완료됨"},completed:{label:"완료",variant:"success",icon:Y,pulse:!1,description:"발주 처리 완료"},rejected:{label:"반려됨",variant:"danger",icon:je,pulse:!1,description:"승인이 거부됨"},cancelled:{label:"취소됨",variant:"default",icon:kr,pulse:!1,description:"발주가 취소됨"}},approval:{not_required:{label:"승인불필요",variant:"default",icon:Y,pulse:!1,description:"승인 과정이 필요하지 않음"},pending:{label:"승인대기",variant:"warning",icon:fe,pulse:!0,description:"승인자 검토 대기 중"},approved:{label:"승인완료",variant:"success",icon:Y,pulse:!1,description:"승인이 완료됨"},rejected:{label:"반려",variant:"danger",icon:je,pulse:!1,description:"승인이 거부됨"}},user:{active:{label:"활성",variant:"success",icon:Ve,pulse:!1},inactive:{label:"비활성",variant:"default",icon:ke,pulse:!1},pending:{label:"승인 대기",variant:"warning",icon:fe,pulse:!0}},vendor:{active:{label:"활성",variant:"success",icon:Re,pulse:!1},inactive:{label:"비활성",variant:"default",icon:ke,pulse:!1},verified:{label:"검증됨",variant:"info",icon:Y,pulse:!1},unverified:{label:"미검증",variant:"warning",icon:De,pulse:!1}},project:{active:{label:"진행 중",variant:"primary",icon:jr,pulse:!1},completed:{label:"완료",variant:"success",icon:Y,pulse:!1},on_hold:{label:"보류",variant:"warning",icon:ke,pulse:!1},cancelled:{label:"취소",variant:"default",icon:je,pulse:!1}},priority:{low:{label:"낮음",variant:"default",icon:nr,pulse:!1},normal:{label:"보통",variant:"info",icon:ir,pulse:!1},high:{label:"높음",variant:"warning",icon:dr,pulse:!1},urgent:{label:"긴급",variant:"danger",icon:De,pulse:!0}}};function Te({type:n,status:g,showIcon:h=!0,showTooltip:k=!1,animated:s=!1,prevStatus:p,className:y,...f}){const t=Dr[n]?.[g];if(!t)return console.warn(`Unknown status "${g}" for type "${n}"`),e.jsx(we,{variant:"default",className:y,...f,children:g});const N=s?Cr:we,E=s?{prevStatus:p}:{};return e.jsxs("div",{className:"relative group",children:[e.jsx(N,{variant:t.variant,icon:h?t.icon:void 0,pulse:t.pulse,className:y,...E,...f,children:t.label}),k&&t.description&&e.jsxs("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-900 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:[t.description,e.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 border-4 border-transparent border-t-gray-900"})]})]})}function $r({open:n,onOpenChange:g,selectedOrders:h,onConfirm:k,isLoading:s=!1}){const p=()=>{k()},y=h.reduce((t,N)=>{const E=Number(N.totalAmount)||0;return console.log("💰 Processing order amount:",{orderId:N.id,orderNumber:N.orderNumber,totalAmount:N.totalAmount,parsed:E}),t+E},0),f=t=>new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0}).format(t);return e.jsx(cr,{open:n,onOpenChange:g,children:e.jsxs(gr,{className:"max-w-md",children:[e.jsx(ur,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-900/20 rounded-full",children:e.jsx(hr,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx(mr,{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"발주서 일괄 삭제"}),e.jsx(br,{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"선택된 발주서를 삭제하시겠습니까?"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-300",children:[e.jsx("strong",{children:"주의:"})," 삭제된 발주서는 복구할 수 없습니다."]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"선택된 발주서"}),e.jsxs(he,{variant:"destructive",className:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300",children:[h.length,"개"]})]}),e.jsxs("div",{className:"max-h-40 overflow-y-auto space-y-2 border border-gray-200 dark:border-gray-700 rounded-md p-3",children:[h.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:t.orderNumber}),t.vendorName&&e.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["(",t.vendorName,")"]})]}),e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:f(t.totalAmount)})]},t.id)),h.length>5&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center pt-2 border-t border-gray-200 dark:border-gray-600",children:["외 ",h.length-5,"개 더..."]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"총 금액"}),e.jsx("span",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:f(y)})]})]})]}),e.jsxs(xr,{className:"gap-2",children:[e.jsx(j,{variant:"outline",onClick:()=>g(!1),disabled:s,className:"text-gray-600 dark:text-gray-400",children:"취소"}),e.jsx(j,{variant:"destructive",onClick:p,disabled:s,className:"bg-red-600 hover:bg-red-700 text-white",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"삭제 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),h.length,"개 발주서 삭제"]})})]})]})})}function Er({orders:n,isLoading:g=!1,isBulkDeleting:h=!1,onStatusChange:k,onDelete:s,onBulkDelete:p,onEmailSend:y,onViewEmailHistory:f,onViewPdf:t,sortBy:N,sortOrder:E,onSort:re}){const[ce,D]=Me(),{user:m}=ze(),[C,O]=$.useState([]),[H,M]=$.useState(!1),b=m?.role==="admin",U=$.useCallback((a,i)=>{O(c=>i?[...c,a]:c.filter(A=>A!==a))},[]),K=$.useCallback(a=>{if(a){const i=n.filter(c=>c.status==="draft").map(c=>c.id);O(i)}else O([])},[n]),V=$.useCallback(()=>{C.length>0&&M(!0)},[C]),z=$.useCallback(()=>{p&&C.length>0&&(p(C),O([]),M(!1))},[p,C]),L=n.filter(a=>a.status==="draft"),F=L.length>0&&L.every(a=>C.includes(a.id));L.some(a=>C.includes(a.id)),console.log("🔍 EnhancedOrdersTable props:",{ordersCount:n.length,onEmailSend:!!y,onViewPdf:!!t,onViewEmailHistory:!!f,onBulkDelete:!!p,isAdmin:b,userRole:m?.role,userDetails:m?{id:m.id,name:m.name,email:m.email}:null,selectedOrderIds:C,draftOrdersCount:L.length,conditionCheck:b&&p});const Q=a=>{const i=f?()=>f(a):void 0;if(!a.emailStatus||a.totalEmailsSent===0)return e.jsx(he,{variant:"outline",className:`text-muted-foreground ${i?"cursor-pointer hover:bg-muted":""}`,onClick:i,children:"미발송"});const c={sent:{icon:qe,label:"발송됨",className:"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300",tooltip:a.lastSentAt?`최근 발송: ${de(new Date(a.lastSentAt),"yyyy.MM.dd HH:mm",{locale:ie})}`:""},opened:{icon:$e,label:"열람됨",className:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300",tooltip:a.openedAt?`열람 시간: ${de(new Date(a.openedAt),"yyyy.MM.dd HH:mm",{locale:ie})}`:""},clicked:{icon:$e,label:"클릭됨",className:"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300",tooltip:"링크 클릭됨"},failed:{icon:Ee,label:"실패",className:"bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-300",tooltip:"발송 실패"},bounced:{icon:Ee,label:"반송됨",className:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300",tooltip:"이메일 반송됨"}},A=c[a.emailStatus]||c.sent;return e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(le,{asChild:!0,children:e.jsxs(he,{variant:"secondary",className:`${A.className} ${i?"cursor-pointer hover:opacity-80":""}`,onClick:i,children:[A.label,a.totalEmailsSent&&a.totalEmailsSent>1&&e.jsxs("span",{className:"ml-1",children:["(",a.totalEmailsSent,")"]})]})}),A.tooltip&&e.jsxs(ne,{children:[e.jsx("p",{children:A.tooltip}),a.totalEmailsSent&&a.totalEmailsSent>1&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["총 ",a.totalEmailsSent,"회 발송"]}),i&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"클릭하여 상세 이력 보기"})]})]})})},w=[...b&&p?[{key:"select",header:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(Ae,{checked:F,onCheckedChange:K,disabled:L.length===0,"aria-label":"모든 발주서 선택"})}),width:"40px",accessor:a=>e.jsx("div",{className:"flex items-center justify-center",onClick:i=>i.stopPropagation(),children:e.jsx(Ae,{checked:C.includes(a.id),onCheckedChange:i=>U(a.id,i),disabled:a.status!=="draft","aria-label":`발주서 ${a.orderNumber} 선택`})})}]:[],{key:"orderNumber",header:"발주 번호",sortable:!0,searchable:!0,width:"130px",accessor:a=>e.jsx("div",{className:"font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 cursor-pointer",onClick:i=>{i.stopPropagation();try{typeof D=="function"?D(`/orders/${a.id}`):window.location.href=`/orders/${a.id}`}catch(c){console.error("Navigation error:",c),window.location.href=`/orders/${a.id}`}},children:a.orderNumber})},{key:"orderStatus",header:"발주상태",sortable:!0,width:"100px",accessor:a=>{const i=a.orderStatus||a.status||"draft";return e.jsx(Te,{type:"order",status:i,showIcon:!1,showTooltip:!0,animated:!0,size:"sm"})}},{key:"approvalStatus",header:"승인상태",sortable:!0,width:"100px",accessor:a=>!a.approvalStatus||a.approvalStatus==="not_required"?e.jsx("span",{className:"text-xs text-gray-400",children:"-"}):e.jsx(Te,{type:"approval",status:a.approvalStatus,showIcon:!1,showTooltip:!0,animated:!0,size:"sm"})},{key:"emailStatus",header:"이메일",sortable:!0,width:"90px",accessor:a=>Q(a)},{key:"projectName",header:"현장",sortable:!0,searchable:!0,width:"160px",accessor:a=>e.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:a.projectName||"-"})},{key:"vendorName",header:"거래처",sortable:!0,searchable:!0,width:"140px",accessor:a=>e.jsx("div",{className:"text-gray-900 dark:text-gray-100",children:a.vendorName&&a.vendorId?e.jsx("div",{className:"font-medium text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 cursor-pointer hover:underline",onClick:i=>{i.stopPropagation();try{typeof D=="function"?D(`/vendors/${a.vendorId}`):window.location.href=`/vendors/${a.vendorId}`}catch(c){console.error("Navigation error:",c),window.location.href=`/vendors/${a.vendorId}`}},title:"거래처 상세 정보 보기",children:a.vendorName}):e.jsx("span",{children:a.vendorName||"-"})})},{key:"totalAmount",header:"금액",sortable:!0,align:"right",width:"120px",accessor:a=>e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:Qe(a.totalAmount)})},{key:"orderDate",header:"발주일",sortable:!0,width:"100px",accessor:a=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:de(new Date(a.orderDate),"yyyy.MM.dd",{locale:ie})})},{key:"createdAt",header:"등록일",sortable:!0,width:"130px",accessor:a=>e.jsx("div",{className:"text-gray-500 dark:text-gray-500 text-xs",children:de(new Date(a.createdAt),"yyyy.MM.dd HH:mm",{locale:ie})})},{key:"deliveryDate",header:"납기일",sortable:!0,width:"110px",accessor:a=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:a.deliveryDate?de(new Date(a.deliveryDate),"yyyy.MM.dd",{locale:ie}):"-"})},{key:"userName",header:"요청자",sortable:!0,searchable:!0,width:"120px",accessor:a=>e.jsx("div",{className:"text-gray-600 dark:text-gray-400 text-sm",children:a.userName||"-"})},{key:"actions",header:"액션",width:"160px",align:"center",accessor:a=>e.jsxs("div",{className:"flex items-center justify-center gap-1",onClick:i=>i.stopPropagation(),children:[e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(le,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600 dark:hover:bg-blue-900/20",onClick:()=>{try{typeof D=="function"?D(`/orders/${a.id}`):window.location.href=`/orders/${a.id}`}catch{window.location.href=`/orders/${a.id}`}},children:e.jsx(Ye,{className:"h-4 w-4"})})}),e.jsx(ne,{children:e.jsx("p",{children:"상세 보기"})})]})}),e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(le,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-green-50 hover:text-green-600 dark:hover:bg-green-900/20",onClick:()=>{try{typeof D=="function"?D(`/orders/${a.id}/edit`):window.location.href=`/orders/${a.id}/edit`}catch{window.location.href=`/orders/${a.id}/edit`}},children:e.jsx(pr,{className:"h-4 w-4"})})}),e.jsx(ne,{children:e.jsx("p",{children:"수정"})})]})}),e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(le,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-orange-50 hover:text-orange-600 dark:hover:bg-orange-900/20",onClick:()=>{t&&t(a)},children:e.jsx(Pe,{className:"h-4 w-4"})})}),e.jsx(ne,{children:e.jsx("p",{children:"PDF 보기"})})]})}),e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(le,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-purple-50 hover:text-purple-600 dark:hover:bg-purple-900/20 border border-purple-200",onClick:()=>{console.log("🔍 이메일 버튼 클릭됨",{row:a,onEmailSend:!!y}),y?y(a):alert("이메일 전송 기능이 설정되지 않았습니다.")},style:{backgroundColor:"rgba(147, 51, 234, 0.1)"},children:e.jsx(yr,{className:"h-4 w-4 text-purple-600"})})}),e.jsx(ne,{children:e.jsx("p",{children:"이메일 전송 (Debug)"})})]})})]})}];return e.jsxs("div",{className:"space-y-4",children:[b&&p&&C.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:[C.length,"개의 발주서가 선택됨"]}),e.jsx(he,{variant:"outline",className:"text-blue-600 border-blue-300",children:"임시저장 상태만 삭제 가능"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>O([]),className:"text-gray-600 dark:text-gray-400",children:"선택 해제"}),e.jsxs(j,{variant:"destructive",size:"sm",onClick:V,className:"bg-red-600 hover:bg-red-700 text-white",children:[e.jsx(Be,{className:"h-4 w-4 mr-2"}),"선택된 발주서 삭제"]})]})]}),e.jsx(wr,{data:n,columns:w,searchable:!0,searchPlaceholder:"발주 번호, 프로젝트, 거래처, 요청자로 검색...",showPagination:!0,pageSize:20,pageSizeOptions:[10,20,50,100],onRowClick:a=>{try{typeof D=="function"?D(`/orders/${a.id}`):window.location.href=`/orders/${a.id}`}catch{window.location.href=`/orders/${a.id}`}},rowKey:a=>a.id,emptyMessage:"등록된 발주서가 없습니다",isLoading:g,stickyHeader:!0,maxHeight:"calc(100vh - 300px)",className:"shadow-sm",sortBy:N,sortOrder:E,onSort:re}),e.jsx($r,{open:H,onOpenChange:M,selectedOrders:n.filter(a=>C.includes(a.id)),onConfirm:z,isLoading:h})]})}function dt(){ze();const{toast:n}=We(),[g,h]=Me(),{theme:k}=Oe(),s=k==="dark",{connected:p,subscribeToOrder:y,unsubscribeFromOrder:f}=Ge();$.useEffect(()=>{console.log("🔍 Orders Page Theme Debug:",{theme:k,isDarkMode:s,htmlClass:document.documentElement.className,bodyClass:document.body.className})},[k,s]);const[t,N]=$.useState({status:"",orderStatus:"",approvalStatus:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50,sortBy:"orderDate",sortOrder:"desc"}),[E,re]=$.useState(!1),[ce,D]=$.useState(!1),[m,C]=$.useState(null),[O,H]=$.useState(!1),[M,b]=$.useState(null);$.useEffect(()=>{const r=new URLSearchParams(window.location.search),o=r.get("status"),d=r.get("filter"),S=r.get("vendor"),u={page:1,status:"",orderStatus:"",approvalStatus:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",limit:50};if(o&&!d)u.status=o==="all"?"":o;else if(d==="monthly"){const T=new Date,I=T.getFullYear(),te=T.getMonth(),ue=new Date(I,te,1),Ce=new Date(I,te+1,0),W=ae=>{const Ue=ae.getFullYear(),Ke=String(ae.getMonth()+1).padStart(2,"0"),_e=String(ae.getDate()).padStart(2,"0");return`${Ue}-${Ke}-${_e}`};u.startDate=W(ue),u.endDate=W(Ce)}else if(d==="urgent"){const T=new Date,I=new Date;I.setDate(T.getDate()+7),u.startDate=T.toISOString().split("T")[0],u.endDate=I.toISOString().split("T")[0],u.orderStatus="created",u.approvalStatus="approved"}S&&(u.vendorId=S),N(u)},[g]);const{data:U,isLoading:K}=Xe(t),{data:V}=Je(),{data:z}=Ze(),{data:L}=er(),{data:F}=rr();$.useEffect(()=>{if(U?.orders&&p)return U.orders.forEach(r=>{y(r.id)}),()=>{U.orders.forEach(r=>{f(r.id)})}},[U?.orders,p,y,f]);const Q=me({mutationFn:async({orderId:r,status:o})=>{await ve("PUT",`/api/orders/${r}/status`,{status:o})},onSuccess:()=>{be.invalidateQueries({predicate:r=>r.queryKey.some(d=>d==="/api/orders-optimized"||d==="orders-optimized"||typeof d=="string"&&d.includes("orders"))}),n({title:"성공",description:"발주서 상태가 변경되었습니다."})},onError:r=>{if(xe(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{h("/login")},500);return}n({title:"오류",description:"발주서 상태 변경에 실패했습니다.",variant:"destructive"})}}),w=me({mutationFn:async r=>{await ve("DELETE",`/api/orders/${r}`)},onSuccess:()=>{be.invalidateQueries({predicate:r=>r.queryKey.some(d=>d==="/api/orders-optimized"||d==="orders-optimized"||typeof d=="string"&&d.includes("orders"))}),n({title:"성공",description:"발주서가 삭제되었습니다."})},onError:r=>{if(xe(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{h("/login")},500);return}n({title:"오류",description:"발주서 삭제에 실패했습니다.",variant:"destructive"})}}),a=me({mutationFn:async r=>{console.log("🗑️ Bulk delete request:",{orderIds:r,parsedIds:r.map(o=>parseInt(o,10))}),await ve("DELETE","/api/orders/bulk",{orderIds:r.map(o=>parseInt(o,10))})},onSuccess:async(r,o)=>{await be.invalidateQueries({predicate:d=>d.queryKey.some(u=>u==="/api/orders-optimized"||u==="orders-optimized"||typeof u=="string"&&u.includes("orders"))}),await be.refetchQueries({predicate:d=>d.queryKey.some(u=>u==="/api/orders-optimized"||u==="orders-optimized")}),n({title:"성공",description:`${o.length}개의 발주서가 삭제되었습니다.`})},onError:r=>{if(xe(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{h("/login")},500);return}if(r?.response?.data?.nonDeletableOrders){const d=r.response.data.nonDeletableOrders.map(S=>S.orderNumber).join(", ");n({title:"일부 발주서 삭제 불가",description:`다음 발주서들은 임시저장 상태가 아니어서 삭제할 수 없습니다: ${d}`,variant:"destructive"})}else n({title:"오류",description:r?.response?.data?.message||"발주서 일괄 삭제에 실패했습니다.",variant:"destructive"})}}),i=me({mutationFn:async()=>{const r=new URLSearchParams;Object.entries(t).forEach(([T,I])=>{I&&I!=="all"&&I!==""&&r.append(T,I.toString())});const o=await fetch(`/api/orders/export?${r}`,{credentials:"include"});if(!o.ok)throw new Error("Export failed");const d=await o.blob(),S=window.URL.createObjectURL(d),u=document.createElement("a");u.href=S,u.download="orders.xlsx",document.body.appendChild(u),u.click(),window.URL.revokeObjectURL(S),document.body.removeChild(u)},onError:r=>{if(xe(r)){n({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{h("/login")},500);return}n({title:"오류",description:"엑셀 다운로드에 실패했습니다.",variant:"destructive"})}}),c=(r,o)=>{const d=o==="all"?"":o;N(S=>({...S,[r]:d,page:1}))},A=r=>{N(o=>({...o,sortBy:r,sortOrder:o.sortBy===r&&o.sortOrder==="desc"?"asc":"desc",page:1}))},R=r=>{const o=l.find(d=>d.id===r.id);o&&(C(o),D(!0))},ge=async r=>{if(m)try{const o={orderNumber:m.orderNumber,vendorName:m.vendor?.name||"",orderDate:m.orderDate,totalAmount:m.totalAmount,siteName:m.project?.projectName,filePath:m.filePath||""};await ar.sendPurchaseOrderEmail(o,r),n({title:"이메일 발송 완료",description:`${m.vendor?.name}에게 발주서 ${m.orderNumber}를 전송했습니다.`})}catch(o){n({title:"이메일 발송 실패",description:o instanceof Error?o.message:"이메일 발송 중 오류가 발생했습니다.",variant:"destructive"})}},q=r=>{const o=l.find(d=>d.id===r.id);o&&(b(o),H(!0))},pe=r=>{const o=l.find(d=>d.id===r.id);o&&(o.filePath?window.open(`/api/orders/${o.id}/download`,"_blank"):n({title:"PDF 생성 중",description:"발주서 PDF를 생성하고 있습니다. 잠시 후 다시 시도해주세요."}))},ye=r=>{a.mutate(r)},l=U?.orders||[],x=l.map(r=>{const o=F?.find(d=>d.id===r.id);return{...r,emailStatus:o?.email_status||null,lastSentAt:o?.last_sent_at||null,totalEmailsSent:o?.total_emails_sent||0,openedAt:o?.opened_at||null}});return console.log("🔍 Orders Page - ordersData:",U),console.log("🔍 Orders Page - orders array:",l),console.log("🔍 Orders Page - first order:",l[0]),console.log("🔍 Orders Page - emailStatusData:",F),console.log("🔍 Orders Page - isLoading:",K),console.log("🔍 Orders Page - filters:",t),e.jsx("div",{className:`min-h-screen transition-colors ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${s?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(fr,{className:`h-6 w-6 transition-colors ${s?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${s?"text-white":"text-gray-900"}`,children:"발주서 관리"}),t.vendorId&&t.vendorId!==""?e.jsxs("p",{className:`text-sm font-medium mt-1 transition-colors ${s?"text-blue-400":"text-blue-600"}`,children:[Array.isArray(V)?V.find(r=>r.id.toString()===t.vendorId)?.name:"거래처"," 거래처 발주서"]}):e.jsx("p",{className:`text-sm mt-1 transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"전체 발주서를 조회하고 관리하세요"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.vendorId&&t.vendorId!==""&&e.jsx(j,{variant:"outline",size:"sm",onClick:()=>c("vendorId",""),className:`transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"전체 발주서 보기"}),e.jsxs(j,{onClick:()=>i.mutate(),disabled:i.isPending,variant:"outline",size:"sm",className:`transition-colors ${s?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),i.isPending?"내보내는 중...":"엑셀 다운로드"]})]})]})})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"space-y-3 mb-3",children:e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-end gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:`text-sm font-medium block mb-2 transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"검색"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 transition-colors ${s?"text-gray-500":"text-gray-400"}`}),e.jsx(G,{placeholder:"발주번호, 거래처명으로 검색...",value:t.searchText,onChange:r=>c("searchText",r.target.value),className:`pl-10 h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.searchText?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]}),e.jsxs("div",{className:"w-full xl:w-72",children:[e.jsx("label",{className:`text-sm font-medium block mb-2 transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"현장"}),e.jsxs(X,{value:t.projectId||"all",onValueChange:r=>c("projectId",r),children:[e.jsx(J,{className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.projectId&&t.projectId!==""?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(Z,{placeholder:"모든 현장"})}),e.jsxs(ee,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(v,{value:"all",children:"모든 현장"}),z?.map(r=>e.jsxs(v,{value:r.id.toString(),children:[r.projectName," (",r.projectCode,")"]},r.id))]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(j,{variant:"outline",onClick:()=>re(!E),className:`flex items-center gap-2 h-11 text-sm px-4 rounded-lg transition-colors ${s?"border-gray-600 text-gray-200 hover:bg-gray-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,size:"sm",children:[e.jsx(vr,{className:"h-4 w-4"}),"고급 필터",E?e.jsx(Le,{className:"h-4 w-4"}):e.jsx(Fe,{className:"h-4 w-4"})]})})]})}),E&&e.jsx("div",{className:`border-t pt-6 mt-4 transition-colors ${s?"border-gray-600":"border-gray-200"}`,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2 xl:col-span-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"금액 범위"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{type:"number",placeholder:"최소금액",value:t.minAmount,onChange:r=>c("minAmount",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.minAmount?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`}),e.jsx("span",{className:`text-sm transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:"~"}),e.jsx(G,{type:"number",placeholder:"최대금액",value:t.maxAmount,onChange:r=>c("maxAmount",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.maxAmount?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"발주일 범위"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(G,{type:"date",value:t.startDate,onChange:r=>c("startDate",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.startDate?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`}),e.jsx("span",{className:`text-sm transition-colors ${s?"text-gray-500":"text-gray-400"}`,children:"~"}),e.jsx(G,{type:"date",value:t.endDate,onChange:r=>c("endDate",r.target.value),className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.endDate?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"거래처"}),e.jsxs(X,{value:t.vendorId||"all",onValueChange:r=>c("vendorId",r),children:[e.jsx(J,{className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.vendorId&&t.vendorId!==""?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(Z,{placeholder:"모든 거래처"})}),e.jsxs(ee,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(v,{value:"all",children:"모든 거래처"}),Array.isArray(V)?V.map(r=>e.jsx(v,{value:r.id.toString(),children:r.name},r.id)):null]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"발주 상태"}),e.jsxs(X,{value:t.orderStatus||"all",onValueChange:r=>c("orderStatus",r),children:[e.jsx(J,{className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.orderStatus&&t.orderStatus!==""?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(Z,{placeholder:"모든 발주상태"})}),e.jsxs(ee,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(v,{value:"all",children:"모든 발주상태"}),e.jsx(v,{value:"draft",children:"임시저장"}),e.jsx(v,{value:"created",children:"생성됨"}),e.jsx(v,{value:"sent",children:"발송됨"}),e.jsx(v,{value:"delivered",children:"납품완료"}),e.jsx(v,{value:"cancelled",children:"취소됨"})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"승인 상태"}),e.jsxs(X,{value:t.approvalStatus||"all",onValueChange:r=>c("approvalStatus",r),children:[e.jsx(J,{className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.approvalStatus&&t.approvalStatus!==""?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(Z,{placeholder:"모든 승인상태"})}),e.jsxs(ee,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(v,{value:"all",children:"모든 승인상태"}),e.jsx(v,{value:"not_required",children:"승인불필요"}),e.jsx(v,{value:"pending",children:"승인대기"}),e.jsx(v,{value:"approved",children:"승인완료"}),e.jsx(v,{value:"rejected",children:"반려"})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:`text-sm font-medium transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"작성자"}),e.jsxs(X,{value:t.userId||"all",onValueChange:r=>c("userId",r),children:[e.jsx(J,{className:`h-11 text-sm rounded-lg transition-colors ${s?"bg-gray-700 border-gray-600 text-gray-100":"bg-white border-gray-300"} ${t.userId&&t.userId!==""?`${s?"border-blue-400 bg-blue-900/20":"border-blue-500 bg-blue-50"}`:""}`,children:e.jsx(Z,{placeholder:"모든 작성자"})}),e.jsxs(ee,{className:`transition-colors ${s?"bg-gray-800 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx(v,{value:"all",children:"모든 작성자"}),Array.isArray(L)?L.map(r=>e.jsx(v,{value:r.id,children:r.name||r.email},r.id)):null]})]})]})})]})}),e.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-center justify-between gap-3 pt-4 mt-4 border-t transition-colors ${s?"border-gray-600":"border-gray-200"}`,children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:(t.projectId!==""||t.vendorId!==""||t.userId!==""||t.orderStatus!==""||t.approvalStatus!==""||t.startDate||t.endDate||t.minAmount||t.maxAmount||t.searchText)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`text-xs font-medium transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"적용된 필터:"}),t.searchText&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${s?"bg-blue-900/20 text-blue-300 border-blue-700":"bg-blue-50 text-blue-700 border-blue-200"}`,children:['검색: "',t.searchText,'"',e.jsx("button",{onClick:()=>c("searchText",""),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${s?"hover:bg-blue-800 text-blue-400":"hover:bg-blue-100 text-blue-600"}`,children:"×"})]}),t.projectId&&t.projectId!=="all"&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${s?"bg-gray-800 text-gray-300 border-gray-600":"bg-gray-50 text-gray-700 border-gray-200"}`,children:["현장: ",Array.isArray(z)&&z.find(r=>r.id.toString()===t.projectId)?.projectName||"선택된 현장",e.jsx("button",{onClick:()=>c("projectId","all"),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${s?"hover:bg-gray-700 text-gray-400":"hover:bg-gray-100 text-gray-600"}`,children:"×"})]}),t.orderStatus&&t.orderStatus!==""&&t.orderStatus!=="all"&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${s?"bg-indigo-900/20 text-indigo-300 border-indigo-700":"bg-indigo-50 text-indigo-700 border-indigo-200"}`,children:["발주상태: ",t.orderStatus==="draft"?"임시저장":t.orderStatus==="created"?"생성됨":t.orderStatus==="sent"?"발송됨":t.orderStatus==="delivered"?"납품완료":t.orderStatus==="cancelled"?"취소됨":t.orderStatus,e.jsx("button",{onClick:()=>c("orderStatus",""),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${s?"hover:bg-indigo-800 text-indigo-400":"hover:bg-indigo-100 text-indigo-600"}`,children:"×"})]}),t.approvalStatus&&t.approvalStatus!==""&&t.approvalStatus!=="all"&&e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs border transition-colors ${s?"bg-green-900/20 text-green-300 border-green-700":"bg-green-50 text-green-700 border-green-200"}`,children:["승인상태: ",t.approvalStatus==="not_required"?"승인불필요":t.approvalStatus==="pending"?"승인대기":t.approvalStatus==="approved"?"승인완료":t.approvalStatus==="rejected"?"반려":t.approvalStatus,e.jsx("button",{onClick:()=>c("approvalStatus",""),className:`ml-2 rounded-full w-4 h-4 flex items-center justify-center transition-colors ${s?"hover:bg-green-800 text-green-400":"hover:bg-green-100 text-green-600"}`,children:"×"})]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[(t.projectId!==""||t.vendorId!==""||t.userId!==""||t.orderStatus!==""||t.approvalStatus!==""||t.startDate||t.endDate||t.minAmount||t.maxAmount||t.searchText)&&e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{N({status:"",orderStatus:"",approvalStatus:"",vendorId:"",projectId:"",userId:"",startDate:"",endDate:"",minAmount:"",maxAmount:"",searchText:"",page:1,limit:50,sortBy:"orderDate",sortOrder:"desc"})},className:`h-9 text-sm px-4 rounded-lg transition-colors ${s?"border-gray-600 hover:bg-gray-800":"border-gray-300 hover:bg-gray-50"}`,children:"필터 초기화"}),e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>i.mutate(),disabled:i.isPending,className:`h-9 text-sm px-4 rounded-lg transition-colors ${s?"border-gray-600 hover:bg-gray-800":"border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(Ie,{className:"h-4 w-4 mr-2"}),i.isPending?"내보내는 중...":"엑셀 다운로드"]})]})]})]})}),e.jsx("div",{className:`shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx(Er,{orders:x.map(r=>{const o={...r,vendorName:r.vendor?.name||r.vendorName,vendorId:r.vendor?.id||r.vendorId,projectName:r.project?.projectName||r.projectName,userName:r.user?.name||r.userName};return console.log("🔍 Mapped order:",o),o}),isLoading:K,isBulkDeleting:a.isPending,onStatusChange:(r,o)=>Q.mutate({orderId:r,status:o}),onDelete:r=>w.mutate(r),onBulkDelete:ye,onEmailSend:R,onViewEmailHistory:q,onViewPdf:pe,sortBy:t.sortBy,sortOrder:t.sortOrder,onSort:A})}),m&&e.jsx(sr,{open:ce,onOpenChange:D,orderData:{orderNumber:m.orderNumber,vendorName:m.vendor?.name||"",vendorEmail:m.vendor?.email,orderDate:new Date(m.orderDate).toLocaleDateString(),totalAmount:m.totalAmount,siteName:m.project?.projectName},onSendEmail:ge}),M&&e.jsx(tr,{orderId:M.id,orderNumber:M.orderNumber,isOpen:O,onClose:()=>{H(!1),b(null)}})]})})}export{dt as default};
