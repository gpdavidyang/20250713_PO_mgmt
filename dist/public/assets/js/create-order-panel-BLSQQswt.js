import{a as I,j as e}from"./chunk-D67rGsji.js";import{r as h}from"./chunk-BgLp_VvL.js";import{C as _,r as Te,u as re}from"./chunk-BQGzsyED.js";import{B as u,C as j,h as L,i as A,g as p,L as i,I as G}from"./chunk-DV-F1ehd.js";import{S as y,h as v,i as f,j as b,k as w,D as O,m as B,a as k,b as F,c as U,f as Me}from"./chunk-bdHBeqB0.js";import{P as W,a as J,b as Q}from"./chunk-D-mEonCb.js";import{B as Ve}from"./chunk-Bw5QEQRA.js";import{aB as X,au as ie,B as ce,W as Y,ay as Ie,a8 as ne,z as ee,az as se,I as Oe,aA as Be,aC as ke,ac as Fe}from"./chunk-CVirgo2y.js";import"./chunk-CZez8RVl.js";import"./chunk-CFxRDIMf.js";class Ue{constructor(r){this.data=r}getCellReference(r){const l=r.match(/([A-Z]+)(\d+)/);if(!l)return 0;const d=this.columnToIndex(l[1]),c=parseInt(l[2])-1;if(c<0||c>=this.data.length||d<0||d>=this.data[c].length)return 0;const x=this.data[c][d].value;return typeof x=="number"?x:parseFloat(x)||0}columnToIndex(r){let l=0;for(let d=0;d<r.length;d++)l=l*26+(r.charCodeAt(d)-64);return l-1}evaluate(r){try{return r=r.replace(/^=/,"").trim(),r.includes("SUM(")?this.evaluateSum(r):(r=r.replace(/[A-Z]+\d+/g,l=>this.getCellReference(l).toString()),this.evaluateArithmetic(r))}catch(l){return console.error("Formula evaluation error:",l),0}}evaluateSum(r){const l=r.match(/SUM\(([^)]+)\)/i);if(!l)return 0;const c=l[1].trim().match(/([A-Z]+\d+):([A-Z]+\d+)/i);if(c){const x=c[1].toUpperCase(),g=c[2].toUpperCase();return this.sumRange(x,g)}return 0}sumRange(r,l){const d=r.match(/([A-Z]+)(\d+)/),c=l.match(/([A-Z]+)(\d+)/);if(!d||!c)return 0;const x=this.columnToIndex(d[1]),g=parseInt(d[2])-1,$=this.columnToIndex(c[1]),E=parseInt(c[2])-1;let D=0;for(let S=g;S<=E;S++)for(let C=x;C<=$;C++)if(S>=0&&S<this.data.length&&C>=0&&C<this.data[S].length){const t=this.data[S][C].value;D+=typeof t=="number"?t:parseFloat(t)||0}return D}evaluateArithmetic(r){try{return Function(`"use strict"; return (${r})`)()}catch(l){return console.error("Arithmetic evaluation error:",l),0}}}function $e({onImageUpload:R}){const[r,l]=h.useState(null),d=c=>{const x=c.target.files?.[0];if(x){const g=URL.createObjectURL(x);l(g),R(x)}};return e.jsxs(O,{children:[e.jsx(B,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(ke,{className:"h-4 w-4"})})}),e.jsxs(k,{children:[e.jsx(F,{children:e.jsx(U,{children:"형상 이미지 업로드"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Fe,{className:"w-8 h-8 mb-4 text-gray-500"}),e.jsx("p",{className:"mb-2 text-sm text-gray-500",children:e.jsx("span",{className:"font-semibold",children:"클릭하여 업로드"})}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG 파일 (최대 10MB)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:d})]})}),r&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:r,alt:"미리보기",className:"w-full h-32 object-cover rounded-lg"})})]})]})]})}function Je(){const[R,r]=h.useState("input"),[l,d]=h.useState(null),[c,x]=h.useState([]),[g,$]=h.useState(""),[E,D]=h.useState(!1),[S,C]=h.useState({}),[t,m]=h.useState({siteName:"",materialReceiver:"",headOfficeManager:"",specialNotes:"",panel:{deliveryDate:"",supplier:"",deliveryLocation:""},assembly:{deliveryDate:"",supplier:"",deliveryLocation:""},installation:{deliveryDate:"",supplier:"",deliveryLocation:""}}),[de,me]=h.useState([]),[xe,oe]=h.useState([]),[he,je]=h.useState([]),{data:pe=[]}=I({queryKey:["/api/projects"]}),{data:ae=[]}=I({queryKey:["/api/users"]}),{data:ue=[]}=I({queryKey:["/api/vendors"]}),{data:ge=[]}=I({queryKey:["/api/companies"]}),Ne=[...pe.map(s=>s.projectName),"기본 프로젝트 A","기본 프로젝트 B"],ye=[...ae.map(s=>s.name),...xe,"기본 인수자 A","기본 인수자 B"],ve=[...ae.map(s=>s.name),...he,"기본 담당자 A","기본 담당자 B"],P=[...ue.map(s=>s.name),"기본 거래처 A","기본 거래처 B"],z=[...ge.map(s=>s.companyName),...de,"기본 납품처 A","기본 납품처 B"],fe=s=>{me(a=>[...a,s])},be=s=>{oe(a=>[...a,s])},we=s=>{je(a=>[...a,s])},le=()=>{r("input")},Se=()=>{const s=new Date().toISOString();d({projectSettings:t,spreadsheetData:c,fileName:g,timestamp:s}),r("pdf-preview")},Ce=s=>{const a=s.target.files?.[0];if(!a)return;D(!0),$(a.name);const n=new FileReader;n.onload=N=>{try{const o=new Uint8Array(N.target?.result),T=Te(o,{type:"array"}),Le=T.SheetNames[0],te=T.Sheets[Le],M=re.decode_range(te["!ref"]||"A1:A1"),K=[];for(let Z=M.s.r;Z<=M.e.r;Z++){const H=[];for(let q=M.s.c;q<=M.e.c;q++){const Ae=re.encode_cell({r:Z,c:q}),V=te[Ae];if(V){const Re={value:V.v,formula:V.f,displayValue:V.v};H.push(Re)}else H.push({value:"",displayValue:""})}K.push(H)}x(K),setTimeout(()=>De(K),100)}catch(o){console.error("Error parsing Excel file:",o),alert("파일을 읽는 중 오류가 발생했습니다.")}finally{D(!1)}},n.readAsArrayBuffer(a)},De=h.useCallback(s=>{const a=new Ue(s),n=s.map(N=>N.map(o=>{if(o.formula&&o.formula.startsWith("=")){const T=a.evaluate(o.formula);return{...o,displayValue:T}}return{...o,displayValue:o.displayValue!==void 0?o.displayValue:o.value}}));x(n)},[]);return R==="pdf-preview"&&l?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"판넬 발주서 미리보기"}),e.jsx("p",{className:"text-sm text-gray-600",children:"저장된 발주서 내용을 확인하고 최종 제출하세요."})]})]}),e.jsxs(u,{onClick:le,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"수정하기"]})]}),e.jsxs(j,{className:"hover:shadow-md transition-shadow",children:[e.jsx(L,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(ce,{className:"h-5 w-5 text-blue-600"}),"현장 정보"]})}),e.jsxs(p,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"현장명"}),e.jsx("p",{className:"text-sm font-semibold",children:l.projectSettings.siteName})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"자재 인수자"}),e.jsx("p",{className:"text-sm font-semibold",children:l.projectSettings.materialReceiver})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"본사 담당자"}),e.jsx("p",{className:"text-sm font-semibold",children:l.projectSettings.headOfficeManager})]})]}),l.projectSettings.specialNotes&&e.jsxs("div",{className:"mt-4",children:[e.jsx(i,{className:"text-sm font-medium text-gray-600",children:"특이사항"}),e.jsx("p",{className:"text-sm",children:l.projectSettings.specialNotes})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(j,{className:"border-green-200",children:[e.jsx(L,{className:"bg-green-50",children:e.jsx(A,{className:"text-green-700 text-sm",children:"판넬 공정"})}),e.jsx(p,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"납품희망일"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.panel.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"거래처"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.panel.supplier})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"납품처"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.panel.deliveryLocation})]})]})})]}),e.jsxs(j,{className:"border-blue-200",children:[e.jsx(L,{className:"bg-blue-50",children:e.jsx(A,{className:"text-blue-700 text-sm",children:"조립 공정"})}),e.jsx(p,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"납품희망일"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.assembly.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"거래처"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.assembly.supplier})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"납품처"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.assembly.deliveryLocation})]})]})})]}),e.jsxs(j,{className:"border-purple-200",children:[e.jsx(L,{className:"bg-purple-50",children:e.jsx(A,{className:"text-purple-700 text-sm",children:"설치 공정"})}),e.jsx(p,{className:"pt-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"납품희망일"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.installation.deliveryDate})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"거래처"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.installation.supplier})]}),e.jsxs("div",{children:[e.jsx(i,{className:"text-xs text-gray-600",children:"납품처"}),e.jsx("p",{className:"text-sm font-medium",children:l.projectSettings.installation.deliveryLocation})]})]})})]})]}),e.jsxs(j,{className:"hover:shadow-md transition-shadow",children:[e.jsx(L,{children:e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5 text-green-600"}),"발주 품목 목록"]})}),e.jsxs(p,{children:[e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["파일명: ",l.fileName]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsx("tr",{children:l.spreadsheetData[0]?.map((s,a)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+a)},a))})}),e.jsx("tbody",{children:l.spreadsheetData.slice(0,10).map((s,a)=>e.jsx("tr",{className:"border-t",children:s.map((n,N)=>e.jsx("td",{className:"px-3 py-2 border-r",children:n.displayValue||n.value||""},N))},a))})]}),l.spreadsheetData.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... 그 외 ",l.spreadsheetData.length-10,"개 행"]})]})]})]}),e.jsxs("div",{className:"flex justify-center gap-4 pt-6",children:[e.jsxs(u,{onClick:le,variant:"outline",size:"lg",className:"flex items-center gap-2 px-6",children:[e.jsx(ie,{className:"h-4 w-4"}),"이전 단계"]}),e.jsxs(u,{size:"lg",className:"flex items-center gap-2 px-8 bg-green-600 hover:bg-green-700",onClick:()=>{alert("판넬 발주서가 성공적으로 제출되었습니다!")},children:[e.jsx(Ie,{className:"h-4 w-4"}),"최종 제출"]})]})]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(X,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900 leading-tight",children:"판넬 발주서"}),e.jsx("p",{className:"text-sm text-gray-600",children:"판넬 공정 전용 발주서를 작성하고 관리합니다."})]}),e.jsx("div",{className:"ml-auto",children:e.jsx(Ve,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"실험적 기능"})})]}),e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ne,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"발주서 기본 정보"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"프로젝트 명"}),e.jsxs(y,{value:t.siteName,onValueChange:s=>m(a=>({...a,siteName:s})),children:[e.jsx(v,{className:`h-10 ${t.siteName?"border-blue-500 bg-blue-50":""}`,children:e.jsx(f,{placeholder:"현장을 선택하세요"})}),e.jsx(b,{children:Ne.map(s=>e.jsx(w,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"자재 인수자"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{value:t.materialReceiver,onValueChange:s=>m(a=>({...a,materialReceiver:s})),children:[e.jsx(v,{className:`h-10 ${t.materialReceiver?"border-blue-500 bg-blue-50":""}`,children:e.jsx(f,{placeholder:"인수자 선택"})}),e.jsx(b,{children:ye.map(s=>e.jsx(w,{value:s,children:s},s))})]}),e.jsxs(O,{children:[e.jsx(B,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(k,{children:[e.jsx(F,{children:e.jsx(U,{children:"새 자재 인수자 추가"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(G,{placeholder:"자재 인수자 이름",onKeyDown:s=>{if(s.key==="Enter"){const a=s.currentTarget.value.trim();a&&(be(a),m(n=>({...n,materialReceiver:a})),s.currentTarget.value="")}}})})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"본사 담당자"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{value:t.headOfficeManager,onValueChange:s=>m(a=>({...a,headOfficeManager:s})),children:[e.jsx(v,{className:`h-10 ${t.headOfficeManager?"border-blue-500 bg-blue-50":""}`,children:e.jsx(f,{placeholder:"담당자 선택"})}),e.jsx(b,{children:ve.map(s=>e.jsx(w,{value:s,children:s},s))})]}),e.jsxs(O,{children:[e.jsx(B,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(k,{children:[e.jsx(F,{children:e.jsx(U,{children:"새 본사 담당자 추가"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(G,{placeholder:"본사 담당자 이름",onKeyDown:s=>{if(s.key==="Enter"){const a=s.currentTarget.value.trim();a&&(we(a),m(n=>({...n,headOfficeManager:a})),s.currentTarget.value="")}}})})]})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"특이사항"}),e.jsx(Me,{placeholder:"특이사항을 입력하세요...",value:t.specialNotes,onChange:s=>m(a=>({...a,specialNotes:s.target.value})),className:"h-20"})]})]})]})}),e.jsx(j,{className:"hover:shadow-md transition-shadow border-green-200",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(X,{className:"h-5 w-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"판넬 공정"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"납품희망일"}),e.jsxs(W,{children:[e.jsx(J,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${t.panel.deliveryDate?"border-green-500 bg-green-50":""}`,children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),t.panel.deliveryDate||"날짜 선택"]})}),e.jsx(Q,{className:"w-auto p-0",align:"start",children:e.jsx(_,{mode:"single",selected:t.panel.deliveryDate?new Date(t.panel.deliveryDate):void 0,onSelect:s=>m(a=>({...a,panel:{...a.panel,deliveryDate:s?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"거래처"}),e.jsxs(y,{value:t.panel.supplier,onValueChange:s=>m(a=>({...a,panel:{...a.panel,supplier:s}})),children:[e.jsx(v,{className:`h-10 ${t.panel.supplier?"border-green-500 bg-green-50":""}`,children:e.jsx(f,{placeholder:"거래처 선택"})}),e.jsx(b,{children:P.map(s=>e.jsx(w,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"납품처"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{value:t.panel.deliveryLocation,onValueChange:s=>m(a=>({...a,panel:{...a.panel,deliveryLocation:s}})),children:[e.jsx(v,{className:`h-10 ${t.panel.deliveryLocation?"border-green-500 bg-green-50":""}`,children:e.jsx(f,{placeholder:"납품처 선택"})}),e.jsx(b,{children:z.map(s=>e.jsx(w,{value:s,children:s},s))})]}),e.jsxs(O,{children:[e.jsx(B,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"sm",className:"h-10 w-10 p-0",children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsxs(k,{children:[e.jsx(F,{children:e.jsx(U,{children:"새 납품처 추가"})}),e.jsx("div",{className:"space-y-4",children:e.jsx(G,{placeholder:"납품처 이름",onKeyDown:s=>{if(s.key==="Enter"){const a=s.currentTarget.value.trim();a&&(fe(a),m(n=>({...n,panel:{...n.panel,deliveryLocation:a}})),s.currentTarget.value="")}}})})]})]})]})]})]})]})}),e.jsx(j,{className:"hover:shadow-md transition-shadow border-blue-200",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ne,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"조립 공정"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"납품희망일"}),e.jsxs(W,{children:[e.jsx(J,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${t.assembly.deliveryDate?"border-blue-500 bg-blue-50":""}`,children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),t.assembly.deliveryDate||"날짜 선택"]})}),e.jsx(Q,{className:"w-auto p-0",align:"start",children:e.jsx(_,{mode:"single",selected:t.assembly.deliveryDate?new Date(t.assembly.deliveryDate):void 0,onSelect:s=>m(a=>({...a,assembly:{...a.assembly,deliveryDate:s?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"거래처"}),e.jsxs(y,{value:t.assembly.supplier,onValueChange:s=>m(a=>({...a,assembly:{...a.assembly,supplier:s}})),children:[e.jsx(v,{className:`h-10 ${t.assembly.supplier?"border-blue-500 bg-blue-50":""}`,children:e.jsx(f,{placeholder:"거래처 선택"})}),e.jsx(b,{children:P.map(s=>e.jsx(w,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"납품처"}),e.jsxs(y,{value:t.assembly.deliveryLocation,onValueChange:s=>m(a=>({...a,assembly:{...a.assembly,deliveryLocation:s}})),children:[e.jsx(v,{className:`h-10 ${t.assembly.deliveryLocation?"border-blue-500 bg-blue-50":""}`,children:e.jsx(f,{placeholder:"납품처 선택"})}),e.jsx(b,{children:z.map(s=>e.jsx(w,{value:s,children:s},s))})]})]})]})]})}),e.jsx(j,{className:"hover:shadow-md transition-shadow border-purple-200",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ce,{className:"h-5 w-5 text-purple-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"설치 공정"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"납품희망일"}),e.jsxs(W,{children:[e.jsx(J,{asChild:!0,children:e.jsxs(u,{variant:"outline",className:`h-10 w-full justify-start text-left font-normal ${t.installation.deliveryDate?"border-purple-500 bg-purple-50":""}`,children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),t.installation.deliveryDate||"날짜 선택"]})}),e.jsx(Q,{className:"w-auto p-0",align:"start",children:e.jsx(_,{mode:"single",selected:t.installation.deliveryDate?new Date(t.installation.deliveryDate):void 0,onSelect:s=>m(a=>({...a,installation:{...a.installation,deliveryDate:s?.toISOString().split("T")[0]||""}})),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"거래처"}),e.jsxs(y,{value:t.installation.supplier,onValueChange:s=>m(a=>({...a,installation:{...a.installation,supplier:s}})),children:[e.jsx(v,{className:`h-10 ${t.installation.supplier?"border-purple-500 bg-purple-50":""}`,children:e.jsx(f,{placeholder:"거래처 선택"})}),e.jsx(b,{children:P.map(s=>e.jsx(w,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"text-sm font-medium text-gray-700",children:"납품처"}),e.jsxs(y,{value:t.installation.deliveryLocation,onValueChange:s=>m(a=>({...a,installation:{...a.installation,deliveryLocation:s}})),children:[e.jsx(v,{className:`h-10 ${t.installation.deliveryLocation?"border-purple-500 bg-purple-50":""}`,children:e.jsx(f,{placeholder:"납품처 선택"})}),e.jsx(b,{children:z.map(s=>e.jsx(w,{value:s,children:s},s))})]})]})]})]})}),e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Y,{className:"h-5 w-5 text-green-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Excel 파일 업로드"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(Oe,{className:"w-8 h-8 mb-4 text-gray-500"}),e.jsxs("p",{className:"mb-2 text-sm text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"클릭하여 업로드"})," 또는 드래그 앤 드롭"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Excel 파일 (.xlsx, .xls)"})]}),e.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls",onChange:Ce})]})}),E&&e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx("div",{className:"text-sm text-gray-600",children:"파일을 처리하고 있습니다..."})}),g&&e.jsxs("div",{className:"text-sm text-gray-600",children:["업로드된 파일: ",e.jsx("span",{className:"font-medium",children:g})]})]})]})}),c.length>0&&e.jsx(j,{className:"hover:shadow-md transition-shadow",children:e.jsxs(p,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Y,{className:"h-5 w-5 text-blue-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"데이터 미리보기"})]}),e.jsxs("div",{className:"border rounded-lg overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[c[0]?.map((s,a)=>e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700 border-r",children:String.fromCharCode(65+a)},a)),e.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"형상"})]})}),e.jsx("tbody",{children:c.slice(0,10).map((s,a)=>e.jsxs("tr",{className:"border-t",children:[s.map((n,N)=>e.jsx("td",{className:"px-3 py-2 border-r",children:n.displayValue||n.value||""},N)),e.jsx("td",{className:"px-3 py-2",children:e.jsx($e,{onImageUpload:n=>{C(N=>({...N,[a]:n}))}})})]},a))})]}),c.length>10&&e.jsxs("div",{className:"p-3 text-center text-sm text-gray-500 bg-gray-50",children:["... 그 외 ",c.length-10,"개 행"]})]})]})}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsxs(u,{onClick:Se,className:"flex items-center gap-2 px-6 bg-green-600 hover:bg-green-700",disabled:!t.siteName||!t.materialReceiver,children:[e.jsx(Be,{className:"h-4 w-4"}),"저장하고 다음 단계로"]})})]})}export{Je as default};
