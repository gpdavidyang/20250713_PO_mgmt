import{j as n,u as te,a as re,b as A,o as se,r as ne,c as oe,d as ae,F as ie,C as le,z as j,e as ce}from"./chunk-D67rGsji.js";import{r as i,b as de}from"./chunk-BgLp_VvL.js";import{c as V,t as ue}from"./chunk-CZez8RVl.js";import{u as me}from"./chunk-CFxRDIMf.js";import{B as fe,E as pe,a as he,L as xe}from"./chunk-CVirgo2y.js";const ye=1,ge=1e6;let w=0;function ve(){return w=(w+1)%Number.MAX_SAFE_INTEGER,w.toString()}const N=new Map,D=e=>{if(N.has(e))return;const t=setTimeout(()=>{N.delete(e),x({type:"REMOVE_TOAST",toastId:e})},ge);N.set(e,t)},be=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,ye)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?D(r):e.toasts.forEach(s=>{D(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===r||r===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},y=[];let g={toasts:[]};function x(e){g=be(g,e),y.forEach(t=>{t(g)})}function je({...e}){const t=ve(),r=o=>x({type:"UPDATE_TOAST",toast:{...o,id:t}}),s=()=>x({type:"DISMISS_TOAST",toastId:t});return x({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:o=>{o||s()}}}),{id:t,dismiss:s,update:r}}function we(){const[e,t]=i.useState(g);return i.useEffect(()=>(y.push(t),()=>{const r=y.indexOf(t);r>-1&&y.splice(r,1)}),[e]),{...e,toast:je,dismiss:r=>x({type:"DISMISS_TOAST",toastId:r})}}function O(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function k(...e){return t=>{let r=!1;const s=e.map(o=>{const a=O(o,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let o=0;o<s.length;o++){const a=s[o];typeof a=="function"?a():O(e[o],null)}}}}function qe(...e){return i.useCallback(k(...e),e)}function L(e){const t=Ne(e),r=i.forwardRef((s,o)=>{const{children:a,...c}=s,l=i.Children.toArray(a),d=l.find(Se);if(d){const u=d.props.children,f=l.map(p=>p===d?i.Children.count(u)>1?i.Children.only(null):i.isValidElement(u)?u.props.children:null:p);return n.jsx(t,{...c,ref:o,children:i.isValidElement(u)?i.cloneElement(u,void 0,f):null})}return n.jsx(t,{...c,ref:o,children:a})});return r.displayName=`${e}.Slot`,r}var $=L("Slot");function Ne(e){const t=i.forwardRef((r,s)=>{const{children:o,...a}=r;if(i.isValidElement(o)){const c=Ee(o),l=Ce(a,o.props);return o.type!==i.Fragment&&(l.ref=s?k(s,c):c),i.cloneElement(o,l)}return i.Children.count(o)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var W=Symbol("radix.slottable");function ze(e){const t=({children:r})=>n.jsx(n.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=W,t}function Se(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===W}function Ce(e,t){const r={...t};for(const s in t){const o=e[s],a=t[s];/^on[A-Z]/.test(s)?o&&a?r[s]=(...l)=>{a(...l),o(...l)}:o&&(r[s]=o):s==="style"?r[s]={...o,...a}:s==="className"&&(r[s]=[o,a].filter(Boolean).join(" "))}return{...e,...r}}function Ee(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Fe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Te=Fe.reduce((e,t)=>{const r=L(`Primitive.${t}`),s=i.forwardRef((o,a)=>{const{asChild:c,...l}=o,d=c?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(d,{...l,ref:a})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function Ue(e,t){e&&de.flushSync(()=>e.dispatchEvent(t))}const P=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,_=V,K=(e,t)=>r=>{var s;if(t?.variants==null)return _(e,r?.class,r?.className);const{variants:o,defaultVariants:a}=t,c=Object.keys(o).map(u=>{const f=r?.[u],p=a?.[u];if(f===null)return null;const h=P(f)||P(p);return o[u][h]}),l=r&&Object.entries(r).reduce((u,f)=>{let[p,h]=f;return h===void 0||(u[p]=h),u},{}),d=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((u,f)=>{let{class:p,className:h,...Z}=f;return Object.entries(Z).every(ee=>{let[R,b]=ee;return Array.isArray(b)?b.includes({...a,...l}[R]):{...a,...l}[R]===b})?[...u,p,h]:u},[]);return _(e,c,d,r?.class,r?.className)};function m(...e){return ue(V(e))}function He(e){if(!e||e===null)return"₩0";const t=typeof e=="string"?parseFloat(e.replace(/[^\d.-]/g,"")):e;return isNaN(t)?"₩0":new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(t)}function Ge(e){if(!e)return 0;const t=parseFloat(e.replace(/[^\d.-]/g,""));return isNaN(t)?0:t}function Je(e){const t=new Date(e);return isNaN(t.getTime())?"":new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}).format(t)}const B=i.createContext(null);function Xe({children:e}){const t=te(),{data:r,error:s,isLoading:o}=re({queryKey:["/api/auth/user"],queryFn:async()=>{const l=await fetch("/api/auth/user",{credentials:"include"});if(!l.ok){if(l.status===401)return null;throw new Error("Failed to get user")}const d=await l.json();return console.log("🔍 useAuth - Fetched user data:",d),d},retry:!1,staleTime:0,refetchOnWindowFocus:!0,refetchOnMount:!0,refetchOnReconnect:!0,refetchInterval:!1}),a=A({mutationFn:async l=>{const d=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(l)});if(!d.ok){const u=await d.json();throw new Error(u.message||"Login failed")}return await d.json()},onSuccess:l=>{t.setQueryData(["/api/auth/user"],l),t.invalidateQueries({queryKey:["/api/auth/user"]})}}),c=A({mutationFn:async()=>{if(!(await fetch("/api/auth/logout",{method:"POST",credentials:"include"})).ok)throw new Error("Logout failed")},onSuccess:()=>{t.setQueryData(["/api/auth/user"],null),t.clear()},onError:()=>{t.setQueryData(["/api/auth/user"],null),t.clear()}});return n.jsx(B.Provider,{value:{user:r??null,isLoading:o,isAuthenticated:!!r,error:s,loginMutation:a,logoutMutation:c},children:e})}function Ie(){const e=i.useContext(B);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}var Re=function(e,t){for(var r={};e.length;){var s=e[0],o=s.code,a=s.message,c=s.path.join(".");if(!r[c])if("unionErrors"in s){var l=s.unionErrors[0].errors[0];r[c]={message:l.message,type:l.code}}else r[c]={message:a,type:o};if("unionErrors"in s&&s.unionErrors.forEach(function(f){return f.errors.forEach(function(p){return e.push(p)})}),t){var d=r[c].types,u=d&&d[s.code];r[c]=oe(c,t,r,o,u?[].concat(u,s.message):s.message)}e.shift()}return r},Ae=function(e,t,r){return r===void 0&&(r={}),function(s,o,a){try{return Promise.resolve(function(c,l){try{var d=Promise.resolve(e[r.mode==="sync"?"parse":"parseAsync"](s,t)).then(function(u){return a.shouldUseNativeValidation&&se({},a),{errors:{},values:r.raw?s:u}})}catch(u){return l(u)}return d&&d.then?d.then(void 0,l):d}(0,function(c){if(function(l){return Array.isArray(l?.errors)}(c))return{values:{},errors:ne(Re(c.errors,!a.shouldUseNativeValidation&&a.criteriaMode==="all"),a)};throw c}))}catch(c){return Promise.reject(c)}}};const De=K("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),S=i.forwardRef(({className:e,variant:t,size:r,asChild:s=!1,...o},a)=>{const c=s?$:"button";return n.jsx(c,{className:m(De({variant:t,size:r,className:e})),ref:a,...o})});S.displayName="Button";const C=i.forwardRef(({className:e,type:t,...r},s)=>n.jsx("input",{type:t,className:m("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...r}));C.displayName="Input";const Q=i.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:m("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Q.displayName="Card";const q=i.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:m("flex flex-col space-y-1.5 p-6",e),...t}));q.displayName="CardHeader";const z=i.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:m("text-2xl font-semibold leading-none tracking-tight",e),...t}));z.displayName="CardTitle";const Oe=i.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:m("text-sm text-muted-foreground",e),...t}));Oe.displayName="CardDescription";const U=i.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:m("p-6 pt-0",e),...t}));U.displayName="CardContent";const Pe=i.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:m("flex items-center p-6 pt-0",e),...t}));Pe.displayName="CardFooter";var _e="Label",H=i.forwardRef((e,t)=>n.jsx(Te.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));H.displayName=_e;var G=H;const Me=K("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),J=i.forwardRef(({className:e,...t},r)=>n.jsx(G,{ref:r,className:m(Me(),e),...t}));J.displayName=G.displayName;const Ve=ie,X=i.createContext({}),M=({...e})=>n.jsx(X.Provider,{value:{name:e.name},children:n.jsx(le,{...e})}),v=()=>{const e=i.useContext(X),t=i.useContext(Y),{getFieldState:r,formState:s}=ae(),o=r(e.name,s);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:a}=t;return{id:a,name:e.name,formItemId:`${a}-form-item`,formDescriptionId:`${a}-form-item-description`,formMessageId:`${a}-form-item-message`,...o}},Y=i.createContext({}),E=i.forwardRef(({className:e,...t},r)=>{const s=i.useId();return n.jsx(Y.Provider,{value:{id:s},children:n.jsx("div",{ref:r,className:m("space-y-2",e),...t})})});E.displayName="FormItem";const F=i.forwardRef(({className:e,...t},r)=>{const{error:s,formItemId:o}=v();return n.jsx(J,{ref:r,className:m(s&&"text-destructive",e),htmlFor:o,...t})});F.displayName="FormLabel";const T=i.forwardRef(({...e},t)=>{const{error:r,formItemId:s,formDescriptionId:o,formMessageId:a}=v();return n.jsx($,{ref:t,id:s,"aria-describedby":r?`${o} ${a}`:`${o}`,"aria-invalid":!!r,...e})});T.displayName="FormControl";const ke=i.forwardRef(({className:e,...t},r)=>{const{formDescriptionId:s}=v();return n.jsx("p",{ref:r,id:s,className:m("text-sm text-muted-foreground",e),...t})});ke.displayName="FormDescription";const I=i.forwardRef(({className:e,children:t,...r},s)=>{const{error:o,formMessageId:a}=v(),c=o?String(o?.message??""):t;return c?n.jsx("p",{ref:s,id:a,className:m("text-sm font-medium text-destructive",e),...r,children:c}):null});I.displayName="FormMessage";const Le=j.object({email:j.string().email("유효한 이메일을 입력해주세요"),password:j.string().min(1,"비밀번호를 입력해주세요")});function Ye(){const{user:e,loginMutation:t}=Ie(),{toast:r}=we();me();const[s,o]=i.useState(!1),a=ce({resolver:Ae(Le),defaultValues:{email:"",password:""}});if(e)return null;const c=async d=>{try{await t.mutateAsync(d),r({title:"로그인 성공",description:"환영합니다!"})}catch(u){r({title:"로그인 실패",description:u.message||"로그인에 실패했습니다",variant:"destructive"})}},l=t.isPending;return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:n.jsxs("div",{className:"w-full max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-lg mb-4",children:n.jsx(fe,{className:"h-8 w-8 text-blue-600"})}),n.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"발주 관리 시스템"}),n.jsx("p",{className:"text-gray-600",children:"계정에 로그인하여 시스템을 이용하세요"})]}),n.jsxs(Q,{children:[n.jsx(q,{children:n.jsx(z,{className:"text-center",children:"로그인"})}),n.jsx(U,{children:n.jsx(Ve,{...a,children:n.jsxs("form",{onSubmit:a.handleSubmit(c),className:"space-y-4",children:[n.jsx(M,{control:a.control,name:"email",render:({field:d})=>n.jsxs(E,{children:[n.jsx(F,{children:"이메일"}),n.jsx(T,{children:n.jsx(C,{type:"email",placeholder:"이메일을 입력하세요",...d})}),n.jsx(I,{})]})}),n.jsx(M,{control:a.control,name:"password",render:({field:d})=>n.jsxs(E,{children:[n.jsx(F,{children:"비밀번호"}),n.jsx(T,{children:n.jsxs("div",{className:"relative",children:[n.jsx(C,{type:s?"text":"password",placeholder:"비밀번호를 입력하세요",...d}),n.jsx(S,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>o(!s),children:s?n.jsx(pe,{className:"h-4 w-4 text-gray-500"}):n.jsx(he,{className:"h-4 w-4 text-gray-500"})})]})}),n.jsx(I,{})]})}),n.jsx(S,{type:"submit",className:"w-full",disabled:l,children:l?n.jsxs("div",{className:"flex items-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"로그인 중..."]}):n.jsxs("div",{className:"flex items-center",children:[n.jsx(xe,{className:"h-4 w-4 mr-2"}),"로그인"]})})]})})})]}),n.jsxs("div",{className:"mt-8 text-center text-sm text-gray-600",children:[n.jsx("p",{children:"기본 로그인 정보:"}),n.jsx("p",{children:"이메일: test@ikjin.co.kr"}),n.jsx("p",{children:"비밀번호: admin123"})]})]})})}export{Xe as A,S as B,Q as C,Ve as F,C as I,J as L,Te as P,k as a,m as b,L as c,Ue as d,K as e,He as f,U as g,q as h,z as i,Je as j,Ie as k,we as l,ze as m,M as n,E as o,F as p,T as q,I as r,Oe as s,Ae as t,qe as u,Ye as v,De as w,Ge as x};
