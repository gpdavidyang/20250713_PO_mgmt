import{r as b,j as e,E as T,s as H,B as c,F,ar as q,as as I,i as _,aZ as G,W as Z}from"./index-Vn7Tfob_.js";import{a as J,b as V,c as Q,D as E,f as X}from"./dialog-yxt4bX87.js";import{T as Y,a as D,b as O,c as z}from"./tabs-Cje8sE2t.js";import{h as ee,E as te}from"./html2canvas.esm-DG6pCTJJ.js";import{P as $}from"./printer-DNQyukXQ.js";import{D as W}from"./download-6wgb0pEF.js";import{R as U}from"./refresh-cw-axbGP9Qz.js";class A{static async generateFromElement(d,o={}){try{const{filename:l="document.pdf",orientation:r="portrait",format:n="a4",quality:x=.95,scale:h=2}=o;console.log("📄 클라이언트 PDF 생성 시작...");const y=await ee(d,{scale:h,useCORS:!0,logging:!1,letterRendering:!0,allowTaint:!0,backgroundColor:"#ffffff"}),N=y.toDataURL("image/png",x),f=new te({orientation:r,unit:"mm",format:n}),S=f.internal.pageSize.getWidth(),P=f.internal.pageSize.getHeight(),w=S,m=y.height*w/y.width;let g=m,v=0;for(f.addImage(N,"PNG",0,v,w,m),g-=P;g>0;)v=g-m,f.addPage(),f.addImage(N,"PNG",0,v,w,m),g-=P;const k=f.output("blob");return console.log("✅ PDF 생성 완료"),{success:!0,blob:k}}catch(l){return console.error("❌ 클라이언트 PDF 생성 오류:",l),{success:!1,error:l instanceof Error?l.message:"알 수 없는 오류"}}}static downloadPdf(d,o="document.pdf"){const l=window.URL.createObjectURL(d),r=document.createElement("a");r.href=l,r.download=o,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(l)}static previewPdf(d){const o=window.URL.createObjectURL(d);window.open(o,"_blank"),setTimeout(()=>{window.URL.revokeObjectURL(o)},1e4)}static async generateFromHtml(d,o={}){try{const l=document.createElement("div");l.style.position="absolute",l.style.left="-9999px",l.style.width="210mm",l.innerHTML=d,document.body.appendChild(l);const r=await this.generateFromElement(l,o);return document.body.removeChild(l),r}catch(l){return console.error("❌ HTML PDF 변환 오류:",l),{success:!1,error:l instanceof Error?l.message:"알 수 없는 오류"}}}static async generateOrderPdf(d,o={}){try{const l=`
        <div style="font-family: 'Malgun Gothic', sans-serif; padding: 20px;">
          <h1 style="text-align: center; color: #2563eb;">구매 발주서</h1>
          <div style="margin: 20px 0;">
            <h2>발주 정보</h2>
            <table style="width: 100%; border-collapse: collapse;">
              <tr>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">발주 번호</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.orderNumber||""}</td>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">발주 일자</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.orderDate||""}</td>
              </tr>
              <tr>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">프로젝트</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.projectName||""}</td>
                <td style="border: 1px solid #ddd; padding: 8px; background: #f3f4f6;">거래처</td>
                <td style="border: 1px solid #ddd; padding: 8px;">${d.vendorName||""}</td>
              </tr>
            </table>
          </div>
          ${d.items?`
            <div style="margin: 20px 0;">
              <h2>발주 품목</h2>
              <table style="width: 100%; border-collapse: collapse;">
                <thead>
                  <tr style="background: #f3f4f6;">
                    <th style="border: 1px solid #ddd; padding: 8px;">품목명</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">규격</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">수량</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">단가</th>
                    <th style="border: 1px solid #ddd; padding: 8px;">금액</th>
                  </tr>
                </thead>
                <tbody>
                  ${d.items.map(r=>`
                    <tr>
                      <td style="border: 1px solid #ddd; padding: 8px;">${r.name||""}</td>
                      <td style="border: 1px solid #ddd; padding: 8px;">${r.specification||""}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${r.quantity||0}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${r.unitPrice?.toLocaleString()||0}</td>
                      <td style="border: 1px solid #ddd; padding: 8px; text-align: right;">${r.totalPrice?.toLocaleString()||0}</td>
                    </tr>
                  `).join("")}
                </tbody>
                <tfoot>
                  <tr style="background: #eff6ff;">
                    <td colspan="4" style="border: 1px solid #ddd; padding: 8px; text-align: right; font-weight: bold;">총 금액</td>
                    <td style="border: 1px solid #ddd; padding: 8px; text-align: right; font-weight: bold;">
                      ${d.totalAmount?.toLocaleString()||0} 원
                    </td>
                  </tr>
                </tfoot>
              </table>
            </div>
          `:""}
        </div>
      `;return await this.generateFromHtml(l,{...o,filename:`PO_${d.orderNumber||"draft"}.pdf`})}catch(l){return console.error("❌ 발주서 PDF 생성 오류:",l),{success:!1,error:l instanceof Error?l.message:"알 수 없는 오류"}}}}const ae=({orderData:t,isOpen:d,onClose:o,trigger:l,onDownload:r})=>{const[n,x]=b.useState({status:"idle"}),[h,y]=b.useState(100),[N,f]=b.useState(1),[S,P]=b.useState(1),[w,m]=b.useState(!1);b.useRef(null);const g=async()=>{x({status:"generating",progress:0});try{if(console.log("📄 클라이언트 PDF 생성 시작..."),!t||Object.keys(t).length===0)throw new Error("발주서 데이터가 없습니다.");x({status:"generating",progress:30});const s=await A.generateOrderPdf(t,{filename:`PO_${t.orderNumber||"draft"}.pdf`,orientation:"portrait",format:"a4"});if(x({status:"generating",progress:70}),!s.success||!s.blob)throw new Error(s.error||"PDF 생성 실패");const i=window.URL.createObjectURL(s.blob);x({status:"generating",progress:100}),await new Promise(a=>setTimeout(a,200)),x({status:"ready",url:i,blob:s.blob}),console.log("✅ 클라이언트 PDF 생성 완료")}catch(s){console.error("❌ 클라이언트 PDF 생성 오류:",s),x({status:"error",error:s instanceof Error?s.message:"PDF 생성 실패"})}},v=async()=>{x({status:"generating",progress:0});try{if(console.log("PDF 생성 시작 - orderData:",t),!t||Object.keys(t).length===0)throw new Error("발주서 데이터가 없습니다. 발주서를 먼저 생성해주세요.");const s=[{message:"발주서 데이터 준비 중...",progress:15},{message:"PDF 템플릿 로딩 중...",progress:30},{message:"HTML 콘텐츠 생성 중...",progress:50},{message:"PDF 변환 중...",progress:75},{message:"최종 검증 중...",progress:90},{message:"완료",progress:100}];for(let p=0;p<s.length-1;p++){const u=s[p];x({status:"generating",progress:u.progress}),await new Promise(C=>setTimeout(C,p===0?300:600))}console.log("📄 API 호출 시작...");const i={orderData:{orderNumber:t.orderNumber||"PO-TEMP-001",projectName:t.projectName||t.project?.name||t.project?.projectName||"프로젝트 미지정",vendorName:t.vendorName||t.vendor?.name||"거래처 미지정",items:Array.isArray(t.items)?t.items:[],totalAmount:Number(t.totalAmount)||0,notes:t.notes||t.remarks||"",orderDate:t.orderDate||new Date().toISOString(),deliveryDate:t.deliveryDate||t.dueDate||null,createdBy:t.createdBy||t.user?.name||"시스템"},options:{includeWatermark:!0,format:"A4",orientation:"portrait"}};console.log("📤 전송할 데이터:",JSON.stringify(i,null,2));const a=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify(i)});if(console.log("📨 응답 상태:",a.status,a.statusText),!a.ok){let p=`서버 오류 (${a.status})`;try{const u=await a.json();console.error("📨 서버 에러 응답:",u),p=u.error||u.details||p}catch(u){console.error("📨 에러 응답 파싱 실패:",u);const C=await a.text();console.error("📨 텍스트 응답:",C)}throw new Error(p)}const j=await a.json();if(console.log("✅ PDF 생성 성공 응답:",j),!j.success)throw new Error(j.error||"PDF 생성에 실패했습니다.");if(!j.pdfUrl)throw new Error("PDF URL이 응답에 포함되지 않았습니다.");x({status:"generating",progress:100}),await new Promise(p=>setTimeout(p,200)),x({status:"ready",url:j.pdfUrl,message:j.message})}catch(s){console.error("❌ PDF 생성 오류:",s);let i="PDF 생성 중 오류가 발생했습니다.";s instanceof Error&&(s.message.includes("fetch")?i="서버에 연결할 수 없습니다. 네트워크 상태를 확인해주세요.":s.message.includes("timeout")?i="처리 시간이 초과되었습니다. 다시 시도해주세요.":s.message.includes("발주서 데이터")?i=s.message:s.message.includes("puppeteer")||s.message.includes("PDF 생성 실패")?i="PDF 변환 도구에 문제가 있습니다. 잠시 후 다시 시도해주세요.":i=s.message),x({status:"error",error:i})}},k=async()=>{const s=window.location.hostname.includes("vercel.app")||window.location.hostname.includes("ikjin-po");w||s?await g():await v()};b.useEffect(()=>{d&&n.status==="idle"&&k()},[d]);const B=()=>{if(n.blob)A.downloadPdf(n.blob,`PO_${t?.orderNumber||"draft"}.pdf`);else if(n.url&&r)r(n.url);else if(n.url){const s=document.createElement("a");s.href=n.url,s.download=`발주서_${t?.orderNumber||"unknown"}.pdf`,document.body.appendChild(s),s.click(),document.body.removeChild(s)}},L=()=>{n.blob?A.previewPdf(n.blob):n.url&&window.open(n.url,"_blank")},K=async()=>{try{console.log("🔄 대안 PDF 다운로드 시작...");const s={orderData:{orderNumber:t?.orderNumber||"PO-TEMP-001",projectName:t?.projectName||t?.project?.name||"프로젝트 미지정",vendorName:t?.vendorName||t?.vendor?.name||"거래처 미지정",items:Array.isArray(t?.items)?t.items:[],totalAmount:Number(t?.totalAmount)||0,notes:t?.notes||t?.remarks||"",orderDate:t?.orderDate||new Date().toISOString(),deliveryDate:t?.deliveryDate||t?.dueDate||null,createdBy:t?.createdBy||t?.user?.name||"시스템"}},i=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s)});if(i.ok){const a=await i.json();if(a.success&&a.pdfUrl)window.open(`${a.pdfUrl}?download=true`,"_blank");else throw new Error(a.error||"대안 PDF 생성 실패")}else throw new Error(`서버 오류 (${i.status})`)}catch(s){console.error("❌ 대안 PDF 다운로드 오류:",s),alert("대안 PDF 다운로드에 실패했습니다. 브라우저 인쇄 기능을 이용해보세요.")}},M=()=>{switch(n.status){case"generating":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[e.jsx(Z,{className:"w-12 h-12 text-blue-600 animate-spin"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF 생성 중..."}),e.jsx("div",{className:"w-80 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${n.progress||0}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n.progress||0,"% 완료"]})]});case"error":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-6",children:[e.jsx(_,{className:"w-16 h-16 text-red-500"}),e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"PDF 생성 실패"}),e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400 max-w-md",children:n.error})]}),e.jsxs("div",{className:"w-full max-w-2xl space-y-4",children:[e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900 dark:text-blue-100 mb-2",children:"💡 해결 방법"}),e.jsxs("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1",children:[e.jsx("li",{children:"• 브라우저를 새로고침하고 다시 시도해보세요"}),e.jsx("li",{children:"• 다른 브라우저(Chrome, Firefox 등)를 사용해보세요"}),e.jsx("li",{children:"• 페이지를 잠시 기다린 후 재시도해보세요"}),e.jsx("li",{children:"• 발주서 데이터가 완전히 로드된 후 시도해보세요"})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900 dark:text-green-100 mb-2",children:"✨ 대안 방법"}),e.jsxs("ul",{className:"text-sm text-green-800 dark:text-green-200 space-y-1",children:[e.jsx("li",{children:'• "단순 PDF 생성" 버튼으로 직접 다운로드 시도'}),e.jsx("li",{children:"• 발주서 상세 페이지에서 직접 다운로드"}),e.jsx("li",{children:"• 브라우저의 인쇄 기능(Ctrl+P)을 이용해 PDF로 저장"}),e.jsx("li",{children:"• Excel 형태로 내보내기 후 수동으로 PDF 변환"})]})]}),!1]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center",children:[e.jsxs(c,{onClick:k,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"다시 시도"]}),e.jsxs(c,{onClick:()=>{m(!0),g()},variant:"outline",className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4"}),"브라우저 PDF 생성"]}),e.jsxs(c,{onClick:()=>window.location.reload(),variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"페이지 새로고침"]}),t?.id&&e.jsxs(c,{onClick:()=>{o&&o(),window.location.href=`/orders/${t.id}`},variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-4 h-4"}),"상세 페이지로"]}),e.jsxs(c,{onClick:()=>{m(!0),g()},disabled:!t?.orderNumber,className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),"직접 다운로드"]}),e.jsxs(c,{onClick:K,variant:"secondary",className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4"}),"단순 PDF 생성"]})]})]});case"ready":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>y(Math.max(50,h-25)),disabled:h<=50,children:e.jsx(q,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium px-2",children:[h,"%"]}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>y(Math.min(200,h+25)),disabled:h>=200,children:e.jsx(I,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[N," / ",S]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:L,children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"인쇄"]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:B,children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),"다운로드"]})]})]}),e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 min-h-[600px] flex items-center justify-center",children:n.url?e.jsx("iframe",{src:`${n.url}#view=FitH&zoom=${h}`,className:"w-full h-[600px] border-0 rounded",title:"PDF 미리보기"}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(F,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"PDF 로딩 중..."})]})})]});default:return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs(c,{onClick:k,children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"PDF 미리보기 시작"]})})}},R=e.jsxs(J,{className:"max-w-5xl h-[90vh] overflow-hidden",children:[e.jsx(V,{children:e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"PDF 미리보기",t?.orderNumber&&e.jsx(H,{variant:"outline",children:t.orderNumber})]})}),e.jsxs(Y,{defaultValue:"preview",className:"h-full flex flex-col",children:[e.jsxs(D,{className:"grid w-full grid-cols-2",children:[e.jsx(O,{value:"preview",children:"발주서 미리보기"}),e.jsx(O,{value:"pdf",children:"PDF 생성"})]}),e.jsx(z,{value:"preview",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"order-preview-container bg-white",style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #333",paddingBottom:"8px",marginBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"발주서 Purchase Order"}),e.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["발주번호: ",t?.orderNumber||"PO-TEMP-001"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"거래처 정보"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"회사명:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendorName||t?.vendor?.name||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"사업자번호:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.businessNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"연락처:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.phone||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"이메일:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.email||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"주소:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"발주 정보"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"발주일자:"}),e.jsx("span",{style:{flex:"1"},children:t?.orderDate?new Date(t.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"납품희망일:"}),e.jsx("span",{style:{flex:"1"},children:t?.deliveryDate||t?.dueDate?new Date(t.deliveryDate||t.dueDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"발주자:"}),e.jsx("span",{style:{flex:"1"},children:t?.createdBy||t?.user?.name||"시스템"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"상태:"}),e.jsx("span",{style:{flex:"1"},children:t?.status==="pending"?"대기":t?.status==="approved"?"승인":t?.status==="sent"?"발송":t?.status||"임시"})]})]})]}),e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"발주 품목"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"품목명"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"규격"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"수량"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"단가"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"금액"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"비고"})]})}),e.jsxs("tbody",{children:[(t?.items||[]).map((s,i)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:s.itemName||s.name}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:s.specification||"-"}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:Number(s.quantity).toLocaleString("ko-KR")}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["₩",Number(s.unitPrice).toLocaleString("ko-KR")]}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["₩",(Number(s.quantity)*Number(s.unitPrice)).toLocaleString("ko-KR")]}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:s.notes||"-"})]},i)),(!t?.items||t.items.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{border:"1px solid #ddd",padding:"20px",textAlign:"center",fontSize:"10px",color:"#666"},children:"품목 정보가 없습니다"})})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},colSpan:4,children:"총 금액"}),e.jsxs("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:["₩",Number(t?.totalAmount||0).toLocaleString("ko-KR")]}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",backgroundColor:"#f5f5f5"}})]})})]}),(t?.notes||t?.remarks)&&e.jsxs("div",{style:{marginTop:"15px",padding:"8px",border:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[e.jsx("strong",{children:"특이사항:"}),e.jsx("br",{}),t.notes||t.remarks]}),e.jsxs("div",{className:"no-print mt-6 flex justify-center space-x-4",children:[e.jsxs(c,{onClick:L,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"인쇄"]}),e.jsxs(c,{onClick:B,variant:"outline",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"PDF 다운로드"]})]})]})}),e.jsx(z,{value:"pdf",className:"flex-1 overflow-auto",children:M()}),e.jsx(z,{value:"details",className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"order-preview-container bg-white",style:{fontFamily:'"Noto Sans KR", "Malgun Gothic", sans-serif',fontSize:"11px",lineHeight:"1.3",color:"#000",backgroundColor:"#fff",width:"210mm",minHeight:"297mm",padding:"10mm",margin:"0 auto",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"2px solid #333",paddingBottom:"8px",marginBottom:"15px"},children:[e.jsx("h1",{style:{margin:"0",fontSize:"18px",fontWeight:"bold",color:"#333"},children:"발주서 Purchase Order"}),e.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["발주번호: ",t?.orderNumber||"PO-TEMP-001"]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",marginBottom:"20px"},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"거래처 정보"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"회사명:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendorName||t?.vendor?.name||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"사업자번호:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.businessNumber||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"연락처:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.phone||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"이메일:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.email||"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"주소:"}),e.jsx("span",{style:{flex:"1"},children:t?.vendor?.address||"-"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"발주 정보"}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"발주일자:"}),e.jsx("span",{style:{flex:"1"},children:t?.orderDate?new Date(t.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"납품희망일:"}),e.jsx("span",{style:{flex:"1"},children:t?.deliveryDate||t?.dueDate?new Date(t.deliveryDate||t.dueDate).toLocaleDateString("ko-KR"):"-"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"발주자:"}),e.jsx("span",{style:{flex:"1"},children:t?.createdBy||t?.user?.name||"시스템"})]}),e.jsxs("div",{style:{display:"flex",marginBottom:"4px"},children:[e.jsx("span",{style:{fontWeight:"bold",width:"80px",flexShrink:"0"},children:"상태:"}),e.jsx("span",{style:{flex:"1"},children:t?.status==="pending"?"대기":t?.status==="approved"?"승인":t?.status==="sent"?"발송":t?.status||"임시"})]})]})]}),e.jsx("h3",{style:{fontSize:"12px",fontWeight:"bold",margin:"0 0 8px 0",backgroundColor:"#f5f5f5",padding:"4px 8px",border:"1px solid #ddd"},children:"발주 품목"}),e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",marginBottom:"15px"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"품목명"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"규격"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"수량"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"단가"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"금액"}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:"비고"})]})}),e.jsxs("tbody",{children:[(t?.items||[]).map((s,i)=>e.jsxs("tr",{children:[e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:s.itemName||s.name}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:s.specification||"-"}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:Number(s.quantity).toLocaleString("ko-KR")}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["₩",Number(s.unitPrice).toLocaleString("ko-KR")]}),e.jsxs("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px"},children:["₩",(Number(s.quantity)*Number(s.unitPrice)).toLocaleString("ko-KR")]}),e.jsx("td",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px"},children:s.notes||"-"})]},i)),(!t?.items||t.items.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{border:"1px solid #ddd",padding:"20px",textAlign:"center",fontSize:"10px",color:"#666"},children:"품목 정보가 없습니다"})})]}),e.jsx("tfoot",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"left",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},colSpan:4,children:"총 금액"}),e.jsxs("th",{style:{border:"1px solid #ddd",padding:"6px",textAlign:"right",fontSize:"10px",backgroundColor:"#f5f5f5",fontWeight:"bold"},children:["₩",Number(t?.totalAmount||0).toLocaleString("ko-KR")]}),e.jsx("th",{style:{border:"1px solid #ddd",padding:"6px",backgroundColor:"#f5f5f5"}})]})})]}),(t?.notes||t?.remarks)&&e.jsxs("div",{style:{marginTop:"15px",padding:"8px",border:"1px solid #ddd",backgroundColor:"#f9f9f9"},children:[e.jsx("strong",{children:"특이사항:"}),e.jsx("br",{}),t.notes||t.remarks]})]})})]})]});return l?e.jsxs(E,{open:d,onOpenChange:o,children:[e.jsx(X,{asChild:!0,children:l}),R]}):e.jsx(E,{open:d,onOpenChange:o,children:R})};export{ae as P};
