import{b as j,c as N,d as v,u as f,e as $,r as h,m as w,o as T,j as e,w as m,B as b,p as C,s as L,n as U}from"./index-D-7Lp4md.js";import{T as E,a as k,b as n,c as l,d as q,e as a}from"./table-Dsr3RMlA.js";import{i as z}from"./authUtils-CcDzk6i0.js";import{f as A}from"./formatters-gd6aBVnV.js";import{U as B}from"./users-D2Op655x.js";import{S}from"./square-pen-__MuDsDh.js";import{T as M}from"./trash-2-CdMGAMxm.js";function Y(){const{user:t,isAuthenticated:g,isLoading:o}=j(),{toast:i}=N(),y=v(),[,c]=f(),{theme:p}=$(),s=p==="dark";h.useEffect(()=>{if(!o&&!g){i({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{c("/login")},500);return}},[g,o,i,c]),h.useEffect(()=>{if(!o&&t&&t.role!=="admin"){i({title:"접근 권한 없음",description:"관리자만 접근할 수 있습니다.",variant:"destructive"}),setTimeout(()=>{window.location.href="/"},1e3);return}},[t,o,i]);const{data:d=[],isLoading:u}=w({queryKey:["/api/users"],enabled:!!t&&t.role==="admin",retry:!1});return T({mutationFn:async({userId:r,role:x})=>{await U("PUT",`/api/users/${r}`,{role:x})},onSuccess:()=>{i({title:"사용자 역할 변경",description:"사용자 역할이 성공적으로 변경되었습니다."}),y.invalidateQueries({queryKey:["/api/users"]})},onError:r=>{if(z(r)){i({title:"Unauthorized",description:"You are logged out. Logging in again...",variant:"destructive"}),setTimeout(()=>{c("/login")},500);return}i({title:"오류",description:"사용자 역할 변경 중 오류가 발생했습니다.",variant:"destructive"})}}),o||!t||t.role!=="admin"?e.jsx("div",{children:"Loading..."}):e.jsx("div",{className:`min-h-screen transition-colors ${s?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-[1366px] mx-auto p-6 space-y-6",children:[e.jsx("div",{className:`bg-white shadow-sm rounded-lg border transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg transition-colors ${s?"bg-blue-900/20":"bg-blue-50"}`,children:e.jsx(B,{className:`h-6 w-6 transition-colors ${s?"text-blue-400":"text-blue-600"}`})}),e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-bold transition-colors ${s?"text-white":"text-gray-900"}`,children:"사용자 관리"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:"시스템 사용자를 관리합니다"})]})]})})})}),e.jsx("div",{className:`shadow-sm rounded-lg border overflow-hidden transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsx("div",{className:"p-0",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(E,{children:[e.jsx(k,{children:e.jsxs(n,{className:`border-b transition-colors ${s?"bg-gray-700 border-gray-600":"bg-gray-50/50 border-gray-200"}`,children:[e.jsx(l,{className:`px-3 py-1.5 text-xs font-semibold transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"사용자명"}),e.jsx(l,{className:`px-3 py-1.5 text-xs font-semibold transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"이메일"}),e.jsx(l,{className:`px-3 py-1.5 text-xs font-semibold transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"역할"}),e.jsx(l,{className:`px-3 py-1.5 text-xs font-semibold transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"연락처"}),e.jsx(l,{className:`px-3 py-1.5 text-xs font-semibold transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:"가입일"}),e.jsx(l,{className:`px-3 py-1.5 text-xs font-semibold transition-colors w-[100px] ${s?"text-gray-300":"text-gray-700"}`,children:"작업"})]})}),e.jsx(q,{children:u?[...Array(5)].map((r,x)=>e.jsxs(n,{className:`border-b transition-colors ${s?"border-gray-600":"border-gray-200"}`,children:[e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`h-3 rounded animate-pulse transition-colors ${s?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`h-3 rounded animate-pulse w-3/4 transition-colors ${s?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`h-3 rounded animate-pulse w-1/2 transition-colors ${s?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`h-3 rounded animate-pulse w-2/3 transition-colors ${s?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`h-3 rounded animate-pulse w-2/3 transition-colors ${s?"bg-gray-600":"bg-gray-200"}`})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`h-3 rounded animate-pulse w-16 transition-colors ${s?"bg-gray-600":"bg-gray-200"}`})})]},x)):d&&d.length>0?d.map(r=>e.jsxs(n,{className:`border-b transition-colors ${s?"border-gray-600 hover:bg-gray-700":"border-gray-200 hover:bg-gray-50/50"}`,children:[e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("button",{className:"text-left",onClick:()=>{},children:e.jsx("div",{className:`text-xs font-medium transition-colors ${s?"text-blue-400 hover:text-blue-300":"text-blue-600 hover:text-blue-800"}`,children:r.name||`사용자 ${r.id}`})})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`text-xs transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:r.email})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx(m,{variant:r.role==="admin"?"destructive":r.role==="order_manager"?"default":"secondary",className:"text-xs",children:r.role==="admin"?"관리자":r.role==="order_manager"?"발주담당자":"사용자"})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`text-xs transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:r.phoneNumber||"-"})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsx("div",{className:`text-xs transition-colors ${s?"text-gray-400":"text-gray-600"}`,children:r.createdAt?A(r.createdAt):"-"})}),e.jsx(a,{className:"px-3 py-1.5",children:e.jsxs("div",{className:"flex items-center -space-x-1",children:[e.jsx(b,{variant:"ghost",size:"sm",className:`h-6 w-6 p-0 transition-colors ${s?"text-blue-400 hover:bg-blue-900/20":"text-blue-600 hover:bg-blue-50"}`,onClick:()=>{},title:"수정",children:e.jsx(S,{className:"h-3 w-3"})}),e.jsx(b,{variant:"ghost",size:"sm",className:`h-6 w-6 p-0 transition-colors ${s?"text-red-400 hover:bg-red-900/20":"text-red-600 hover:bg-red-50"}`,onClick:()=>{},title:"삭제",children:e.jsx(M,{className:"h-3 w-3"})})]})})]},r.id)):e.jsx(n,{children:e.jsx(a,{colSpan:6,className:`py-8 text-center text-xs transition-colors ${s?"text-gray-400":"text-gray-500"}`,children:"등록된 사용자가 없습니다"})})})]})})})}),e.jsx(C,{className:`shadow-sm transition-colors ${s?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs(L,{className:"p-4",children:[e.jsx("h3",{className:`text-sm font-semibold mb-3 transition-colors ${s?"text-white":"text-gray-900"}`,children:"사용자 역할 안내"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{className:`p-3 rounded-lg border transition-colors ${s?"bg-red-900/20 border-red-800":"bg-red-50 border-red-200"}`,children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx(m,{variant:"destructive",className:"text-xs",children:"관리자"})}),e.jsxs("ul",{className:`text-xs space-y-1 transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("li",{children:"• 모든 발주서 조회 및 승인"}),e.jsx("li",{children:"• 거래처 관리 (추가, 수정, 삭제)"}),e.jsx("li",{children:"• 사용자 권한 관리"}),e.jsx("li",{children:"• 시스템 통계 및 분석"})]})]}),e.jsxs("div",{className:`p-3 rounded-lg border transition-colors ${s?"bg-blue-900/20 border-blue-800":"bg-blue-50 border-blue-200"}`,children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx(m,{variant:"default",className:"text-xs",children:"발주담당자"})}),e.jsxs("ul",{className:`text-xs space-y-1 transition-colors ${s?"text-gray-300":"text-gray-700"}`,children:[e.jsx("li",{children:"• 발주서 작성 및 관리"}),e.jsx("li",{children:"• 자신의 발주서만 조회"}),e.jsx("li",{children:"• 거래처 정보 조회"}),e.jsx("li",{children:"• 개인 대시보드 접근"})]})]})]})]})})]})})}export{Y as default};
