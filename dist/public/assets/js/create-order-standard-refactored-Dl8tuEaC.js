import{j as e,a as L}from"./chunk-D67rGsji.js";import{r as u}from"./chunk-BgLp_VvL.js";import{C as S,h as I,i as k,g as P,L as o,I as A,B as g,b as Y,l as ee}from"./chunk-DV-F1ehd.js";import{S as y,h as f,i as w,j as C,k as r,D as se,a as ae,b as re,c as le}from"./chunk-bdHBeqB0.js";import{C as te}from"./chunk-Qrbxos93.js";import{w as R,aF as V,J as ce,K as U,y as ne,ak as de,b as ie,aH as xe,I as oe,a4 as he,a5 as me,aG as je,aw as pe,au as ge,ay as ue,a1 as Ne,a3 as E,Z as K,d as O,F as D,a as ve}from"./chunk-CVirgo2y.js";import{P as be,a as ye,b as fe}from"./chunk-D-mEonCb.js";import{C as we,a as Ce,b as Se,c as Ie,d as ke}from"./chunk-3uln87AG.js";import{a as q,r as Pe,c as B,b as z,g as Ae}from"./chunk--mTpk5at.js";import{B as T}from"./chunk-Bw5QEQRA.js";import"./chunk-CZez8RVl.js";import"./chunk-CFxRDIMf.js";function Fe({formData:n,onFormDataChange:j,projects:l,users:i,poNumber:p}){const h=(s,a)=>{j({...n,[s]:a})};return e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"bg-gray-50 border-b",children:e.jsxs(k,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(R,{className:"h-5 w-5 text-blue-600"}),"발주서 기본 정보"]})}),e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-sm font-medium",children:"발주서 번호"}),e.jsx("div",{className:"h-10 px-3 py-2 text-sm font-semibold text-blue-600 bg-gray-50 border rounded-md flex items-center",children:p})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-sm font-medium",children:"작성일"}),e.jsx("div",{className:"h-10 px-3 py-2 text-sm bg-gray-50 border rounded-md flex items-center",children:new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"site",className:"text-sm font-medium",children:"현장 선택"}),e.jsxs(y,{value:n.site,onValueChange:s=>h("site",s),children:[e.jsx(f,{className:"h-10",children:e.jsx(w,{placeholder:"현장을 선택하세요"})}),e.jsx(C,{children:l.map(s=>e.jsx(r,{value:s.projectName,children:s.projectName},s.id))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"deliveryDate",className:"text-sm font-medium",children:"납품 희망일"}),e.jsx(A,{type:"date",id:"deliveryDate",className:"h-10",value:n.deliveryDate,onChange:s=>h("deliveryDate",s.target.value)}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[e.jsx(te,{id:"isNegotiable",checked:n.isNegotiable,onCheckedChange:s=>h("isNegotiable",s)}),e.jsx(o,{htmlFor:"isNegotiable",className:"text-sm text-gray-600",children:"협의 가능"})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"receiver",className:"text-sm font-medium",children:"자재 인수자"}),e.jsxs(y,{value:n.receiver,onValueChange:s=>h("receiver",s),children:[e.jsx(f,{className:"h-10",children:e.jsx(w,{placeholder:"인수자 선택"})}),e.jsx(C,{children:i.map(s=>e.jsx(r,{value:s.email||"",children:s.email},s.id))})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"manager",className:"text-sm font-medium",children:"본사 담당자"}),e.jsxs(y,{value:n.manager,onValueChange:s=>h("manager",s),children:[e.jsx(f,{className:"h-10",children:e.jsx(w,{placeholder:"담당자 선택"})}),e.jsx(C,{children:i.map(s=>e.jsx(r,{value:s.email||"",children:s.email},s.id))})]})]})]})})]})}function De({value:n,onChange:j,placeholder:l="품목명을 입력하세요"}){const[i,p]=u.useState(!1),[h,s]=u.useState(n),{data:a}=L({queryKey:["/api/items"],enabled:!0}),t=a?.items||[],d=Array.isArray(t)?t.filter(x=>x.name&&x.name.toLowerCase().includes(h.toLowerCase())):[],N=x=>{s(x),j(x),p(!1)},v=x=>{s(x),j(x)};return e.jsxs(be,{open:i,onOpenChange:p,children:[e.jsx(ye,{asChild:!0,children:e.jsxs("div",{className:"relative",children:[e.jsx(A,{value:h,onChange:x=>v(x.target.value),placeholder:l,className:"h-8 text-sm pr-8",onFocus:()=>p(!0)}),e.jsx(g,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-8 w-8 p-0 hover:bg-transparent",onClick:()=>p(!i),children:e.jsx(de,{className:"h-3 w-3 shrink-0 opacity-50"})})]})}),e.jsx(fe,{className:"w-full p-0",align:"start",children:e.jsxs(we,{children:[e.jsx(Ce,{placeholder:"품목명 검색...",value:h,onValueChange:v}),e.jsx(Se,{children:e.jsx("div",{className:"p-2 text-sm text-gray-500",children:"검색 결과가 없습니다. 직접 입력하시면 새 품목으로 추가됩니다."})}),e.jsx(Ie,{className:"max-h-48 overflow-auto",children:d.map(x=>e.jsxs(ke,{value:x.name,onSelect:()=>N(x.name),className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:x.name}),e.jsx("span",{className:"text-xs text-gray-500",children:x.category})]}),e.jsx(ie,{className:Y("ml-auto h-4 w-4",h===x.name?"opacity-100":"opacity-0")})]},x.id))})]})})]})}function Te({items:n,onItemChange:j,onAddItem:l,onRemoveItem:i,onCopyItem:p,vendors:h}){n.reduce((a,t)=>a+(t.price||0),0);const s=(a,t,d)=>{if(t==="quantity"||t==="unitPrice"){const N=[...n],v=Pe(d);N[a]={...N[a],[t]:v};const x=B(t==="quantity"?v:N[a].quantity,t==="unitPrice"?v:N[a].unitPrice);N[a].price=x,j(a,t,v)}else j(a,t,d)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{}),e.jsxs(g,{onClick:l,variant:"outline",size:"sm",className:"gap-2 h-8 px-3 text-sm bg-transparent",children:[e.jsx(V,{className:"w-3 h-3"}),"품목 추가"]})]}),n.map((a,t)=>e.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("h4",{className:"text-xs font-medium text-gray-700",children:["품목 #",t+1]}),e.jsxs("div",{className:"flex gap-1 -space-x-1",children:[e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>p(t),className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-800 hover:bg-blue-50",title:"품목 복사",children:e.jsx(ce,{className:"w-3 h-3"})}),e.jsx(g,{size:"sm",variant:"ghost",onClick:()=>i(t),disabled:n.length===1,className:"h-8 w-8 p-0 text-red-600 hover:text-red-800 hover:bg-red-50 disabled:opacity-50",title:"품목 삭제",children:e.jsx(U,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 border-b pb-1 flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-blue-600"}),"분류 정보"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"대분류"}),e.jsxs(y,{value:a.category,onValueChange:d=>s(t,"category",d),children:[e.jsx(f,{className:"h-8",children:e.jsx(w,{placeholder:"선택"})}),e.jsxs(C,{children:[e.jsx(r,{value:"1.원자재",children:"1.원자재"}),e.jsx(r,{value:"2.부자재",children:"2.부자재"}),e.jsx(r,{value:"3.시공노무비",children:"3.시공노무비"}),e.jsx(r,{value:"4.장비비",children:"4.장비비"}),e.jsx(r,{value:"5.운반비",children:"5.운반비"}),e.jsx(r,{value:"6.안전관리비",children:"6.안전관리비"}),e.jsx(r,{value:"7.폐기물처리비",children:"7.폐기물처리비"}),e.jsx(r,{value:"8.현장관리비",children:"8.현장관리비"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"중분류"}),e.jsxs(y,{value:a.subCategory1,onValueChange:d=>s(t,"subCategory1",d),children:[e.jsx(f,{className:"h-8",children:e.jsx(w,{placeholder:"선택"})}),e.jsxs(C,{children:[e.jsx(r,{value:"ALUM.SHEET",children:"ALUM.SHEET"}),e.jsx(r,{value:"ALUM.창호",children:"ALUM.창호"}),e.jsx(r,{value:"판넬",children:"판넬"}),e.jsx(r,{value:"창호",children:"창호"}),e.jsx(r,{value:"기타",children:"기타"}),e.jsx(r,{value:"창호,판넬",children:"창호,판넬"}),e.jsx(r,{value:"조립비",children:"조립비"}),e.jsx(r,{value:"유리",children:"유리"}),e.jsx(r,{value:"장비비",children:"장비비"}),e.jsx(r,{value:"신호수 외",children:"신호수 외"}),e.jsx(r,{value:"안전장비",children:"안전장비"}),e.jsx(r,{value:"건강검진",children:"건강검진"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"소분류"}),e.jsxs(y,{value:a.subCategory2,onValueChange:d=>s(t,"subCategory2",d),children:[e.jsx(f,{className:"h-8",children:e.jsx(w,{placeholder:"선택"})}),e.jsxs(C,{children:[e.jsx(r,{value:"원자재",children:"원자재"}),e.jsx(r,{value:"가공",children:"가공"}),e.jsx(r,{value:"도장",children:"도장"}),e.jsx(r,{value:"압출",children:"압출"}),e.jsx(r,{value:"단열",children:"단열"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 border-b pb-1 flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-blue-600"}),"품목 및 수량"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"품목명"}),e.jsx(De,{value:a.name,onChange:d=>s(t,"name",d),placeholder:"품목명을 선택하거나 입력하세요"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"수량"}),e.jsx(A,{type:"number",value:a.quantity,onChange:d=>s(t,"quantity",d.target.value),placeholder:"수량",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"단위"}),e.jsxs(y,{value:a.unit,onValueChange:d=>s(t,"unit",d),children:[e.jsx(f,{className:"h-8",children:e.jsx(w,{placeholder:"단위"})}),e.jsxs(C,{children:[e.jsx(r,{value:"EA",children:"EA"}),e.jsx(r,{value:"M",children:"M"}),e.jsx(r,{value:"SET",children:"SET"}),e.jsx(r,{value:"KG",children:"KG"}),e.jsx(r,{value:"TON",children:"TON"})]})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"단가"}),e.jsx(A,{type:"number",value:a.unitPrice,onChange:d=>s(t,"unitPrice",d.target.value),placeholder:"단가",className:"h-8 text-sm"})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"금액"}),e.jsx("div",{className:"h-8 px-3 py-1 text-sm font-semibold text-blue-600 bg-gray-50 border rounded-md flex items-center",children:q(a.price||0)})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h5",{className:"text-sm font-medium text-gray-700 border-b pb-1 flex items-center gap-2",children:[e.jsx(R,{className:"h-4 w-4 text-blue-600"}),"거래처 및 납품 정보"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"거래처"}),e.jsxs(y,{value:a.vendorId?.toString(),onValueChange:d=>s(t,"vendorId",d),children:[e.jsx(f,{className:"h-8",children:e.jsx(w,{placeholder:"거래처 선택"})}),e.jsx(C,{children:h.map(d=>e.jsx(r,{value:d.id.toString(),children:d.name},d.id))})]})]}),e.jsxs("div",{children:[e.jsx(o,{className:"text-xs text-gray-600",children:"납품장소"}),e.jsx(A,{value:a.deliveryLocation||"",onChange:d=>s(t,"deliveryLocation",d.target.value),placeholder:"납품장소",className:"h-8 text-sm"})]})]})]})]})]},t)),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"총 금액"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:q(n.reduce((a,t)=>a+(t.price||0),0))})]})})]})}function qe({uploadedFiles:n,onFilesChange:j}){return e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"bg-gray-50 border-b",children:e.jsxs(k,{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(xe,{className:"h-5 w-5 text-blue-600"}),"파일 첨부 및 기타 정보"]})}),e.jsxs(P,{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs(o,{htmlFor:"fileUpload",className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"파일 첨부"]}),e.jsx(A,{type:"file",id:"fileUpload",multiple:!0,className:"h-10",onChange:l=>{if(l.target.files){const i=Array.from(l.target.files);j([...n,...i])}}})]}),n.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"text-sm font-medium",children:"첨부된 파일"}),e.jsx("div",{className:"space-y-1",children:n.map((l,i)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm",children:l.name}),e.jsx("button",{onClick:()=>{const p=n.filter((h,s)=>s!==i);j(p)},className:"text-red-500 hover:text-red-700",children:e.jsx(U,{className:"h-4 w-4"})})]},i))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{className:"text-sm font-medium",children:"파일이 성공적으로 업로드되었습니다."}),e.jsx("p",{className:"text-sm text-gray-600",children:n.length>0?`${n.length}개의 파일이 첨부되었습니다.`:"파일을 선택하여 업로드하세요."})]})]})]})}function Le({isOpen:n,onClose:j,formData:l,items:i,poNumber:p}){const h=i.reduce((s,a)=>s+(a.price||0),0);return e.jsx(se,{open:n,onOpenChange:j,children:e.jsxs(ae,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[e.jsx(re,{children:e.jsxs(le,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"PDF 미리보기"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(je,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(g,{variant:"outline",size:"sm",onClick:j,children:e.jsx(ge,{className:"h-4 w-4"})})]})]})}),e.jsx("div",{className:"bg-white p-8 shadow-lg",style:{width:"190mm",minHeight:"297mm",margin:"0 auto"},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-xl font-bold",children:"구매 발주서"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Purchase Order"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"발주서 번호:"})," ",p]}),e.jsxs("p",{children:[e.jsx("strong",{children:"작성일:"})," ",new Date().toLocaleDateString("ko-KR")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"현장:"})," ",l.site]})]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"납품 희망일:"})," ",l.deliveryDate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"자재 인수자:"})," ",l.receiver]}),e.jsxs("p",{children:[e.jsx("strong",{children:"본사 담당자:"})," ",l.manager]})]})]}),e.jsx("div",{className:"border border-gray-300",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-gray-300 p-1",children:"No"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"대분류"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"중분류"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"소분류"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"품목명"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"규격"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"수량"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"단위"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"단가"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"금액"}),e.jsx("th",{className:"border border-gray-300 p-1",children:"납품처"})]})}),e.jsxs("tbody",{children:[i.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 p-1 text-center",children:a+1}),e.jsx("td",{className:"border border-gray-300 p-1",children:s.category}),e.jsx("td",{className:"border border-gray-300 p-1",children:s.subCategory1}),e.jsx("td",{className:"border border-gray-300 p-1",children:s.subCategory2}),e.jsx("td",{className:"border border-gray-300 p-1",children:s.item}),e.jsx("td",{className:"border border-gray-300 p-1",children:s.name}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:s.quantity}),e.jsx("td",{className:"border border-gray-300 p-1 text-center",children:s.unit}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:q(parseInt(s.unitPrice)||0)}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:q(s.price)}),e.jsx("td",{className:"border border-gray-300 p-1",children:s.deliveryLocation})]},a)),e.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[e.jsx("td",{colSpan:9,className:"border border-gray-300 p-1 text-center",children:"합계"}),e.jsx("td",{className:"border border-gray-300 p-1 text-right",children:q(h)}),e.jsx("td",{className:"border border-gray-300 p-1"})]})]})]})}),l.notes&&e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{children:e.jsx("strong",{children:"특이사항:"})}),e.jsx("p",{className:"mt-1 p-2 bg-gray-50 border",children:l.notes})]}),e.jsxs("div",{className:"grid grid-cols-5 gap-4 text-xs mt-8",children:[e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"담당"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"공무"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"팀장"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"임원"}),e.jsx("div",{className:"h-12"})]}),e.jsxs("div",{className:"border border-gray-300 p-2 text-center",children:[e.jsx("p",{className:"font-semibold",children:"사장"}),e.jsx("div",{className:"h-12"})]})]}),e.jsxs("div",{className:"text-center text-sm mt-8",children:[e.jsx("p",{className:"font-semibold",children:"회사명"}),e.jsx("p",{children:"주소: 서울특별시 강남구"}),e.jsx("p",{children:"전화: 02-1234-5678 | 팩스: 02-1234-5679"})]})]})})]})})}function Ee({approvalStatus:n,onStatusChange:j,onSaveDraft:l,onSendEmail:i,onRequestApproval:p,onSkipApproval:h}){const s=a=>{switch(a){case"draft":return e.jsxs(T,{variant:"secondary",className:"gap-1",children:[e.jsx(O,{className:"h-3 w-3"}),"작성중"]});case"pending":return e.jsxs(T,{variant:"outline",className:"gap-1",children:[e.jsx(O,{className:"h-3 w-3"}),"승인 대기중"]});case"approved":return e.jsxs(T,{variant:"default",className:"gap-1 bg-green-500",children:[e.jsx(K,{className:"h-3 w-3"}),"승인 완료"]});case"rejected":return e.jsxs(T,{variant:"destructive",className:"gap-1",children:[e.jsx(E,{className:"h-3 w-3"}),"승인 반려"]});case"skipped":return e.jsxs(T,{variant:"outline",className:"gap-1",children:[e.jsx(E,{className:"h-3 w-3"}),"승인 생략"]});default:return null}};return e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"bg-gray-50 border-b",children:e.jsxs(k,{className:"text-lg font-semibold text-gray-900 flex items-center justify-between",children:["승인 워크플로우",s(n)]})}),e.jsx(P,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(g,{variant:"outline",onClick:l,className:"gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"임시저장"]}),e.jsxs(g,{variant:"outline",onClick:i,className:"gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"}),"이메일 발송"]}),e.jsxs(g,{variant:"default",onClick:p,className:"gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"승인 요청"]}),e.jsxs(g,{variant:"default",onClick:h,className:"gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"승인 생략"]})]})})]})}function _e(){ee();const[n,j]=u.useState({site:"",deliveryDate:"",isNegotiable:!1,receiver:"",manager:"",notes:"",items:[]}),[l,i]=u.useState([z()]),[p,h]=u.useState([]);u.useState(!1);const[s,a]=u.useState("draft"),[t]=u.useState(Ae());u.useState(!0);const[d,N]=u.useState(!1);u.useState(100);const{data:v=[]}=L({queryKey:["/api/projects"],select:c=>c?.filter(m=>m.isActive)||[]}),{data:x=[]}=L({queryKey:["/api/users"],select:c=>c?.filter(m=>m.isActive)||[]}),{data:M=[]}=L({queryKey:["/api/vendors"],select:c=>c?.filter(m=>m.isActive)||[]}),H=c=>{j(m=>({...m,...c}))},G=(c,m,F)=>{const b=[...l];b[c]={...b[c],[m]:F},(m==="quantity"||m==="unitPrice")&&(b[c].price=B(b[c].quantity,b[c].unitPrice)),i(b)},Z=()=>{const c=l[l.length-1],m=c?{...c,quantity:"",unitPrice:"",price:0}:z();i([...l,m])},W=c=>{if(l.length>1){const m=l.filter((F,b)=>b!==c);i(m)}},_=c=>{const m={...l[c]},F=[...l];F.splice(c+1,0,m),i(F)},J=c=>{h(c)},Q=()=>{j(c=>({...c,items:l})),N(!0)},$=c=>{a(c)};l.reduce((c,m)=>c+(m.price||0),0);const X=()=>{switch(s){case"draft":return e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full"}),"작성중"]});case"pending":return e.jsxs("div",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),"승인 대기중"]});case"approved":return e.jsxs("div",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"승인 완료"]});case"skipped":return e.jsxs("div",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium flex items-center gap-1",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"승인 생략"]});default:return null}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"표준 발주서 작성"}),e.jsx("p",{className:"text-sm text-gray-600",children:"통합된 표준 발주서를 작성합니다"})]}),X()]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"bg-white border px-2 py-1 rounded text-xs",children:t}),e.jsx("div",{className:"bg-white border px-2 py-1 rounded text-xs",children:new Date().toLocaleDateString("ko-KR")})]})]}),e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"bg-gray-50 border-b p-3",children:e.jsxs(k,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-blue-600"}),"기본 정보 입력"]})}),e.jsx(P,{className:"p-3",children:e.jsx(Fe,{formData:n,onFormDataChange:H,projects:v,users:x,poNumber:t})})]}),e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"bg-gray-50 border-b p-3",children:e.jsxs(k,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-blue-600"}),"품목 정보 입력"]})}),e.jsx(P,{className:"p-3",children:e.jsx(Te,{items:l,onItemChange:G,onAddItem:Z,onRemoveItem:W,onCopyItem:_,vendors:M})})]}),e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"bg-gray-50 border-b p-3",children:e.jsxs(k,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-blue-600"}),"파일 첨부"]})}),e.jsx(P,{className:"p-3",children:e.jsx(qe,{uploadedFiles:p,onFilesChange:J})})]}),e.jsxs(S,{className:"shadow-sm hover:shadow-md transition-shadow",children:[e.jsx(I,{className:"bg-gray-50 border-b p-3",children:e.jsxs(k,{className:"text-base font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-blue-600"}),"승인 및 제출 관리"]})}),e.jsx(P,{className:"p-3",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(Ee,{approvalStatus:s,onStatusChange:$,onSaveDraft:()=>console.log("Save draft"),onSendEmail:()=>console.log("Send email"),onRequestApproval:()=>console.log("Request approval"),onSkipApproval:()=>console.log("Skip approval")}),e.jsx("div",{className:"pt-3 border-t",children:e.jsxs(g,{onClick:Q,className:"w-full gap-2",size:"lg",children:[e.jsx(ve,{className:"w-4 h-4"}),"PDF 미리보기"]})})]})})]})]})}),e.jsx(Le,{isOpen:d,onClose:()=>N(!1),formData:n,items:l,poNumber:t})]})}export{_e as default};
