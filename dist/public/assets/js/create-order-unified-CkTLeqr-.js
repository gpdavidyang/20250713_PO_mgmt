import{i as ce,r as p,j as e,a as Ge,o as O,n as M,y as z,z as V,ah as is,q as $,F as G,ag as _,C as B,m as j,A as Je,E as Se,S as De,k as se,x as ue,L as I,I as U,P as pe,ac as ns,ad as cs,af as ds,U as os,X as ve,ae as ms,g as xs,ai as Ce,u as hs,b as us}from"./index-CKOkJa8a.js";import{A as de,a as oe}from"./alert-CF8EnreZ.js";import{Z as _e}from"./zap-dYSlFGXZ.js";import{C as re}from"./clock-De_6yytQ.js";import{U as le}from"./users-CrIWLVqy.js";import{P as Pe}from"./progress-COB_TDbw.js";import{S as He}from"./separator-BKY3thcv.js";import{C as he}from"./circle-check-BXI8NhvH.js";import{R as ae}from"./refresh-cw-CfT0i5Dw.js";import{C as Me}from"./circle-x-BJyqC2uL.js";import{A as je}from"./arrow-right-B7tXqDpY.js";import{I as fe}from"./info-BsQweOSQ.js";import{D as me}from"./download-CCsOWxaH.js";import{P as Te}from"./paperclip-BjCx_o-z.js";import{M as ne}from"./mail-DzL2Osuv.js";import{S as Ze}from"./shield-By2cU8gc.js";import{U as $e}from"./upload-BY32MIAA.js";import{T as Ee}from"./textarea-C8421qec.js";import{S as H,a as Z,b as X,c as Q,d as L}from"./select-DmFFwEDq.js";import{C as Le}from"./checkbox-CLetaLPZ.js";import{g as ps,b as Ue}from"./order-utils-C4eLdozv.js";import{P as Xe}from"./package-DVdn3byl.js";import{T as js}from"./trash-2-CvqwPzWA.js";import{D as gs}from"./dollar-sign-CdNtU-dJ.js";import{C as Ns}from"./calendar-BSZTCtl4.js";import{a as ye,b as be,c as we,D as ie,f as Fe}from"./dialog-CV4umqpv.js";import{T as Oe,a as Re,b as Y,c as ee}from"./tabs-Dr3qMsD-.js";import{P as Qe}from"./printer-zUj_zQ-w.js";import{S as qe}from"./switch-B3Ni7jqf.js";import{P as vs}from"./phone-fTUgF5uF.js";import{S as fs}from"./search-TK8I58x6.js";import{S as Ie}from"./save-Cr1utZ58.js";import{S as ys}from"./send-B0dxOCLn.js";import{A as bs}from"./archive-DqPpZwO6.js";import{T as ws}from"./triangle-alert-BBaPDX6h.js";import{T as ze}from"./trending-up-BUR_cU-e.js";import{C as Ss}from"./chevron-left-C9LmZzaw.js";import{A as Cs}from"./arrow-left-BWU8ue7L.js";import"./index-CAd-gX2w.js";import"./chevron-down-DecYLFH6.js";import"./chevron-up-BJNKxpa8.js";import"./index-B9HGYmaA.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=ce("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=ce("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=ce("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=ce("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=ce("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=ce("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=ce("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),q=[];for(let s=0;s<256;++s)q.push((s+256).toString(16).slice(1));function Es(s,t=0){return(q[s[t+0]]+q[s[t+1]]+q[s[t+2]]+q[s[t+3]]+"-"+q[s[t+4]]+q[s[t+5]]+"-"+q[s[t+6]]+q[s[t+7]]+"-"+q[s[t+8]]+q[s[t+9]]+"-"+q[s[t+10]]+q[s[t+11]]+q[s[t+12]]+q[s[t+13]]+q[s[t+14]]+q[s[t+15]]).toLowerCase()}let ke;const Is=new Uint8Array(16);function As(){if(!ke){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ke=crypto.getRandomValues.bind(crypto)}return ke(Is)}const Ds=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),We={randomUUID:Ds};function Ke(s,t,i){if(We.randomUUID&&!t&&!s)return We.randomUUID();s=s||{};const o=s.random??s.rng?.()??As();if(o.length<16)throw new Error("Random bytes length must be >= 16");return o[6]=o[6]&15|64,o[8]=o[8]&63|128,Es(o)}const _s={PDF_GENERATION:{id:"pdf_generation",title:"PDF 생성",description:"발주서를 PDF로 변환하고 있습니다"},VENDOR_VALIDATION:{id:"vendor_validation",title:"거래처 검증",description:"거래처 정보를 확인하고 있습니다"},EMAIL_PREPARATION:{id:"email_preparation",title:"이메일 준비",description:"이메일을 작성하고 있습니다"},ATTACHMENT_PROCESSING:{id:"attachment_processing",title:"첨부파일 처리",description:"첨부파일을 준비하고 있습니다"},FINAL_VALIDATION:{id:"final_validation",title:"최종 검증",description:"모든 정보를 최종 확인하고 있습니다"}},es={select:{title:"방식 선택",description:"표준/엑셀 선택",required:!0,validation:s=>!!s.creationMethod},create:{title:"발주서 작성",description:"데이터 입력",required:!0,validation:s=>s.stepStates.creation.isValid},approve:{title:"승인 처리",description:"선택적",required:!1,validation:s=>!s.stepStates.approval.required||s.stepStates.approval.status==="approved"},process:{title:"후처리",description:"PDF/이메일",required:!0,validation:s=>s.stepStates.processing.failedSteps.length===0},complete:{title:"완료",description:"결과 확인",required:!0,validation:s=>!!s.stepStates.completed.savedAt}},ss=p.createContext(void 0),ts=()=>({currentStep:"select",steps:Object.entries(es).map(([s,t])=>({id:s,title:t.title,description:t.description,status:s==="select"?"current":"pending"})),stepStates:{creation:{isValid:!1},approval:{required:!1},processing:{steps:Object.values(_s).map(s=>({...s,status:"idle"})),completedSteps:[],failedSteps:[]},completed:{}},metadata:{workflowId:Ke(),startedAt:new Date,lastModified:new Date,userId:"",sessionId:Ke(),version:"1.0.0"},flags:{skipApproval:!1,autoProcess:!0,sendEmails:!0,generatePDF:!0}}),Fs=(s,t)=>{switch(t.type){case"SET_STEP":return{...s,currentStep:t.payload,steps:s.steps.map(c=>({...c,status:c.id===t.payload?"current":s.steps.findIndex(u=>u.id===c.id)<s.steps.findIndex(u=>u.id===t.payload)?"completed":"pending"})),metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_STEP_STATUS":return{...s,steps:s.steps.map(c=>c.id===t.payload.step?{...c,status:t.payload.status}:c),metadata:{...s.metadata,lastModified:new Date}};case"SET_CREATION_METHOD":return{...s,creationMethod:t.payload,stepStates:{...s.stepStates,creation:{...s.stepStates.creation,method:t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_ORDER_DATA":return{...s,orderData:t.payload,metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_CREATION_STATE":return{...s,stepStates:{...s.stepStates,creation:{...s.stepStates.creation,...t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_APPROVAL_STATE":return{...s,stepStates:{...s.stepStates,approval:{...s.stepStates.approval,...t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_PROCESSING_STEP":const i=s.stepStates.processing.steps.map(c=>c.id===t.payload.stepId?{...c,...t.payload.update}:c),o=i.filter(c=>c.status==="completed").map(c=>c.id),m=i.filter(c=>c.status==="error").map(c=>c.id);return{...s,stepStates:{...s.stepStates,processing:{...s.stepStates.processing,steps:i,completedSteps:o,failedSteps:m}},metadata:{...s.metadata,lastModified:new Date}};case"UPDATE_COMPLETED_STATE":return{...s,stepStates:{...s.stepStates,completed:{...s.stepStates.completed,...t.payload}},metadata:{...s.metadata,lastModified:new Date}};case"SET_FLAGS":return{...s,flags:{...s.flags,...t.payload},metadata:{...s.metadata,lastModified:new Date}};case"RESET_WORKFLOW":return ts();default:return s}},Os=({children:s})=>{const[t,i]=p.useReducer(Fs,ts()),o=["select","create","approve","process","complete"],m=p.useCallback(()=>o.indexOf(t.currentStep),[t.currentStep]),c=p.useCallback(()=>{const b=es[t.currentStep];return b.validation?b.validation(t):!0},[t]),u=p.useCallback(()=>{const b=m();if(b<o.length-1){const D=o[b+1];D==="approve"&&!t.stepStates.approval.required?(i({type:"UPDATE_STEP_STATUS",payload:{step:"approve",status:"skipped"}}),i({type:"SET_STEP",payload:"process"})):i({type:"SET_STEP",payload:D})}},[m,t.stepStates.approval.required]),f=p.useCallback(()=>{const b=m();if(b>0){const D=o[b-1];D==="approve"&&t.steps.find(A=>A.id==="approve")?.status==="skipped"?i({type:"SET_STEP",payload:"create"}):i({type:"SET_STEP",payload:D})}},[m,t.steps]),w=p.useCallback(b=>{i({type:"SET_STEP",payload:b})},[]),a=p.useCallback(b=>{i({type:"SET_CREATION_METHOD",payload:b})},[]),v=p.useCallback(b=>{i({type:"UPDATE_ORDER_DATA",payload:b})},[]),N=p.useCallback((b,D)=>{i({type:"UPDATE_PROCESSING_STEP",payload:{stepId:b,update:D}})},[]),F=p.useCallback(b=>t.steps.find(D=>D.id===b),[t.steps]);p.useEffect(()=>{localStorage.getItem(`workflow_${t.metadata.workflowId}`)||localStorage.setItem(`workflow_${t.metadata.workflowId}`,JSON.stringify(t))},[t]);const E={state:t,dispatch:i,goToNextStep:u,goToPreviousStep:f,goToStep:w,setCreationMethod:a,updateOrderData:v,updateProcessingStep:N,canProceed:c,getCurrentStepIndex:m,getStepStatus:F};return e.jsx(ss.Provider,{value:E,children:s})},Rs=()=>{const s=p.useContext(ss);if(!s)throw new Error("useOrderWorkflow must be used within OrderWorkflowProvider");return s},Ms=(s,t=!1)=>{const i=["select","create","approve","process","complete"],o=i.indexOf(s);if(o===-1||o===i.length-1)return null;const m=i[o+1];return m==="approve"&&t?i[o+2]||null:m},$s=(s,t=!1)=>{const i=["select","create","approve","process","complete"],o=i.indexOf(s);if(o<=0)return null;const m=i[o-1];return m==="approve"&&t?i[o-2]||null:m},Ls=s=>{const t=s.steps.filter(o=>o.id!=="approve"||s.stepStates.approval.required).length,i=s.steps.filter(o=>o.status==="completed"||o.status==="skipped").length;return Math.round(i/t*100)},Us=s=>{const t={select:1,create:5,approve:10,process:3,complete:1};return s.steps.filter(o=>o.status==="pending"||o.status==="current").reduce((o,m)=>m.id==="approve"&&!s.stepStates.approval.required?o:o+(t[m.id]||0),0)},qs=(s,t)=>{const i={};return s==="standard"?(t?.projectId||(i.projectId="프로젝트를 선택해주세요"),t?.vendorId||(i.vendorId="거래처를 선택해주세요"),(!t?.items||t.items.length===0)&&(i.items="품목을 추가해주세요"),t?.orderDate||(i.orderDate="발주일자를 입력해주세요"),t?.deliveryDate||(i.deliveryDate="납기일자를 입력해주세요")):s==="excel"&&(t?((!t.type||t.type!=="excel")&&(i.type="엑셀 업로드 형식이 올바르지 않습니다"),(!t.orders||t.orders.length===0)&&(i.orders="파싱된 발주서 데이터가 없습니다"),t.filePath||(i.filePath="파일 경로가 없습니다"),t.parseErrors&&t.parseErrors.length>0&&(i.parse="엑셀 파일 파싱 중 오류가 발생했습니다")):i.data="업로드된 데이터가 없습니다"),{isValid:Object.keys(i).length===0,errors:i}},zs=s=>{const t=[];return s.generatePDF&&t.push({id:"pdf_generation",title:"PDF 생성",description:"발주서를 PDF로 변환하고 있습니다",status:"idle"}),t.push({id:"vendor_validation",title:"거래처 검증",description:"거래처 정보를 확인하고 있습니다",status:"idle"}),s.sendEmails&&(t.push({id:"email_preparation",title:"이메일 준비",description:"이메일을 작성하고 있습니다",status:"idle"}),t.push({id:"attachment_processing",title:"첨부파일 처리",description:"첨부파일을 준비하고 있습니다",status:"idle"})),t.push({id:"final_validation",title:"최종 검증",description:"모든 정보를 최종 확인하고 있습니다",status:"idle"}),t},Vs=s=>{const t=`workflow_${s.metadata.workflowId}`;localStorage.setItem(t,JSON.stringify(s));const i=as(),o=[{id:s.metadata.workflowId,date:s.metadata.lastModified},...i.filter(m=>m.id!==s.metadata.workflowId)].slice(0,10);localStorage.setItem("recentWorkflows",JSON.stringify(o))},Ws=s=>{const t=`workflow_${s}`,i=localStorage.getItem(t);if(!i)return null;try{return JSON.parse(i)}catch(o){return console.error("Failed to parse workflow state:",o),null}},as=()=>{const s=localStorage.getItem("recentWorkflows");if(!s)return[];try{return JSON.parse(s)}catch{return[]}},Ks=s=>s.status==="error"&&!["final_validation"].includes(s.id),Bs=s=>Math.min(1e3*Math.pow(2,s),3e4),Gs=(s,t)=>{if(!s)return"-";const o=(t||new Date).getTime()-s.getTime(),m=Math.floor(o/1e3);if(m<60)return`${m}초`;const c=Math.floor(m/60),u=m%60;return`${c}분 ${u}초`},Js=s=>({select:"📋",create:"✏️",approve:"✅",process:"⚙️",complete:"🎉"})[s]||"📄",Hs=s=>({pending:"text-gray-500 bg-gray-100",current:"text-blue-700 bg-blue-100",completed:"text-green-700 bg-green-100",error:"text-red-700 bg-red-100",skipped:"text-gray-400 bg-gray-50"})[s]||"text-gray-500 bg-gray-100",J={getNextStep:Ms,getPreviousStep:$s,calculateWorkflowProgress:Ls,estimateRemainingTime:Us,validateCreationData:qs,createProcessingPipeline:zs,saveWorkflowState:Vs,loadWorkflowState:Ws,getRecentWorkflows:as,canRetryStep:Ks,getRetryDelay:Bs,formatStepDuration:Gs,getStepIcon:Js,getStatusColor:Hs},Ae={post:async(s,t)=>s.includes("check-approval")?{data:{required:t.amount>1e6}}:s.includes("generate-pdf")?{data:{url:"/api/downloads/order.pdf"}}:s.includes("validate")?{data:{valid:!0,suggestions:[]}}:{data:{}}},Zs=()=>{const s=Rs(),{toast:t}=Ge(),[i,o]=p.useState(!1),[m,c]=p.useState(null),u=s.canProceed(),f=s.getCurrentStepIndex()>0,w=J.calculateWorkflowProgress(s.state),a=J.estimateRemainingTime(s.state),v=p.useCallback(()=>{if(!u){t({title:"진행할 수 없습니다",description:"현재 단계를 완료해주세요",variant:"destructive"});return}s.goToNextStep()},[u,s,t]),N=p.useCallback(()=>{f&&s.goToPreviousStep()},[f,s]),F=p.useCallback(C=>{const S=["select","create","approve","process","complete"].indexOf(C),T=s.getCurrentStepIndex();if(S>T+1){t({title:"이동할 수 없습니다",description:"이전 단계를 먼저 완료해주세요",variant:"destructive"});return}s.goToStep(C)},[s,t]),E=p.useCallback(C=>{s.setCreationMethod(C),setTimeout(()=>{s.goToNextStep()},500)},[s]),b=p.useCallback(async C=>{try{const S=J.validateCreationData(s.state.creationMethod,C);if(!S.isValid){const d=Object.values(S.errors).join(", ");t({title:"입력 오류",description:d||"필수 항목을 모두 입력해주세요",variant:"destructive"}),console.error("Validation errors:",S.errors),console.error("Submitted data:",C);return}s.updateOrderData(C),s.dispatch({type:"UPDATE_CREATION_STATE",payload:{data:C,isValid:!0,validationErrors:{}}});const T=await Xs(C);s.dispatch({type:"UPDATE_APPROVAL_STATE",payload:{required:T}}),J.saveWorkflowState(s.state),t({title:"저장 완료",description:"발주서 정보가 저장되었습니다"}),setTimeout(()=>{s.goToNextStep()},1e3)}catch(S){console.error("Failed to submit order data:",S),t({title:"저장 실패",description:"발주서 저장 중 오류가 발생했습니다",variant:"destructive"})}},[s,t]),D=p.useCallback(async()=>{o(!0);try{const C=J.createProcessingPipeline(s.state.flags);for(const S of C){c(S.id),s.updateProcessingStep(S.id,{status:"processing"});try{const T=await Be(S,s.state);s.updateProcessingStep(S.id,{status:"completed",result:T,progress:100})}catch(T){throw s.updateProcessingStep(S.id,{status:"error",error:T.message}),T}}s.dispatch({type:"UPDATE_COMPLETED_STATE",payload:{savedAt:new Date,orderNumber:s.state.orderData?.orderNumber,nextActions:["발주서 목록 보기","새 발주서 작성"]}}),J.saveWorkflowState(s.state),s.goToNextStep(),t({title:"처리 완료",description:"발주서가 성공적으로 처리되었습니다"})}catch(C){t({title:"처리 실패",description:C.message||"처리 중 오류가 발생했습니다",variant:"destructive"})}finally{o(!1),c(null)}},[s,t]),A=p.useCallback(async C=>{const S=s.state.stepStates.processing.steps.find(T=>T.id===C);if(!(!S||!J.canRetryStep(S))){o(!0),c(C);try{s.updateProcessingStep(C,{status:"processing"});const T=await Be(S,s.state);s.updateProcessingStep(C,{status:"completed",result:T,progress:100}),t({title:"재시도 성공",description:`${S.title} 단계가 성공적으로 완료되었습니다`}),s.state.stepStates.processing.failedSteps.length===1&&await D()}catch(T){s.updateProcessingStep(C,{status:"error",error:T.message}),t({title:"재시도 실패",description:T.message||"재시도 중 오류가 발생했습니다",variant:"destructive"})}finally{o(!1),c(null)}}},[s,D,t]),x=p.useCallback(()=>{J.saveWorkflowState(s.state),t({title:"저장 완료",description:"진행 상황이 저장되었습니다"})},[s.state,t]),R=p.useCallback(C=>{const S=J.loadWorkflowState(C);t(S?{title:"불러오기 완료",description:"저장된 진행 상황을 불러왔습니다"}:{title:"불러오기 실패",description:"저장된 진행 상황을 찾을 수 없습니다",variant:"destructive"})},[t]);return p.useEffect(()=>{const C=setTimeout(()=>{J.saveWorkflowState(s.state)},2e3);return()=>clearTimeout(C)},[s.state]),{workflow:s.state,isProcessing:i,currentProcessingStep:m,canGoNext:u,canGoPrevious:f,goNext:v,goPrevious:N,goToStep:F,selectCreationMethod:E,submitOrderData:b,startProcessing:D,retryProcessingStep:A,progress:w,estimatedTime:a,saveProgress:x,loadProgress:R}};async function Xs(s){try{return(await Ae.post("/api/orders/check-approval",{amount:s.totalAmount,projectId:s.projectId})).data.required}catch{return!0}}async function Be(s,t){switch(await new Promise(i=>setTimeout(i,1e3)),s.id){case"pdf_generation":return{pdfUrl:(await Ae.post("/api/orders/generate-pdf",{orderData:t.orderData})).data.url};case"vendor_validation":const o=await Ae.post("/api/vendors/validate",{vendorId:t.orderData.vendorId,vendorEmail:t.orderData.vendorEmail});return{isValid:o.data.valid,suggestions:o.data.suggestions};case"email_preparation":return{subject:`발주서 - ${t.orderData.orderNumber}`,recipients:[t.orderData.vendorEmail],body:"발주서를 첨부합니다."};case"attachment_processing":return{attachments:["purchase_order.pdf","additional_docs.zip"]};case"final_validation":return{allChecksPass:!0};default:throw new Error(`Unknown processing step: ${s.id}`)}}const Qs=[{id:"excel",title:"엑셀 발주서",description:"엑셀 파일을 업로드하여 발주서를 자동으로 생성합니다",icon:e.jsx(Je,{className:"w-8 h-8 text-green-600"}),features:["다량의 발주서 일괄 처리","기존 엑셀 양식 활용","자동 데이터 파싱","거래처 자동 검증","PDF 변환 및 이메일 발송"],pros:["빠른 대량 처리","기존 업무 방식 유지","자동화된 후처리"],cons:["엑셀 양식 준수 필요","오류 시 일괄 수정 어려움"],estimatedTime:"3-5분",difficulty:"easy",recommended:!0},{id:"standard",title:"표준 발주서",description:"웹 폼을 통해 발주서를 직접 입력하여 생성합니다",icon:e.jsx(Ye,{className:"w-8 h-8 text-blue-600"}),features:["직관적인 웹 폼 인터페이스","실시간 입력 검증","단계별 승인 워크플로우","개별 발주서 정밀 관리","PDF 미리보기"],pros:["정확한 데이터 입력","유연한 수정 가능","승인 워크플로우 지원"],cons:["개별 입력으로 시간 소요","대량 처리 시 비효율적"],estimatedTime:"5-10분",difficulty:"medium"}],Ys=s=>{switch(s){case"easy":return"bg-green-100 text-green-800";case"medium":return"bg-yellow-100 text-yellow-800";case"hard":return"bg-red-100 text-red-800"}},et=({onMethodSelect:s,disabled:t=!1})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"발주서 작성 방식 선택"}),e.jsx("p",{className:"text-gray-600",children:"프로젝트 요구사항에 맞는 발주서 작성 방식을 선택해주세요"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto",children:Qs.map(i=>e.jsxs(O,{className:`relative transition-all duration-300 hover:shadow-xl hover:-translate-y-1 transform ${i.recommended?"ring-2 ring-blue-500 ring-opacity-50":""} ${t?"opacity-50":""} h-full flex flex-col`,children:[i.recommended&&e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsxs(M,{className:"bg-blue-600 text-white px-3 py-1",children:[e.jsx(_e,{className:"w-3 h-3 mr-1"}),"추천"]})}),e.jsxs(z,{className:"pb-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[i.icon,e.jsxs("div",{children:[e.jsx(V,{className:"text-xl",children:i.title}),e.jsx(is,{className:"mt-1",children:i.description})]})]})}),e.jsxs("div",{className:"flex items-center space-x-4 mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{children:i.estimatedTime})]}),e.jsx(M,{variant:"secondary",className:Ys(i.difficulty),children:i.difficulty==="easy"?"쉬움":i.difficulty==="medium"?"보통":"어려움"})]})]}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[e.jsx(G,{className:"w-4 h-4 mr-1"}),"주요 기능"]}),e.jsx("ul",{className:"space-y-1",children:i.features.map((o,m)=>e.jsxs("li",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(_,{className:"w-3 h-3 text-green-500 mr-2 flex-shrink-0"}),o]},m))})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-green-700 mb-2 flex items-center text-sm",children:[e.jsx(_,{className:"w-4 h-4 mr-1"}),"장점"]}),e.jsx("ul",{className:"space-y-1",children:i.pros.map((o,m)=>e.jsxs("li",{className:"text-xs text-green-600 ml-5",children:["• ",o]},m))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-orange-700 mb-2 flex items-center text-sm",children:[e.jsx(B,{className:"w-4 h-4 mr-1"}),"고려사항"]}),e.jsx("ul",{className:"space-y-1",children:i.cons.map((o,m)=>e.jsxs("li",{className:"text-xs text-orange-600 ml-5",children:["• ",o]},m))})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(j,{onClick:()=>s(i.id),disabled:t,className:`w-full h-12 ${i.id==="excel"?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,size:"lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[i.icon,e.jsxs("span",{children:[i.title," 선택"]})]})})})]})]},i.id))}),e.jsx(O,{className:"bg-blue-50 border-blue-200",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(le,{className:"w-4 h-4 text-blue-600"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-1",children:"어떤 방식을 선택해야 할까요?"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"엑셀 발주서"}),": 여러 개의 발주서를 한 번에 처리해야 하거나, 기존 엑셀 양식이 있는 경우"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"표준 발주서"}),": 개별 발주서를 정확히 관리하고 싶거나, 승인 워크플로우가 필요한 경우"]})]})]})]})})})]}),st=s=>{switch(s.id){case"pdf_generation":return e.jsx(G,{className:"w-5 h-5"});case"vendor_validation":return e.jsx(Ze,{className:"w-5 h-5"});case"email_preparation":return e.jsx(ne,{className:"w-5 h-5"});case"attachment_processing":return e.jsx(Te,{className:"w-5 h-5"});case"final_validation":return e.jsx(_,{className:"w-5 h-5"});default:return e.jsx(_,{className:"w-5 h-5"})}},tt=s=>{switch(s){case"completed":return"text-green-600 bg-green-50 border-green-200";case"processing":return"text-blue-600 bg-blue-50 border-blue-200";case"error":return"text-red-600 bg-red-50 border-red-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},at=s=>{switch(s.status){case"completed":return e.jsx(_,{className:"w-6 h-6 text-green-600"});case"processing":return e.jsx(ae,{className:"w-6 h-6 text-blue-600 animate-spin"});case"error":return e.jsx(B,{className:"w-6 h-6 text-red-600"});default:return e.jsx("div",{className:"w-6 h-6 border-2 border-gray-300 rounded-full"})}},te=s=>s<60?`${s}초`:s<3600?`${Math.floor(s/60)}분 ${s%60}초`:`${Math.floor(s/3600)}시간 ${Math.floor(s%3600/60)}분`,rt=({steps:s,currentStep:t,onRetry:i,onPreview:o,onEdit:m,onPause:c,onResume:u,onSkip:f,onCancel:w,isProcessing:a=!1,isPaused:v=!1,canPause:N=!1,canSkip:F=!1,totalElapsedTime:E=0,estimatedTimeRemaining:b,onStepComplete:D,maxRetries:A=3})=>{const[x,R]=p.useState(new Date),[C,S]=p.useState(new Set);p.useEffect(()=>{const l=setInterval(()=>{R(new Date)},1e3);return()=>clearInterval(l)},[]);const T=s.filter(l=>l.status==="completed").length,d=s.length,g=d>0?Math.round(T/d*100):0,r=s.some(l=>l.status==="error"),h=T===d,k=s.find(l=>l.status==="processing"),n=s.filter(l=>l.status==="error"),y=l=>{const P=new Set(C);P.has(l)?P.delete(l):P.add(l),S(P)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"후처리 파이프라인"}),a&&!v&&e.jsxs(M,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:[e.jsx(_e,{className:"w-3 h-3 mr-1"}),"처리 중"]}),v&&e.jsxs(M,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(ge,{className:"w-3 h-3 mr-1"}),"일시정지"]}),r&&e.jsxs(M,{variant:"destructive",className:"bg-red-100 text-red-800",children:[e.jsx(B,{className:"w-3 h-3 mr-1"}),"오류 ",n.length,"개"]}),h&&!r&&e.jsxs(M,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"완료"]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"발주서 생성 후 필요한 작업들을 자동으로 처리합니다"})]}),e.jsxs("div",{className:"text-right space-y-2",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[g,"%"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[T,"/",d," 단계 완료"]}),E>0&&e.jsxs("div",{className:"text-xs text-gray-500",children:["경과: ",te(E)]}),b&&e.jsxs("div",{className:"text-xs text-blue-600",children:[e.jsx(Ne,{className:"w-3 h-3 inline mr-1"}),"예상 ",te(b)," 남음"]}),e.jsx("div",{className:"text-xs text-gray-400",children:x.toLocaleTimeString("ko-KR")})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[a&&N&&!v&&c&&e.jsxs(j,{variant:"outline",size:"sm",onClick:c,className:"text-yellow-600 border-yellow-300 hover:bg-yellow-50",children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"일시정지"]}),v&&u&&e.jsxs(j,{variant:"outline",size:"sm",onClick:u,className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(Ps,{className:"w-4 h-4 mr-1"}),"재개"]}),r&&n.length>0&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>{n.forEach(l=>i?.(l.id))},className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(ae,{className:"w-4 h-4 mr-1"}),"모든 오류 재시도"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:w&&e.jsxs(j,{variant:"outline",size:"sm",onClick:w,disabled:h,className:"text-gray-600 border-gray-300 hover:bg-gray-50",children:[e.jsx(Me,{className:"w-4 h-4 mr-1"}),"취소"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-600",children:"전체 진행률"}),k&&e.jsxs(M,{variant:"outline",className:"text-xs px-2 py-0.5",children:[k.title," 처리 중"]})]}),e.jsxs("span",{className:"font-semibold text-lg",children:[g,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{value:g,className:"h-3"}),a&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-30 animate-pulse rounded-full h-3"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-2",children:[e.jsxs("span",{children:[T,"개 완료"]}),e.jsxs("span",{children:[d-T,"개 남음"]})]})]}),v&&e.jsxs(de,{className:"border-yellow-200 bg-yellow-50",children:[e.jsx(ge,{className:"h-4 w-4 text-yellow-600"}),e.jsx(oe,{className:"text-yellow-800",children:"후처리 작업이 일시정지되었습니다. 재개 버튼을 눌러 계속 진행하세요."})]}),r&&e.jsxs(de,{className:"border-red-200 bg-red-50",children:[e.jsx(B,{className:"h-4 w-4 text-red-600"}),e.jsxs(oe,{className:"text-red-800",children:[e.jsxs("div",{className:"font-medium mb-1",children:[n.length,"개 단계에서 오류가 발생했습니다"]}),e.jsxs("div",{className:"text-sm",children:[n.map(l=>l.title).join(", ")," 단계를 확인하고 재시도해주세요."]})]})]}),h&&!r&&e.jsxs(de,{className:"border-green-200 bg-green-50",children:[e.jsx(_,{className:"h-4 w-4 text-green-600"}),e.jsxs(oe,{className:"text-green-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"모든 후처리 작업이 완료되었습니다!"}),e.jsxs("div",{className:"text-sm",children:["총 ",d,"개 단계가 성공적으로 처리되었습니다.",E>0&&` (소요시간: ${te(E)})`]})]})]}),e.jsx("div",{className:"space-y-3",children:s.map((l,P)=>{const W=C.has(l.id),K=l.retryCount||0,xe=l.status==="error"&&K<A;return e.jsxs(O,{className:`border transition-all duration-300 transform hover:scale-[1.01] ${tt(l.status)} ${l.id===t?"shadow-lg ring-2 ring-blue-200 ring-opacity-50":"shadow-sm"}`,children:[e.jsx(z,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[at(l),l.status==="processing"&&e.jsx("div",{className:"absolute -inset-2 border-2 border-blue-400 rounded-full opacity-30 animate-pulse"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-1",children:[e.jsxs(V,{className:"text-base flex items-center space-x-2",children:[st(l),e.jsx("span",{children:l.title})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[l.status==="processing"&&e.jsxs(M,{variant:"secondary",className:"bg-blue-100 text-blue-800 text-xs px-2 py-0.5",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse mr-1"}),"진행 중"]}),l.status==="completed"&&e.jsxs(M,{variant:"secondary",className:"bg-green-100 text-green-800 text-xs px-2 py-0.5",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"완료"]}),l.status==="error"&&e.jsxs(M,{variant:"destructive",className:"bg-red-100 text-red-800 text-xs px-2 py-0.5",children:[e.jsx(Me,{className:"w-3 h-3 mr-1"}),"오류 ",K>0&&`(${K}/${A} 시도)`]}),l.priority&&e.jsx(M,{variant:"outline",className:"text-xs px-2 py-0.5",children:l.priority==="high"?"높음":l.priority==="medium"?"보통":"낮음"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:l.description}),(l.startedAt||l.completedAt||l.estimatedDuration)&&e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 mt-2",children:[l.startedAt&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(re,{className:"w-3 h-3"}),e.jsxs("span",{children:["시작: ",l.startedAt.toLocaleTimeString("ko-KR")]})]}),l.completedAt&&l.startedAt&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),e.jsxs("span",{children:["소요: ",te(Math.round((l.completedAt.getTime()-l.startedAt.getTime())/1e3))]})]}),l.estimatedDuration&&l.status==="pending"&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),e.jsxs("span",{children:["예상: ",te(l.estimatedDuration)]})]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:["단계 ",P+1,"/",s.length]}),(l.details?.length||l.result||l.error)&&e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>y(l.id),className:"text-xs px-2 py-1 h-6",children:[W?"접기":"펼치기",e.jsx(je,{className:`w-3 h-3 ml-1 transition-transform duration-200 ${W?"rotate-90":""}`})]})]})})]})}),e.jsxs($,{className:"pt-0",children:[l.status==="processing"&&l.progress!==void 0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[e.jsx("span",{className:"font-medium",children:"처리 진행률"}),e.jsxs("span",{className:"font-bold",children:[l.progress,"%"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Pe,{value:l.progress,className:"h-2"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-blue-400 to-transparent opacity-20 animate-pulse rounded-full h-2"})]})]}),W&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(He,{}),l.status==="error"&&l.error&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(B,{className:"w-5 h-5 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-red-800 mb-2",children:"오류 상세 정보"}),e.jsx("div",{className:"text-sm text-red-700 bg-red-100 p-3 rounded border border-red-200 font-mono",children:l.error}),K>0&&e.jsxs("div",{className:"text-xs text-red-600 mt-2",children:["재시도 횟수: ",K,"/",A]})]})]})}),l.details&&l.details.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(fe,{className:"w-4 h-4 text-blue-600"}),e.jsx("div",{className:"font-medium text-blue-800",children:"처리 내용"})]}),e.jsx("ul",{className:"space-y-2",children:l.details.map((rs,ls)=>e.jsxs("li",{className:"flex items-start space-x-3",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700",children:rs})]},ls))})]}),l.status==="completed"&&l.result&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(he,{className:"w-4 h-4 text-green-600"}),e.jsx("div",{className:"font-medium text-green-800",children:"처리 결과"})]}),e.jsx("div",{className:"text-sm text-green-700",children:typeof l.result=="string"?l.result:l.result.message||"성공적으로 처리되었습니다"}),l.result?.details&&e.jsx("div",{className:"mt-2 text-xs text-green-600 bg-green-100 p-2 rounded border border-green-200",children:JSON.stringify(l.result.details,null,2)})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[l.status==="error"&&i&&xe&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>i(l.id),className:"text-red-600 border-red-300 hover:bg-red-50",children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),"재시도 (",A-K,"회 남음)"]}),l.status==="pending"&&F&&f&&l.priority!=="high"&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>f(l.id),className:"text-gray-600 border-gray-300 hover:bg-gray-50",children:[e.jsx(je,{className:"w-3 h-3 mr-1"}),"건너뛰기"]}),l.status==="completed"&&o&&(l.id==="pdf_generation"||l.id==="email_preparation")&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>o(l.id,l.result),className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(Se,{className:"w-3 h-3 mr-1"}),"미리보기"]}),l.status==="completed"&&l.id==="pdf_generation"&&l.result?.pdfUrl&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>window.open(l.result.pdfUrl,"_blank"),className:"text-green-600 border-green-300 hover:bg-green-50",children:[e.jsx(me,{className:"w-3 h-3 mr-1"}),"다운로드"]}),l.status==="completed"&&m&&l.id==="email_preparation"&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>m(l.id,l.result),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(De,{className:"w-3 h-3 mr-1"}),"편집"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[l.status==="completed"&&e.jsxs("div",{className:"text-xs text-green-600 flex items-center",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"완료"]}),l.status==="processing"&&e.jsxs("div",{className:"text-xs text-blue-600 flex items-center",children:[e.jsx(ae,{className:"w-3 h-3 mr-1 animate-spin"}),"처리 중"]})]})]}),P<s.length-1&&e.jsx("div",{className:"flex justify-center mt-4 mb-2",children:e.jsx("div",{className:`w-0.5 h-4 transition-colors duration-300 ${l.status==="completed"?"bg-green-400":l.status==="processing"?"bg-blue-400":l.status==="error"?"bg-red-400":"bg-gray-300"}`})})]})]},l.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:T}),e.jsx("div",{className:"text-sm text-gray-600",children:"완료된 단계"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:s.filter(l=>l.status==="processing").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"처리 중"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:n.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"오류 발생"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600 mb-1",children:s.filter(l=>l.status==="pending").length}),e.jsx("div",{className:"text-sm text-gray-600",children:"대기 중"})]})]}),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4",children:[a&&!v&&e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx(ae,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm font-medium",children:k?`${k.title} 처리 중...`:"처리 중입니다..."})]}),v&&e.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"일시정지됨"})]}),h&&!r&&e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"모든 작업이 완료되었습니다"})]}),r&&e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"오류가 발생한 작업이 있습니다"})]}),!a&&!h&&!r&&!v&&e.jsxs("div",{className:"flex items-center space-x-2 text-gray-600",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"시작 대기 중"})]})]}),(E>0||b)&&e.jsxs("div",{className:"flex items-center justify-center space-x-6 mt-3 text-xs text-gray-500",children:[E>0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ne,{className:"w-3 h-3"}),e.jsxs("span",{children:["경과: ",te(E)]})]}),b&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(re,{className:"w-3 h-3"}),e.jsxs("span",{children:["남은 시간: ",te(b)]})]})]})]})]})]})},lt=({onUploadComplete:s,disabled:t})=>{const[i,o]=p.useState(null),[m,c]=p.useState(!1),[u,f]=p.useState(!1),[w,a]=p.useState(null),[v,N]=p.useState(0),[F,E]=p.useState(!1),[b,D]=p.useState([{id:"upload",title:"파일 업로드",description:"엑셀 파일을 서버로 업로드",status:"pending"},{id:"parse",title:"Input 시트 파싱",description:"엑셀 파일의 Input 시트 데이터 분석",status:"pending"},{id:"save",title:"데이터베이스 저장",description:"발주서 정보를 데이터베이스에 저장",status:"pending"},{id:"extract",title:"갑지/을지 추출",description:"갑지/을지 시트를 별도 파일로 추출",status:"pending"}]),A=r=>{r.preventDefault(),r.stopPropagation(),r.type==="dragenter"||r.type==="dragover"?c(!0):r.type==="dragleave"&&c(!1)},x=r=>{if(r.preventDefault(),r.stopPropagation(),c(!1),r.dataTransfer.files&&r.dataTransfer.files[0]){const h=r.dataTransfer.files[0];h.type.includes("excel")||h.type.includes("spreadsheet")||h.name.endsWith(".xlsx")?(o(h),a(null),C()):alert("엑셀 파일(.xlsx)만 업로드 가능합니다.")}},R=r=>{r.target.files&&r.target.files[0]&&(o(r.target.files[0]),a(null),C())},C=()=>{D(r=>r.map(h=>({...h,status:"pending",message:void 0})))},S=(r,h,k)=>{D(n=>n.map(y=>y.id===r?{...y,status:h,message:k}:y))},T=(r,h,k,n)=>{const y=r[h];if(!y){console.error("선택된 발주서가 없습니다.");return}const l={orderNumber:y.orderNumber,projectName:y.projectName,projectId:y.projectId,vendorName:y.vendorName,vendorId:y.vendorId,vendorEmail:y.vendorEmail,orderDate:y.orderDate,deliveryDate:y.dueDate||y.deliveryDate,dueDate:y.dueDate||y.deliveryDate,totalAmount:y.totalAmount||0,totalItems:y.items?.length||0,items:y.items||[],notes:y.notes||y.remarks||"",remarks:y.notes||y.remarks||"",createdBy:y.createdBy||"",creationMethod:"excel",type:"excel",excelFileName:k.data?.fileName,filePath:k.data?.filePath,processedExcelUrl:n?`/api/po-template/download/${n.split("/").pop()}`:void 0,processedExcelPath:n,allOrders:r,totalOrders:r.length,selectedOrderIndex:h};console.log("ExcelUploadComponent submitting orderData:",l),s(l),E(!1)},d=async()=>{if(i){f(!0);try{S("upload","processing");const r=new FormData;r.append("file",i);const h=await fetch("/api/po-template/upload",{method:"POST",body:r}),k=await h.json();if(!h.ok){S("upload","error",k.error||"파일 업로드 실패"),f(!1);return}S("upload","completed",`${k.data.fileName} 업로드 완료`),S("parse","completed",`발주서 ${k.data.totalOrders}개, 아이템 ${k.data.totalItems}개 파싱 완료`),S("save","processing");const n=await fetch("/api/po-template/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orders:k.data.orders})}),y=await n.json();if(!n.ok){S("save","error",y.error||"데이터베이스 저장 실패"),f(!1);return}S("save","completed",`발주서 ${y.data.savedOrders}개 저장 완료`),S("extract","processing");const l=await fetch("/api/po-template/extract-sheets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:k.data.filePath})}),P=await l.json();let W;l.ok?(S("extract","completed",`${P.data.extractedSheets.join(", ")} 시트 추출 완료`),W=P.data?.extractedPath,console.log("Extracted file path:",W)):S("extract","error",P.error||"시트 추출 실패"),a(k),k.data.orders.length>1?(E(!0),a({...k,extractedPath:W})):T(k.data.orders,0,k,W)}catch(r){console.error("Processing error:",r),S("upload","error","처리 중 오류가 발생했습니다.")}finally{f(!1)}}},g=()=>b.filter(h=>h.status==="completed").length/b.length*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(O,{className:"border-blue-200 bg-blue-50",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-800 mb-3",children:"📋 엑셀 파일 요구사항"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"시트명:"})," 'Input' (대소문자 구분)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"컬럼 구조:"})," A~P열 (16개 컬럼) 표준 구조"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"파일 형식:"})," .xlsx (Excel 2007 이상)"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("span",{children:[e.jsx("strong",{children:"파일 크기:"})," 최대 10MB"]})]})]})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"font-semibold text-green-800 mb-3",children:"📥 표준 템플릿 다운로드"}),e.jsx("p",{className:"text-sm text-green-700 mb-3",children:"시스템에 최적화된 16개 컬럼 구조의 표준 템플릿을 다운로드하여 사용하세요."}),e.jsxs(j,{onClick:async()=>{try{const r=await fetch("/api/excel-template/download",{method:"GET"});if(r.ok){const h=await r.blob(),k=window.URL.createObjectURL(h),n=document.createElement("a");n.href=k,n.download="PO_Excel_Template.xlsx",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(k)}else throw new Error("템플릿 다운로드 실패")}catch(r){console.error("템플릿 다운로드 오류:",r),alert("템플릿 다운로드 중 오류가 발생했습니다.")}},className:"bg-green-600 hover:bg-green-700 text-white",size:"sm",disabled:t,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"PO_Excel_Template.xlsx 다운로드"]})]})]})})}),e.jsxs("div",{children:[e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-8 text-center transition-colors ${m?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"} ${t?"opacity-50 pointer-events-none":""}`,onDragEnter:A,onDragLeave:A,onDragOver:A,onDrop:x,children:[e.jsx($e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),i?e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:i.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(i.size/1024/1024).toFixed(2)," MB"]}),e.jsx(M,{variant:"secondary",className:"mt-2",children:"파일 준비 완료"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg text-gray-600 mb-2",children:"엑셀 파일을 드래그하거나 클릭하여 업로드하세요"}),e.jsx("p",{className:"text-sm text-gray-500",children:"지원 형식: .xlsx (Excel 파일)"})]}),e.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:R,className:"hidden",id:"file-upload",disabled:t}),e.jsx("label",{htmlFor:"file-upload",className:`inline-block mt-4 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer transition-colors font-medium ${t?"opacity-50 pointer-events-none":""}`,children:"파일 선택"})]}),i&&e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx(j,{onClick:d,disabled:u||t,className:"flex-1 h-12",size:"lg",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"처리 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"업로드 및 처리 시작"]})}),e.jsx(j,{variant:"outline",onClick:()=>{o(null),a(null),C()},className:"h-12",size:"lg",disabled:u||t,children:"취소"})]}),u&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"처리 진행 상황"}),e.jsxs("span",{className:"text-sm text-blue-700",children:[Math.round(g()),"%"]})]}),e.jsx(Pe,{value:g(),className:"h-2 mb-3"}),e.jsx("div",{className:"text-sm text-blue-700",children:b.find(r=>r.status==="processing")?.title||"처리 중..."})]})]}),w&&w.data?.orders&&e.jsx(O,{className:"mt-6",children:e.jsxs($,{className:"p-6",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-blue-600"}),"발주서 데이터 미리보기"]}),e.jsxs("div",{className:"space-y-6",children:[w.data.orders.slice(0,2).map((r,h)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:r.orderNumber}),e.jsxs("p",{className:"text-sm text-gray-600",children:["거래처: ",r.vendorName," | 납품처: ",r.deliveryName||r.vendorName]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["현장: ",r.siteName," | 발주일: ",r.orderDate," | 납기일: ",r.dueDate]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600",children:new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",minimumFractionDigits:0,maximumFractionDigits:0}).format(r.totalAmount)}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r.items.length,"개 품목"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"품목명"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-left",children:"규격"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"수량"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"단가"}),e.jsx("th",{className:"border border-gray-300 px-2 py-1 text-right",children:"금액"})]})}),e.jsxs("tbody",{children:[r.items.slice(0,3).map((k,n)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:k.itemName}),e.jsx("td",{className:"border border-gray-300 px-2 py-1",children:k.specification}),e.jsx("td",{className:"border border-gray-300 px-2 py-1 text-right",children:new Intl.NumberFormat("ko-KR").format(k.quantity)}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR").format(k.unitPrice),"원"]}),e.jsxs("td",{className:"border border-gray-300 px-2 py-1 text-right",children:[new Intl.NumberFormat("ko-KR").format(k.totalAmount),"원"]})]},n)),r.items.length>3&&e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"border border-gray-300 px-2 py-1 text-center text-gray-500",children:["... 외 ",r.items.length-3,"개 품목"]})})]})]})})]},h)),w.data.orders.length>2&&e.jsx("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-gray-600",children:["... 외 ",w.data.orders.length-2,"개 발주서"]})})]})]})}),F&&w&&w.data&&e.jsx(O,{children:e.jsx($,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"발주서 선택"}),e.jsxs(M,{variant:"secondary",children:[w.data.orders.length,"개 발주서"]})]}),e.jsxs(de,{children:[e.jsx(fe,{className:"h-4 w-4"}),e.jsx(oe,{children:"여러 개의 발주서가 업로드되었습니다. 처리할 발주서를 선택해주세요."})]}),e.jsx("div",{className:"space-y-3",children:w.data.orders.map((r,h)=>e.jsx("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${v===h?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onClick:()=>N(h),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium",children:r.orderNumber}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r.projectName," | ",r.vendorName]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[r.items?.length||0,"개 품목 | 총액: ₩",(r.totalAmount||0).toLocaleString()]})]}),e.jsx("input",{type:"radio",name:"orderSelection",checked:v===h,onChange:()=>N(h),className:"w-4 h-4 text-blue-600"})]})},h))}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(j,{onClick:()=>T(w.data.orders,v,w,w.extractedPath),className:"flex-1",disabled:t,children:"선택한 발주서로 진행"}),e.jsx(j,{variant:"outline",onClick:()=>{E(!1),a(null),o(null),C()},disabled:t,children:"취소"})]})]})})}),w&&!F&&e.jsxs(de,{children:[e.jsx(_,{className:"h-4 w-4"}),e.jsxs(oe,{children:["엑셀 발주서가 성공적으로 처리되었습니다. 발주서 ",w.data?.totalOrders,"개, 품목 ",w.data?.totalItems,"개가 생성되었습니다."]})]})]})},it=({onFormComplete:s,disabled:t})=>{const[i]=p.useState(ps()),[o,m]=p.useState(!1),[c,u]=p.useState({site:"",deliveryDate:"",isNegotiable:!1,receiver:"",manager:"",notes:"",items:[{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:"",vendorId:"",deliveryLocation:"",deliveryToSite:!1}]}),f=()=>c.items.reduce((d,g)=>d+(g.totalPrice||0),0),{data:w=[]}=se({queryKey:["/api/projects"],select:d=>d?.filter(g=>g.isActive)||[]});se({queryKey:["/api/auth/user"]});const{data:a=[]}=se({queryKey:["/api/users"],select:d=>d?.filter(g=>g.isActive)||[]}),{data:v=[]}=se({queryKey:["/api/vendors"],select:d=>d?.filter(g=>g.isActive)||[]}),{data:N=[]}=se({queryKey:["/api/item-categories/major"],queryFn:()=>fetch("/api/item-categories/major").then(d=>d.json())}),{data:F=[]}=se({queryKey:["/api/item-categories/middle"],queryFn:()=>fetch("/api/item-categories/middle").then(d=>d.json())}),{data:E=[]}=se({queryKey:["/api/item-categories/minor"],queryFn:()=>fetch("/api/item-categories/minor").then(d=>d.json())}),b=d=>F,D=d=>E,A=(d,g)=>{u(r=>({...r,[d]:g}))},x=(d,g,r)=>{const h=[...c.items];if(h[d]={...h[d],[g]:r},g==="quantity"||g==="unitPrice"){const k=g==="quantity"?r:h[d].quantity,n=g==="unitPrice"?r:h[d].unitPrice;h[d].totalPrice=k*n}g==="majorCategory"?(h[d].middleCategory="",h[d].minorCategory=""):g==="middleCategory"&&(h[d].minorCategory=""),g==="deliveryToSite"&&r===!0&&(h[d].deliveryLocation="현장"),u(k=>({...k,items:h}))},R=()=>{u(d=>({...d,items:[...d.items,{name:"",category:"",majorCategory:"",middleCategory:"",minorCategory:"",quantity:0,unit:"",unitPrice:0,totalPrice:0,specs:"",remarks:"",vendorId:"",deliveryLocation:"",deliveryToSite:!1}]}))},C=d=>{c.items.length>1&&u(g=>({...g,items:g.items.filter((r,h)=>h!==d)}))},S=()=>c.site?c.deliveryDate?c.items.some(d=>!d.name||d.quantity<=0)?(alert("모든 품목의 이름과 수량을 입력해주세요."),!1):c.items[0]?.vendorId?!0:(alert("최소한 하나의 품목에 거래처를 선택해주세요."),!1):(alert("희망 납기일을 입력해주세요."),!1):(alert("현장을 선택해주세요."),!1),T=async()=>{if(S()){m(!0);try{const d=w.find(h=>h.projectName===c.site),g=c.items[0]?.vendorId||"",r={type:"standard",orderNumber:i,projectId:d?.id?.toString()||"",vendorId:g,siteName:c.site,orderDate:new Date().toISOString().split("T")[0],deliveryDate:c.deliveryDate,isNegotiable:c.isNegotiable,receiver:c.receiver,manager:c.manager,notes:c.notes,totalAmount:f(),items:c.items.map(h=>({itemName:h.name,specification:h.specs,quantity:h.quantity,unit:h.unit,unitPrice:h.unitPrice,totalAmount:h.totalPrice,category:h.category,majorCategory:h.majorCategory,middleCategory:h.middleCategory,minorCategory:h.minorCategory,remarks:h.remarks,vendorId:h.vendorId,deliveryLocation:h.deliveryLocation,deliveryToSite:h.deliveryToSite}))};s(r)}catch(d){console.error("Form submission error:",d),alert("발주서 생성 중 오류가 발생했습니다.")}finally{m(!1)}}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(O,{className:"border-blue-200 bg-blue-50",children:e.jsx($,{className:"p-4",children:e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-blue-200",children:[e.jsxs("h4",{className:"font-semibold text-blue-800 mb-3 flex items-center gap-2",children:[e.jsx(fe,{className:"w-4 h-4"}),"표준 발주서 작성 안내"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"단계별 입력으로 정확한 발주서 작성"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"실시간 데이터 검증 및 자동 완성"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:"자동 저장으로 안전한 데이터 보관"})]})]})]})})}),e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5"}),"발주서 기본 정보"]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"poNumber",children:"발주서 번호"}),e.jsx(U,{id:"poNumber",value:i,disabled:!0,className:"bg-gray-50"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"site",children:"현장 선택 *"}),e.jsxs(H,{value:c.site,onValueChange:d=>A("site",d),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"현장을 선택하세요"})}),e.jsx(Q,{children:w.map(d=>e.jsx(L,{value:d.projectName,children:d.projectName},d.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"deliveryDate",children:"희망 납기일 *"}),e.jsx(U,{id:"deliveryDate",type:"date",value:c.deliveryDate,onChange:d=>A("deliveryDate",d.target.value),disabled:t})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-8",children:[e.jsx(Le,{id:"isNegotiable",checked:c.isNegotiable,onCheckedChange:d=>A("isNegotiable",d),disabled:t}),e.jsx(I,{htmlFor:"isNegotiable",children:"납기 협의 가능"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"receiver",children:"수신자"}),e.jsxs(H,{value:c.receiver,onValueChange:d=>A("receiver",d),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"수신자를 선택하세요"})}),e.jsx(Q,{children:a.map(d=>e.jsxs(L,{value:d.name,children:[d.name," (",d.role,")"]},d.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"manager",children:"담당자"}),e.jsx(U,{id:"manager",value:c.manager,onChange:d=>A("manager",d.target.value),placeholder:"담당자명을 입력하세요",disabled:t})]})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"notes",children:"특이사항"}),e.jsx(Ee,{id:"notes",value:c.notes,onChange:d=>A("notes",d.target.value),placeholder:"특이사항이나 요청사항을 입력하세요",rows:3,disabled:t})]})]})]}),e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5"}),"발주 품목"]}),e.jsxs(j,{onClick:R,variant:"outline",size:"sm",disabled:t,children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"품목 추가"]})]})}),e.jsx($,{children:e.jsx("div",{className:"space-y-4",children:c.items.map((d,g)=>e.jsx(O,{className:"border border-gray-200",children:e.jsxs($,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs(M,{variant:"outline",children:["품목 ",g+1]}),c.items.length>1&&e.jsx(j,{onClick:()=>C(g),variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",disabled:t,children:e.jsx(js,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"품목명 *"}),e.jsx(U,{value:d.name,onChange:r=>x(g,"name",r.target.value),placeholder:"품목명을 입력하세요",disabled:t})]}),e.jsxs("div",{children:[e.jsx(I,{children:"규격"}),e.jsx(U,{value:d.specs,onChange:r=>x(g,"specs",r.target.value),placeholder:"규격을 입력하세요",disabled:t})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(I,{children:"대분류"}),e.jsxs(H,{value:d.majorCategory,onValueChange:r=>x(g,"majorCategory",r),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"선택"})}),e.jsx(Q,{children:N.map(r=>e.jsx(L,{value:r.categoryValue||r.categoryName,children:r.categoryValue||r.categoryName},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"중분류"}),e.jsxs(H,{value:d.middleCategory,onValueChange:r=>x(g,"middleCategory",r),disabled:t||!d.majorCategory,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"선택"})}),e.jsx(Q,{children:b(d.majorCategory).map(r=>e.jsx(L,{value:r.categoryValue||r.categoryName,children:r.categoryValue||r.categoryName},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"소분류"}),e.jsxs(H,{value:d.minorCategory,onValueChange:r=>x(g,"minorCategory",r),disabled:t||!d.middleCategory,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"선택"})}),e.jsx(Q,{children:D(d.middleCategory).map(r=>e.jsx(L,{value:r.categoryValue||r.categoryName,children:r.categoryValue||r.categoryName},r.id))})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"수량 *"}),e.jsx(U,{type:"number",value:d.quantity||"",onChange:r=>x(g,"quantity",parseFloat(r.target.value)||0),placeholder:"0",min:"0",step:"0.01",disabled:t})]}),e.jsxs("div",{children:[e.jsx(I,{children:"단위"}),e.jsxs(H,{value:d.unit,onValueChange:r=>x(g,"unit",r),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"단위 선택"})}),e.jsxs(Q,{children:[e.jsx(L,{value:"ea",children:"ea"}),e.jsx(L,{value:"set",children:"set"}),e.jsx(L,{value:"ton",children:"ton"}),e.jsx(L,{value:"kg",children:"kg"}),e.jsx(L,{value:"g",children:"g"}),e.jsx(L,{value:"m",children:"m"}),e.jsx(L,{value:"cm",children:"cm"}),e.jsx(L,{value:"mm",children:"mm"}),e.jsx(L,{value:"m²",children:"m²"}),e.jsx(L,{value:"m³",children:"m³"}),e.jsx(L,{value:"L",children:"L"}),e.jsx(L,{value:"mL",children:"mL"}),e.jsx(L,{value:"기타",children:"기타"})]})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"단가"}),e.jsx(U,{type:"number",value:d.unitPrice||"",onChange:r=>x(g,"unitPrice",parseFloat(r.target.value)||0),placeholder:"0",min:"0",step:"0.01",disabled:t})]}),e.jsxs("div",{children:[e.jsx(I,{children:"총액"}),e.jsx(U,{value:Ue(d.totalPrice),disabled:!0,className:"bg-gray-50"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx(I,{children:"거래처"}),e.jsxs(H,{value:d.vendorId||"",onValueChange:r=>x(g,"vendorId",r),disabled:t,children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"거래처를 선택하세요"})}),e.jsx(Q,{children:v.map(r=>e.jsx(L,{value:r.id.toString(),children:r.name},r.id))})]})]}),e.jsxs("div",{children:[e.jsx(I,{children:"납품처"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{value:d.deliveryLocation||"",onValueChange:r=>x(g,"deliveryLocation",r),disabled:t||d.deliveryToSite,className:"flex-1",children:[e.jsx(Z,{children:e.jsx(X,{placeholder:"납품처를 선택하세요"})}),e.jsx(Q,{children:v.map(r=>e.jsx(L,{value:r.name,children:r.name},r.id))})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Le,{id:`deliveryToSite-${g}`,checked:d.deliveryToSite||!1,onCheckedChange:r=>{x(g,"deliveryToSite",r),r&&x(g,"deliveryLocation","현장")},disabled:t}),e.jsx(I,{htmlFor:`deliveryToSite-${g}`,className:"text-sm cursor-pointer",children:"현장"})]})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(I,{children:"비고"}),e.jsx(Ee,{value:d.remarks,onChange:r=>x(g,"remarks",r.target.value),placeholder:"추가 설명이나 요청사항",rows:2,disabled:t})]})]})]})},g))})})]}),e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(ks,{className:"w-5 h-5"}),"주문 요약"]})}),e.jsx($,{children:e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-medium",children:"총 주문 금액"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-600",children:[Ue(f()),"원"]})]}),e.jsxs("div",{className:"text-sm text-gray-600 mt-2",children:["총 ",c.items.length,"개 품목"]})]})})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(j,{onClick:T,disabled:t||o,className:"flex-1 bg-blue-600 hover:bg-blue-700",size:"lg",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"처리 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"발주서 생성"]})})})]})},nt=({method:s,onDataSubmit:t,disabled:i})=>s==="excel"?e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5"}),"엑셀 파일 업로드"]})}),e.jsx($,{children:e.jsx(lt,{onUploadComplete:t,disabled:i})})]}):e.jsxs(O,{children:[e.jsx(z,{children:e.jsx(V,{children:"표준 발주서 작성"})}),e.jsx($,{children:e.jsx(it,{onFormComplete:t,disabled:i})})]}),ct=({orderData:s})=>{const t=s.totalOrders||s.orders?.length||1,i=s.totalItems||s.items?.length||0,o=s.totalAmount||0;return e.jsxs(O,{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200",children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2 text-green-700",children:[e.jsx(_,{className:"w-6 h-6"}),"발주서 생성 완료 요약"]})}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:t}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(G,{className:"w-3 h-3"}),"발주서"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:i}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(Xe,{className:"w-3 h-3"}),"품목"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:o>0?`₩${o.toLocaleString()}`:"-"}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center justify-center gap-1",children:[e.jsx(gs,{className:"w-3 h-3"}),"총 금액"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center shadow-sm",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-1",children:s.type==="excel"?"Excel":"표준"}),e.jsx("div",{className:"text-sm text-gray-600",children:"작성 방식"})]})]}),s.orderNumber&&e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"발주서 정보"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"발주서 번호:"}),e.jsx(M,{variant:"outline",className:"font-mono",children:s.orderNumber})]}),s.projectName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"프로젝트:"}),e.jsx("span",{className:"font-medium",children:s.projectName})]}),s.vendorName&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"거래처:"}),e.jsx("span",{className:"font-medium",children:s.vendorName})]}),s.createdAt&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-gray-600",children:"생성일:"}),e.jsx("span",{className:"font-medium",children:new Date(s.createdAt).toLocaleDateString("ko-KR")})]})]})]}),e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(_,{className:"w-4 h-4"}),"모든 발주서가 성공적으로 생성되었습니다"]})})]})]})},dt=({steps:s,onRetryStep:t,showRetryButtons:i=!1})=>{const o=s.filter(a=>a.status==="completed"),m=s.filter(a=>a.status==="error"),c=s.filter(a=>a.status==="processing"),u=a=>{switch(a.id){case"pdf_generation":return e.jsx(G,{className:"w-4 h-4"});case"vendor_validation":return e.jsx(Ze,{className:"w-4 h-4"});case"email_preparation":return e.jsx(ne,{className:"w-4 h-4"});case"attachment_processing":return e.jsx(G,{className:"w-4 h-4"});case"final_validation":return e.jsx(_,{className:"w-4 h-4"});default:return e.jsx(_e,{className:"w-4 h-4"})}},f=a=>{switch(a){case"completed":return e.jsx(_,{className:"w-4 h-4 text-green-600"});case"error":return e.jsx(B,{className:"w-4 h-4 text-red-600"});case"processing":return e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"});default:return e.jsx(re,{className:"w-4 h-4 text-gray-400"})}},w=a=>{switch(a){case"completed":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"processing":return"bg-blue-50 border-blue-200";default:return"bg-gray-50 border-gray-200"}};return e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"w-5 h-5 text-blue-600"}),"처리 결과 상세"]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:o.length}),e.jsx("div",{className:"text-sm text-green-700",children:"완료"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:c.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"처리 중"})]}),e.jsxs("div",{className:"text-center p-3 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600 mb-1",children:m.length}),e.jsx("div",{className:"text-sm text-red-700",children:"오류"})]})]}),e.jsx("div",{className:"space-y-3",children:s.map(a=>e.jsx("div",{className:`p-4 rounded-lg border ${w(a.status)} transition-all duration-200`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[u(a),f(a.status)]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.title}),e.jsx(M,{variant:"outline",className:a.status==="completed"?"border-green-600 text-green-600":a.status==="error"?"border-red-600 text-red-600":a.status==="processing"?"border-blue-600 text-blue-600":"border-gray-400 text-gray-600",children:a.status==="completed"?"완료":a.status==="error"?"오류":a.status==="processing"?"처리 중":"대기"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:a.description}),a.progress!==void 0&&e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"진행률"}),e.jsxs("span",{children:[a.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${a.progress}%`}})})]}),a.result&&e.jsxs("div",{className:"text-sm text-green-700 bg-green-50 p-2 rounded mt-2",children:[e.jsx("strong",{children:"결과:"})," ",typeof a.result=="string"?a.result:JSON.stringify(a.result)]}),a.error&&e.jsxs("div",{className:"text-sm text-red-700 bg-red-50 p-2 rounded mt-2",children:[e.jsx("strong",{children:"오류:"})," ",a.error]}),a.details&&a.details.length>0&&e.jsx("div",{className:"mt-2",children:e.jsxs("details",{className:"text-sm",children:[e.jsx("summary",{className:"cursor-pointer text-gray-600 hover:text-gray-800",children:"상세 정보 보기"}),e.jsx("ul",{className:"mt-2 space-y-1 text-gray-600 ml-4",children:a.details.map((v,N)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-gray-400",children:"•"}),v]},N))})]})})]})]}),i&&a.status==="error"&&t&&e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>t(a.id),className:"ml-2",children:[e.jsx(ae,{className:"w-3 h-3 mr-1"}),"재시도"]})]})},a.id))}),m.length===0&&o.length===s.length&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[e.jsx(_,{className:"w-4 h-4"}),"모든 처리 단계가 성공적으로 완료되었습니다"]})}),m.length>0&&e.jsx("div",{className:"text-center py-4",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-red-100 text-red-800 rounded-full text-sm font-medium",children:[e.jsx(B,{className:"w-4 h-4"}),m.length,"개 단계에서 오류가 발생했습니다"]})})]})]})},ot=({orderData:s,isOpen:t,onClose:i,trigger:o,onDownload:m})=>{const[c,u]=p.useState({status:"idle"}),[f,w]=p.useState(100),[a,v]=p.useState(1),[N,F]=p.useState(1),E=async()=>{u({status:"generating",progress:0});try{if(console.log("PDF 생성 시작 - orderData:",s),!s||Object.keys(s).length===0)throw new Error("발주서 데이터가 없습니다. 발주서를 먼저 생성해주세요.");const R=[{message:"발주서 데이터 준비 중...",progress:20},{message:"PDF 템플릿 로딩 중...",progress:40},{message:"PDF 생성 중...",progress:70},{message:"최종 검증 중...",progress:90},{message:"완료",progress:100}];for(const T of R)u({status:"generating",progress:T.progress}),await new Promise(d=>setTimeout(d,800));const C=await fetch("/api/orders/generate-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderData:{orderNumber:s.orderNumber||"PO-TEMP-001",projectName:s.projectName||s.project?.name||"프로젝트 미지정",vendorName:s.vendorName||s.vendor?.name||"거래처 미지정",items:s.items||[],totalAmount:s.totalAmount||0,notes:s.notes||s.remarks||"",orderDate:s.orderDate||new Date().toISOString(),deliveryDate:s.deliveryDate||s.dueDate||null,createdBy:s.createdBy||s.user?.name||"작성자 미상"},options:{includeWatermark:!0,format:"A4",orientation:"portrait"}})});if(!C.ok)throw new Error("PDF 생성에 실패했습니다");const S=await C.json();u({status:"ready",url:S.pdfUrl||"/api/placeholder-pdf.pdf"})}catch(R){u({status:"error",error:R instanceof Error?R.message:"PDF 생성 중 오류가 발생했습니다"})}};p.useEffect(()=>{t&&c.status==="idle"&&E()},[t]);const b=()=>{if(c.url&&m)m(c.url);else if(c.url){const R=document.createElement("a");R.href=c.url,R.download=`발주서_${s?.orderNumber||"unknown"}.pdf`,document.body.appendChild(R),R.click(),document.body.removeChild(R)}},D=()=>{c.url&&window.open(c.url,"_blank")},A=()=>{switch(c.status){case"generating":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[e.jsx(ds,{className:"w-12 h-12 text-blue-600 animate-spin"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF 생성 중..."}),e.jsx("div",{className:"w-80 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${c.progress||0}%`}})}),e.jsxs("p",{className:"text-sm text-gray-600",children:[c.progress||0,"% 완료"]})]});case"error":return e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-4",children:[e.jsx(B,{className:"w-12 h-12 text-red-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"PDF 생성 실패"}),e.jsxs("div",{className:"text-center max-w-md space-y-2",children:[e.jsx("p",{className:"text-sm text-red-600",children:c.error}),e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["💡 ",e.jsx("strong",{children:"해결 방법:"}),e.jsx("br",{}),"• 브라우저에서 팝업 차단을 해제해보세요",e.jsx("br",{}),"• 파일 권한 문제일 수 있으니 다시 시도해보세요",e.jsx("br",{}),"• Excel 파일 다운로드는 여전히 가능합니다"]})})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(j,{onClick:E,variant:"outline",children:[e.jsx(ae,{className:"w-4 h-4 mr-2"}),"다시 시도"]}),e.jsxs(j,{onClick:()=>{s?.excelUrl&&window.open(s.excelUrl,"_blank")},variant:"secondary",disabled:!s?.excelUrl,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Excel 다운로드"]})]})]});case"ready":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>w(Math.max(50,f-25)),disabled:f<=50,children:e.jsx(ns,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-sm font-medium px-2",children:[f,"%"]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>w(Math.min(200,f+25)),disabled:f>=200,children:e.jsx(cs,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[a," / ",N]}),e.jsxs(j,{variant:"outline",size:"sm",onClick:D,children:[e.jsx(Qe,{className:"w-4 h-4 mr-1"}),"인쇄"]}),e.jsxs(j,{variant:"outline",size:"sm",onClick:b,children:[e.jsx(me,{className:"w-4 h-4 mr-1"}),"다운로드"]})]})]}),e.jsx("div",{className:"bg-gray-100 rounded-lg p-4 min-h-[600px] flex items-center justify-center",children:c.url?e.jsx("iframe",{src:`${c.url}#view=FitH&zoom=${f}`,className:"w-full h-[600px] border-0 rounded",title:"PDF 미리보기"}):e.jsxs("div",{className:"text-center py-16",children:[e.jsx(G,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"PDF 로딩 중..."})]})})]});default:return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsxs(j,{onClick:E,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"PDF 미리보기 시작"]})})}},x=e.jsxs(ye,{className:"max-w-5xl h-[90vh] overflow-hidden",children:[e.jsx(be,{children:e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5"}),"PDF 미리보기",s?.orderNumber&&e.jsx(M,{variant:"outline",children:s.orderNumber})]})}),e.jsxs(Oe,{defaultValue:"preview",className:"h-full flex flex-col",children:[e.jsxs(Re,{className:"grid w-full grid-cols-2",children:[e.jsx(Y,{value:"preview",children:"미리보기"}),e.jsx(Y,{value:"details",children:"발주서 정보"})]}),e.jsx(ee,{value:"preview",className:"flex-1 overflow-auto",children:A()}),e.jsx(ee,{value:"details",className:"flex-1 overflow-auto",children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsx(V,{children:"발주서 상세 정보"})}),e.jsxs($,{className:"space-y-4",children:[s?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"발주서 번호:"}),e.jsx("p",{className:"mt-1",children:s.orderNumber||"PO-TEMP-001"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"프로젝트:"}),e.jsx("p",{className:"mt-1",children:s.projectName||s.project?.name||"프로젝트 미지정"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"거래처:"}),e.jsx("p",{className:"mt-1",children:s.vendorName||s.vendor?.name||"거래처 미지정"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"총 금액:"}),e.jsx("p",{className:"mt-1",children:s.totalAmount?`₩${s.totalAmount.toLocaleString()}`:"₩0"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"품목 수:"}),e.jsxs("p",{className:"mt-1",children:[s.totalItems||s.items?.length||0,"개"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"작성 방식:"}),e.jsx("p",{className:"mt-1",children:s.type==="excel"||s.creationMethod==="excel"?"Excel 업로드":"표준 입력"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"발주일자:"}),e.jsx("p",{className:"mt-1",children:s.orderDate?new Date(s.orderDate).toLocaleDateString("ko-KR"):new Date().toLocaleDateString("ko-KR")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"납기일자:"}),e.jsx("p",{className:"mt-1",children:s.deliveryDate||s.dueDate?new Date(s.deliveryDate||s.dueDate).toLocaleDateString("ko-KR"):"미지정"})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"발주서 데이터가 없습니다."}),e.jsx("p",{className:"text-sm mt-2",children:"발주서를 먼저 생성해주세요."})]}),e.jsx(He,{}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"PDF 생성 옵션"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600"}),"워터마크 포함"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600"}),"A4 크기"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-green-600"}),"세로 방향"]})]})]})]})]})})]})]});return o?e.jsxs(ie,{open:t,onOpenChange:i,children:[e.jsx(Fe,{asChild:!0,children:o}),x]}):e.jsx(ie,{open:t,onOpenChange:i,children:x})},mt=({recipients:s,onRecipientsChange:t,isOpen:i,onClose:o,trigger:m,projectId:c,vendorId:u})=>{const[f,w]=p.useState(""),[a,v]=p.useState(null),[N,F]=p.useState({type:"vendor",verified:!1}),[E,b]=p.useState([]);p.useEffect(()=>{D()},[c,u]);const D=async()=>{try{const n=localStorage.getItem("emailRecipients");n&&b(JSON.parse(n))}catch(n){console.error("수신자 목록 로드 실패:",n)}},A=n=>{try{localStorage.setItem("emailRecipients",JSON.stringify(n))}catch(y){console.error("수신자 목록 저장 실패:",y)}},x=()=>{if(!N.email||!N.name)return;const n={id:`recipient-${Date.now()}`,email:N.email,name:N.name,company:N.company||"",position:N.position||"",phone:N.phone||"",type:N.type||"vendor",verified:T(N.email),tags:N.tags||[],lastUsed:new Date},y=[...s,n];t(y);const l=[...E,n];b(l),A(l),F({type:"vendor",verified:!1})},R=n=>{const y=s.filter(l=>l.id!==n);t(y)},C=n=>{const y=s.map(P=>P.id===n.id?n:P);t(y);const l=E.map(P=>P.id===n.id?n:P);b(l),A(l),v(null)},S=n=>{if(s.find(l=>l.id===n.id))return;const y=[...s,{...n,lastUsed:new Date}];t(y)},T=n=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n),d=E.filter(n=>!s.find(y=>y.id===n.id)&&(n.name.toLowerCase().includes(f.toLowerCase())||n.email.toLowerCase().includes(f.toLowerCase())||n.company?.toLowerCase().includes(f.toLowerCase()))),g=n=>{switch(n){case"vendor":return"bg-blue-100 text-blue-800";case"cc":return"bg-green-100 text-green-800";case"bcc":return"bg-gray-100 text-gray-800";case"manager":return"bg-purple-100 text-purple-800";case"approver":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},r=n=>{switch(n){case"vendor":return"거래처";case"cc":return"참조";case"bcc":return"숨은참조";case"manager":return"관리자";case"approver":return"승인자";default:return"기타"}},h=()=>{const n=[["이름","이메일","회사","직책","전화번호","유형"].join(","),...s.map(P=>[P.name,P.email,P.company||"",P.position||"",P.phone||"",r(P.type)].join(","))].join(`
`),y=new Blob([n],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(y),l.download=`email_recipients_${new Date().toISOString().split("T")[0]}.csv`,l.click()},k=e.jsxs(ye,{className:"max-w-5xl h-[90vh] overflow-hidden",children:[e.jsx(be,{children:e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5"}),"이메일 수신자 관리"]})}),e.jsxs(Oe,{defaultValue:"current",className:"h-full flex flex-col",children:[e.jsxs(Re,{className:"grid w-full grid-cols-3",children:[e.jsxs(Y,{value:"current",children:["현재 수신자 (",s.length,")"]}),e.jsx(Y,{value:"add",children:"새 수신자 추가"}),e.jsx(Y,{value:"saved",children:"저장된 수신자"})]}),e.jsxs(ee,{value:"current",className:"flex-1 overflow-auto space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["총 ",s.length,"명의 수신자"]}),e.jsxs(j,{onClick:h,variant:"outline",size:"sm",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"CSV 내보내기"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[s.map(n=>e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:n.name}),e.jsx(M,{className:g(n.type),children:r(n.type)}),n.verified?e.jsx(_,{className:"w-4 h-4 text-green-600"}):e.jsx(B,{className:"w-4 h-4 text-orange-600"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-3 h-3"}),n.email]}),n.company&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-3 h-3"}),n.company]}),n.position&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-3 h-3"}),n.position]}),n.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vs,{className:"w-3 h-3"}),n.phone]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>v(n),children:e.jsx(Ye,{className:"w-3 h-3"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>R(n.id),children:e.jsx(ve,{className:"w-3 h-3"})})]})]})},n.id)),s.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"등록된 수신자가 없습니다."}),e.jsx("p",{className:"text-sm",children:"새 수신자를 추가해주세요."})]})]})]}),e.jsx(ee,{value:"add",className:"flex-1 overflow-auto",children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsx(V,{children:"새 수신자 정보"})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"new-name",children:"이름 *"}),e.jsx(U,{id:"new-name",value:N.name||"",onChange:n=>F({...N,name:n.target.value}),placeholder:"수신자 이름"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"new-email",children:"이메일 주소 *"}),e.jsx(U,{id:"new-email",type:"email",value:N.email||"",onChange:n=>F({...N,email:n.target.value}),placeholder:"example@company.com"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"new-company",children:"회사명"}),e.jsx(U,{id:"new-company",value:N.company||"",onChange:n=>F({...N,company:n.target.value}),placeholder:"회사명"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"new-position",children:"직책"}),e.jsx(U,{id:"new-position",value:N.position||"",onChange:n=>F({...N,position:n.target.value}),placeholder:"직책"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"new-phone",children:"전화번호"}),e.jsx(U,{id:"new-phone",value:N.phone||"",onChange:n=>F({...N,phone:n.target.value}),placeholder:"010-1234-5678"})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"new-type",children:"수신자 유형"}),e.jsxs("select",{id:"new-type",className:"w-full h-10 px-3 py-2 border border-gray-300 rounded-md",value:N.type,onChange:n=>F({...N,type:n.target.value}),children:[e.jsx("option",{value:"vendor",children:"거래처"}),e.jsx("option",{value:"cc",children:"참조"}),e.jsx("option",{value:"bcc",children:"숨은참조"}),e.jsx("option",{value:"manager",children:"관리자"}),e.jsx("option",{value:"approver",children:"승인자"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsxs(j,{onClick:x,disabled:!N.name||!N.email,className:"w-full",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"수신자 추가"]})})]})]})}),e.jsxs(ee,{value:"saved",className:"flex-1 overflow-auto space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(fs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(U,{placeholder:"수신자 검색...",value:f,onChange:n=>w(n.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[d.length,"명 표시"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[d.map(n=>e.jsx(O,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:n.name}),e.jsx(M,{className:g(n.type),children:r(n.type)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-3 h-3"}),n.email]}),n.company&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-3 h-3"}),n.company]})]}),n.lastUsed&&e.jsxs("div",{className:"text-xs text-gray-500",children:["마지막 사용: ",new Date(n.lastUsed).toLocaleDateString("ko-KR")]})]}),e.jsxs(j,{variant:"outline",size:"sm",onClick:()=>S(n),children:[e.jsx(pe,{className:"w-3 h-3 mr-1"}),"추가"]})]})},n.id)),d.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"검색 결과가 없습니다."})]})]})]})]}),a&&e.jsx(ie,{open:!!a,onOpenChange:()=>v(null),children:e.jsxs(ye,{children:[e.jsx(be,{children:e.jsx(we,{children:"수신자 정보 수정"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"edit-name",children:"이름"}),e.jsx(U,{id:"edit-name",value:a.name,onChange:n=>v({...a,name:n.target.value})})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"edit-email",children:"이메일 주소"}),e.jsx(U,{id:"edit-email",type:"email",value:a.email,onChange:n=>v({...a,email:n.target.value})})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"edit-company",children:"회사명"}),e.jsx(U,{id:"edit-company",value:a.company||"",onChange:n=>v({...a,company:n.target.value})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(j,{variant:"outline",onClick:()=>v(null),children:"취소"}),e.jsxs(j,{onClick:()=>C(a),children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),"저장"]})]})]})]})})]});return m?e.jsxs(ie,{open:i,onOpenChange:o,children:[e.jsx(Fe,{asChild:!0,children:m}),k]}):e.jsx(ie,{open:i,onOpenChange:o,children:k})},xt=({orderData:s,recipients:t=[],isOpen:i,onClose:o,onSend:m,trigger:c})=>{const[u,f]=p.useState(t),[w,a]=p.useState(!1),[v,N]=p.useState({subject:`발주서 전송 - ${s?.orderNumber||""}`,body:F(s),includeAttachments:!0,sendAsHTML:!0});function F(x){return`안녕하세요,

${x?.vendorName||"거래처"}님께 발주서를 송부드립니다.

■ 발주서 정보
- 발주서 번호: ${x?.orderNumber||"미생성"}
- 프로젝트: ${x?.projectName||"미지정"}
- 발주 일자: ${new Date().toLocaleDateString("ko-KR")}
- 총 품목 수: ${x?.totalItems||x?.items?.length||0}개
${x?.totalAmount?`- 총 금액: ₩${x.totalAmount.toLocaleString()}`:""}

첨부된 발주서를 확인하시고, 납기일정에 맞춰 준비해 주시기 바랍니다.

문의사항이 있으시면 언제든 연락 주시기 바랍니다.

감사합니다.

---
${x?.companyName||"회사명"}
${x?.senderName||"발신자"}
${x?.senderEmail||"sender@company.com"}
${x?.senderPhone||"연락처"}`}p.useEffect(()=>{if(t.length===0&&s?.vendorEmail){const x={id:"vendor-1",email:s.vendorEmail,name:s.vendorName||"거래처",company:s.vendorName,type:"vendor",verified:!0};f([x])}},[s,t]);const E=()=>{m&&m({recipients:u,template:v}),o?.()},b=x=>{switch(x){case"vendor":return e.jsx(le,{className:"w-4 h-4 text-blue-600"});case"cc":return e.jsx(ms,{className:"w-4 h-4 text-green-600"});case"bcc":return e.jsx(Se,{className:"w-4 h-4 text-gray-600"})}},D=x=>{switch(x){case"vendor":return"거래처";case"cc":return"참조";case"bcc":return"숨은참조"}},A=e.jsxs(ye,{className:"max-w-4xl h-[90vh] overflow-hidden",children:[e.jsx(be,{children:e.jsxs(we,{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5"}),"이메일 미리보기 및 발송",s?.orderNumber&&e.jsx(M,{variant:"outline",children:s.orderNumber})]})}),e.jsxs(Oe,{defaultValue:"recipients",className:"h-full flex flex-col",children:[e.jsxs(Re,{className:"grid w-full grid-cols-3",children:[e.jsxs(Y,{value:"recipients",children:["수신자 (",u.length,")"]}),e.jsx(Y,{value:"compose",children:"이메일 작성"}),e.jsx(Y,{value:"preview",children:"미리보기"})]}),e.jsx(ee,{value:"recipients",className:"flex-1 overflow-auto space-y-4",children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(V,{className:"text-lg",children:"수신자 목록"}),e.jsxs(j,{onClick:()=>a(!0),variant:"outline",size:"sm",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"수신자 관리"]})]})}),e.jsx($,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[u.map(x=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[b(x.type),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:x.name}),e.jsx(M,{variant:"secondary",className:"text-xs",children:D(x.type)}),x.verified?e.jsx(_,{className:"w-4 h-4 text-green-600"}):e.jsx(B,{className:"w-4 h-4 text-orange-600"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:x.email}),x.company&&e.jsx("p",{className:"text-xs text-gray-500",children:x.company})]})]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>f(u.filter(R=>R.id!==x.id)),children:e.jsx(ve,{className:"w-4 h-4"})})]},x.id)),u.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(le,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"등록된 수신자가 없습니다."}),e.jsxs(j,{onClick:()=>a(!0),variant:"outline",className:"mt-2",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"수신자 추가"]})]})]})})]})}),e.jsx(ee,{value:"compose",className:"flex-1 overflow-auto space-y-4",children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsx(V,{className:"text-lg",children:"이메일 내용"})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"email-subject",children:"제목"}),e.jsx(U,{id:"email-subject",value:v.subject,onChange:x=>N({...v,subject:x.target.value})})]}),e.jsxs("div",{children:[e.jsx(I,{htmlFor:"email-body",children:"본문"}),e.jsx(Ee,{id:"email-body",rows:15,value:v.body,onChange:x=>N({...v,body:x.target.value}),className:"font-mono text-sm"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{htmlFor:"include-attachments",children:"PDF 첨부"}),e.jsx(qe,{id:"include-attachments",checked:v.includeAttachments,onCheckedChange:x=>N({...v,includeAttachments:x})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(I,{htmlFor:"send-html",children:"HTML 형식으로 발송"}),e.jsx(qe,{id:"send-html",checked:v.sendAsHTML,onCheckedChange:x=>N({...v,sendAsHTML:x})})]})]}),v.includeAttachments&&e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-800",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"첨부 예정 파일"})]}),e.jsxs("ul",{className:"mt-2 text-sm text-blue-700",children:[e.jsxs("li",{children:["• 발주서_",s?.orderNumber||"unknown",".pdf"]}),s?.processedExcelUrl&&e.jsxs("li",{children:["• 처리된_Excel_파일_",s?.excelFileName||"Input제거",".xlsx"]})]})]})]})]})}),e.jsx(ee,{value:"preview",className:"flex-1 overflow-auto space-y-4",children:e.jsxs(O,{children:[e.jsx(z,{children:e.jsx(V,{className:"text-lg",children:"발송 미리보기"})}),e.jsxs($,{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2 p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-1 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"받는 사람:"}),e.jsx("div",{className:"mt-1",children:u.filter(x=>x.type==="vendor").map(x=>x.email).join(", ")||"없음"})]}),u.some(x=>x.type==="cc")&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"참조:"}),e.jsx("div",{className:"mt-1",children:u.filter(x=>x.type==="cc").map(x=>x.email).join(", ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"제목:"}),e.jsx("div",{className:"mt-1 font-medium",children:v.subject})]})]})}),e.jsx("div",{className:"p-4 border rounded-lg bg-white",children:e.jsx("div",{className:"whitespace-pre-wrap text-sm",children:v.body})}),v.includeAttachments&&e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[e.jsx(Te,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"첨부파일"})]}),e.jsxs("div",{className:"mt-2 text-sm text-green-700",children:["발주서_",s?.orderNumber||"unknown",".pdf"]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(j,{onClick:E,disabled:u.length===0,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(ys,{className:"w-4 h-4 mr-2"}),"이메일 발송 (",u.length,"명)"]})})]})]})})]}),e.jsx(mt,{recipients:u,onRecipientsChange:f,isOpen:w,onClose:()=>a(!1),projectId:s?.projectId,vendorId:s?.vendorId})]});return c?e.jsxs(ie,{open:i,onOpenChange:o,children:[e.jsx(Fe,{asChild:!0,children:c}),A]}):e.jsx(ie,{open:i,onOpenChange:o,children:A})},ht=({orderData:s,onViewPDF:t,onDownloadPDF:i,onSendEmail:o,onViewOrders:m,onCreateNew:c,onPrint:u,onArchive:f,onShare:w,disabled:a=!1})=>{const[v,N]=p.useState(!1),[F,E]=p.useState(!1);return e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(Ve,{className:"w-5 h-5"}),"사용 가능한 작업"]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"문서 관리"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs(j,{variant:"outline",onClick:()=>N(!0),disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Se,{className:"w-4 h-4"}),"PDF 미리보기"]}),s?.pdfUrl&&e.jsxs(j,{variant:"outline",onClick:i,disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(me,{className:"w-4 h-4"}),"PDF 다운로드"]}),e.jsxs(j,{variant:"outline",onClick:u,disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Qe,{className:"w-4 h-4"}),"인쇄하기"]}),e.jsxs(j,{variant:"outline",onClick:w,disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(Ve,{className:"w-4 h-4"}),"공유하기"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"이메일 발송"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs(j,{variant:s?.emailsSent?"outline":"default",onClick:()=>E(!0),disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(ne,{className:"w-4 h-4"}),s?.emailsSent?"이메일 재발송":"이메일 발송"]}),s?.emailsSent&&e.jsx("div",{className:"text-sm text-green-600 text-center py-2 bg-green-50 rounded-lg",children:"✓ 이메일이 발송되었습니다"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"다음 단계"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs(j,{onClick:()=>{m?m():window.location.href="/orders"},disabled:a,className:"flex items-center justify-center gap-2 h-12 bg-blue-600 hover:bg-blue-700",children:[e.jsx(G,{className:"w-4 h-4"}),"발주서 관리"]}),e.jsxs(j,{onClick:()=>{c?c():window.location.href="/create-order/unified"},variant:"outline",disabled:a,className:"flex items-center justify-center gap-2 h-12",children:[e.jsx(pe,{className:"w-4 h-4"}),"새 발주서 작성"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"기타"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:e.jsxs(j,{variant:"outline",onClick:f,disabled:a,className:"flex items-center justify-center gap-2 h-10 text-gray-600",children:[e.jsx(bs,{className:"w-4 h-4"}),"보관하기"]})})]}),s?.orderNumber&&e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("div",{className:"font-medium mb-1",children:"발주서 번호"}),e.jsx("div",{className:"font-mono text-blue-900",children:s.orderNumber})]})})]}),e.jsx(ot,{orderData:s,isOpen:v,onClose:()=>N(!1),onDownload:i}),e.jsx(xt,{orderData:s,isOpen:F,onClose:()=>E(!1),onSend:b=>{console.log("이메일 발송:",b),o&&o(),E(!1)}})]})},ut=({orderData:s,onNavigate:t})=>{const o=(()=>{const a=[];return a.push({id:"view_orders",title:"발주서 상세 확인",description:"생성된 발주서의 상세 내용을 확인하고 필요시 수정하세요",priority:"high",status:"recommended",estimatedTime:"2-3분",url:"/orders",icon:e.jsx(G,{className:"w-4 h-4"})}),s?.emailsSent||a.push({id:"send_emails",title:"거래처에 이메일 발송",description:"생성된 발주서를 거래처에 이메일로 발송하세요",priority:"high",status:"pending",estimatedTime:"1-2분",url:"/orders?action=send-email",icon:e.jsx(ne,{className:"w-4 h-4"})}),s?.requiresApproval&&a.push({id:"request_approval",title:"승인 요청",description:"발주서 승인을 위해 상급자에게 승인 요청을 보내세요",priority:"high",status:"pending",estimatedTime:"1분",url:"/approvals/request",icon:e.jsx(le,{className:"w-4 h-4"})}),s?.totalAmount&&s.totalAmount>1e7&&a.push({id:"financial_review",title:"재무 검토 요청",description:"고액 발주서로 인해 재무팀 검토가 필요합니다",priority:"medium",status:"recommended",estimatedTime:"5분",url:"/financial-review",icon:e.jsx(ze,{className:"w-4 h-4"})}),s?.vendorCount&&s.vendorCount>3&&a.push({id:"vendor_management",title:"거래처 관리 검토",description:"다수 거래처 발주서이므로 거래처 정보를 재검토하세요",priority:"medium",status:"optional",estimatedTime:"3-5분",url:"/vendors",icon:e.jsx(De,{className:"w-4 h-4"})}),a.push({id:"project_tracking",title:"프로젝트 진행 상황 업데이트",description:"프로젝트 관리 시스템에 발주서 정보를 반영하세요",priority:"low",status:"optional",estimatedTime:"2-3분",url:"/projects",icon:e.jsx(ze,{className:"w-4 h-4"})}),a})(),m=o.filter(a=>a.status==="pending"),c=o.filter(a=>a.status==="recommended"),u=o.filter(a=>a.status==="optional"),f=a=>{switch(a){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-green-100 text-green-800 border-green-200"}},w=a=>{a.action?a.action():a.url&&(t?t(a.url):window.location.href=a.url)};return e.jsxs(O,{children:[e.jsx(z,{children:e.jsxs(V,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5 text-blue-600"}),"다음 단계 안내"]})}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-orange-600 mb-1",children:m.length}),e.jsx("div",{className:"text-sm text-orange-700",children:"필수 작업"})]}),e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-blue-600 mb-1",children:c.length}),e.jsx("div",{className:"text-sm text-blue-700",children:"권장 작업"})]}),e.jsxs("div",{className:"text-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-gray-600 mb-1",children:u.length}),e.jsx("div",{className:"text-sm text-gray-700",children:"선택 작업"})]})]}),m.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-orange-700 flex items-center gap-2",children:[e.jsx(ws,{className:"w-4 h-4"}),"필수 작업"]}),m.map(a=>e.jsx("div",{className:"border border-orange-200 rounded-lg p-4 bg-orange-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:a.title}),e.jsx(M,{className:f(a.priority),children:a.priority==="high"?"높음":a.priority==="medium"?"보통":"낮음"}),a.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:a.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>w(a),className:"ml-2",children:"실행"})]})},a.id))]}),c.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-blue-700 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"권장 작업"]}),c.map(a=>e.jsx("div",{className:"border border-blue-200 rounded-lg p-4 bg-blue-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:a.title}),e.jsx(M,{className:f(a.priority),children:a.priority==="high"?"높음":a.priority==="medium"?"보통":"낮음"}),a.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:a.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>w(a),className:"ml-2",children:"실행"})]})},a.id))]}),u.length>0&&e.jsxs("details",{className:"space-y-3",children:[e.jsxs("summary",{className:"font-semibold text-gray-700 cursor-pointer flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"선택 작업 (",u.length,"개)"]}),e.jsx("div",{className:"space-y-3 mt-3",children:u.map(a=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"mt-1",children:a.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:a.title}),e.jsx(M,{className:f(a.priority),children:a.priority==="high"?"높음":a.priority==="medium"?"보통":"낮음"}),a.estimatedTime&&e.jsx("span",{className:"text-xs text-gray-500",children:a.estimatedTime})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})]}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>w(a),className:"ml-2",children:"실행"})]})},a.id))})]}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"💡 도움말"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("p",{children:"• 필수 작업부터 순서대로 진행하시면 됩니다"}),e.jsx("p",{children:"• 각 작업의 예상 시간을 참고하여 계획을 세우세요"}),e.jsx("p",{children:"• 문의사항이 있으시면 시스템 관리자에게 연락하세요"})]})]})]})]})},pt=({orderData:s,processingSteps:t=[],onViewOrders:i,onCreateNew:o,onViewPDF:m,onDownloadPDF:c,onSendEmail:u,onPrint:f,onShare:w,onArchive:a,onNavigate:v,disabled:N})=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center py-6",children:[e.jsx(_,{className:"w-16 h-16 text-green-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"발주서 작성이 완료되었습니다!"}),e.jsx("p",{className:"text-lg text-gray-600",children:"모든 처리 과정이 성공적으로 완료되었습니다."})]}),e.jsx(ct,{orderData:s}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.length>0&&e.jsx("div",{className:"lg:col-span-2",children:e.jsx(dt,{steps:t,showRetryButtons:!1})}),e.jsx(ht,{orderData:s,onViewPDF:m,onDownloadPDF:c,onSendEmail:u,onViewOrders:i,onCreateNew:o,onPrint:f,onArchive:a,onShare:w,disabled:N}),e.jsx(ut,{orderData:s,onNavigate:v})]})]}),jt=({onComplete:s,onCancel:t,className:i="",helpContent:o})=>{const{workflow:m,isProcessing:c,currentProcessingStep:u,canGoNext:f,canGoPrevious:w,goNext:a,goPrevious:v,goToStep:N,selectCreationMethod:F,submitOrderData:E,startProcessing:b,retryProcessingStep:D,progress:A,estimatedTime:x,saveProgress:R}=Zs(),[C,S]=p.useState(!1),[T,d]=p.useState(!1),g=l=>{F(l)},r=()=>{R(),S(!0),setTimeout(()=>S(!1),3e3)},h=()=>{t&&t()},k=m.steps.find(l=>l.id===m.currentStep),n=m.steps.findIndex(l=>l.id===m.currentStep),y=()=>{switch(m.currentStep){case"select":return e.jsx(et,{onMethodSelect:g,disabled:c});case"create":return e.jsx(Ce.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsx(nt,{method:m.creationMethod||"standard",onDataSubmit:E,disabled:c})});case"approve":return e.jsx(Ce.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(re,{className:"w-8 h-8 text-yellow-600"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"승인 대기 중"}),e.jsx("p",{className:"text-gray-600",children:"승인 권한자의 검토가 필요합니다."})]})});case"process":return e.jsx(rt,{steps:m.stepStates.processing.steps,currentStep:u,onRetry:D,isProcessing:c});case"complete":return e.jsx(Ce.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),children:e.jsx(pt,{orderData:m.orderData,processingSteps:m.stepStates.processing.steps,onViewOrders:()=>{s?s(m.orderData):window.location.href="/orders"},onCreateNew:()=>{window.location.href="/create-order/unified"},onViewPDF:()=>{m.stepStates.completed.pdfUrl&&window.open(m.stepStates.completed.pdfUrl,"_blank")},onDownloadPDF:()=>{if(m.stepStates.completed.pdfUrl){const P=document.createElement("a");P.href=m.stepStates.completed.pdfUrl,P.download=`발주서_${m.orderData?.orderNumber||"unknown"}.pdf`,document.body.appendChild(P),P.click(),document.body.removeChild(P)}},onSendEmail:()=>{console.log("이메일 발송 기능 (구현 예정)")},onPrint:()=>{window.print()},onShare:()=>{navigator.share&&m.orderData?.orderNumber&&navigator.share({title:`발주서 ${m.orderData.orderNumber}`,text:"발주서를 공유합니다.",url:window.location.href})},onArchive:()=>{console.log("보관하기 기능 (구현 예정)")},onNavigate:P=>{window.location.href=P},disabled:c})});default:return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(ve,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"알 수 없는 단계"}),e.jsx("p",{className:"text-gray-600",children:"현재 단계를 인식할 수 없습니다."})]})}};return e.jsxs("div",{className:`h-screen flex flex-col bg-gray-50 ${i}`,children:[e.jsx("div",{className:"bg-white border-b border-gray-200 flex-shrink-0",children:e.jsx("div",{className:"px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"발주서 작성"}),e.jsx("div",{className:"h-4 w-px bg-gray-300"}),e.jsx("span",{className:"text-sm text-gray-600",children:k?.title})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(j,{variant:"ghost",size:"sm",onClick:r,disabled:c,className:"text-gray-600 hover:text-gray-900",children:[e.jsx(Ie,{className:"w-4 h-4 mr-1"}),"저장"]}),e.jsxs(j,{variant:"ghost",size:"sm",onClick:h,disabled:c,className:"text-gray-600 hover:text-gray-900",children:[e.jsx(ve,{className:"w-4 h-4 mr-1"}),"취소"]})]})]})})}),C&&e.jsx("div",{className:"absolute top-16 right-6 z-50",children:e.jsxs(de,{className:"border-green-200 bg-green-50 shadow-lg",children:[e.jsx(Ie,{className:"h-4 w-4 text-green-600"}),e.jsx(oe,{className:"text-green-800",children:"저장되었습니다"})]})}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:`bg-white border-r border-gray-200 flex-shrink-0 transition-all duration-300 ${T?"w-16":"w-80"}`,children:[e.jsx("div",{className:"p-4 border-b border-gray-100",children:e.jsxs(j,{variant:"ghost",size:"sm",onClick:()=>d(!T),className:"w-full justify-between",children:[!T&&e.jsx("span",{className:"text-sm font-medium",children:"진행 상황"}),T?e.jsx(xs,{className:"w-4 h-4"}):e.jsx(Ss,{className:"w-4 h-4"})]})}),!T&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"space-y-4",children:m.steps.map((l,P)=>{const W=l.id===m.currentStep,K=P<n,xe=P<=n;return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${K?"bg-green-500 text-white":W?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:K?"✓":P+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("button",{onClick:()=>xe&&N(l.id),disabled:!xe,className:`text-left w-full ${xe?"cursor-pointer hover:text-blue-600":"cursor-not-allowed"}`,children:[e.jsx("h3",{className:`text-sm font-medium truncate ${W?"text-blue-600":K?"text-green-600":"text-gray-700"}`,children:l.title}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:l.description})]}),W&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all duration-300",style:{width:`${A}%`}})}),x&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["예상 소요: ",x]})]})]})]},l.id)})})}),e.jsxs("div",{className:"p-4 border-t border-gray-100 space-y-2",children:[e.jsxs(j,{variant:"outline",size:"sm",onClick:v,disabled:!w||c,className:"w-full justify-start",children:[e.jsx(Cs,{className:"w-4 h-4 mr-2"}),"이전 단계"]}),m.currentStep==="process"?e.jsx(j,{onClick:b,disabled:c||!f,className:"w-full justify-start",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"처리 중..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"처리 시작"]})}):m.currentStep==="complete"?e.jsx(j,{onClick:()=>s?.(m.orderData),className:"w-full justify-start bg-green-600 hover:bg-green-700",children:"완료"}):e.jsxs(j,{onClick:a,disabled:!f||c,className:"w-full justify-start",children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"다음 단계"]})]})]}),T&&e.jsx("div",{className:"p-2",children:e.jsx("div",{className:"space-y-2",children:m.steps.map((l,P)=>{const W=l.id===m.currentStep,K=P<n;return e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium transition-colors ${K?"bg-green-500 text-white":W?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"}`,children:K?"✓":P+1})},l.id)})})})]}),e.jsxs("div",{className:"flex-1 overflow-auto flex flex-col",children:[e.jsx("div",{className:"flex-1 p-6",children:e.jsx(O,{className:"h-full shadow-sm",children:e.jsxs($,{className:"h-full p-6 flex flex-col",children:[e.jsxs("div",{className:"flex-shrink-0 mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:k?.title}),e.jsx("p",{className:"text-gray-600 mt-1",children:k?.description})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:y()})]})})}),o&&e.jsx("div",{className:"flex-shrink-0",children:o})]})]})]})},gt=s=>e.jsx(Os,{children:e.jsx(jt,{...s})});function ia(){const{user:s}=hs(),{toast:t}=Ge(),[i,o]=us();new URLSearchParams(window.location.search).get("method"),p.useEffect(()=>{if(!s){o("/login");return}t({title:"통합 발주서 작성",description:"새로운 통합 워크플로우로 발주서를 작성해보세요"})},[s,o,t]);const c=f=>{t({title:"발주서 작성 완료",description:"발주서가 성공적으로 생성되었습니다"}),o("/orders")},u=()=>{window.confirm("작성 중인 발주서를 취소하시겠습니까? 저장되지 않은 내용은 사라집니다.")&&(t({title:"작업 취소됨",description:"발주서 작성이 취소되었습니다",variant:"destructive"}),o("/dashboard"))};return s?e.jsx(gt,{onComplete:c,onCancel:u,helpContent:e.jsx("div",{className:"bg-white border-t border-gray-200",children:e.jsx("div",{className:"max-w-[1366px] mx-auto px-6 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"📋 방식 선택"}),e.jsx("p",{className:"text-sm text-gray-600",children:"프로젝트 요구사항에 맞는 발주서 작성 방식을 선택하세요. 각 방식의 장단점을 비교하여 최적의 선택을 할 수 있습니다."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"⚙️ 자동 처리"}),e.jsx("p",{className:"text-sm text-gray-600",children:"발주서 생성 후 PDF 변환, 거래처 검증, 이메일 발송까지 모든 과정이 자동으로 처리됩니다."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"💾 자동 저장"}),e.jsx("p",{className:"text-sm text-gray-600",children:"작업 진행 상황이 자동으로 저장되어 중간에 중단되어도 이어서 작업할 수 있습니다."})]})]})})})}):e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"로그인 확인 중..."})]})})}export{ia as default};
